import{u as f,a as D,H as O,aS as L,r,j as e,B as n,C as E,m as o,n as m,g as k,V as C,k as I,$ as R,N as F}from"./index-CPIh2kaR.js";import{L as S}from"./live-map-DXBjH6ZS.js";import{P as T}from"./phone-2OSRHZsq.js";function $(){const[,l]=f(),{user:M}=D(),{connected:j,orderUpdates:x}=O(),{paymentUpdates:u}=L(),y=f(),[s,h]=r.useState(null),[N,p]=r.useState(!0),[d,g]=r.useState(null),i=window.location.pathname.split("/").pop();r.useEffect(()=>{(async()=>{if(i)try{const a=await fetch(`/api/fuel/orders/${i}`,{credentials:"include"});if(a.ok){const c=await a.json();h(c.order)}else console.error("Failed to fetch order data")}catch(a){console.error("Error fetching order:",a)}finally{p(!1)}})()},[i]),r.useEffect(()=>{if(x[i||""]&&s){const t=x[i||""];h(a=>a?{...a,status:t.status}:null)}},[x,i,s]),r.useEffect(()=>{Object.keys(u).length>0&&console.log("Payment updates:",u)},[u]),r.useEffect(()=>{const t=async()=>{if(s!=null&&s.driverId)try{const a=await fetch(`/api/tracking/driver/${s.driverId}/location`,{credentials:"include"});if(a.ok){const c=await a.json();c.location&&g({lat:parseFloat(c.location.latitude),lng:parseFloat(c.location.longitude)})}}catch(a){console.error("Error fetching driver location:",a)}};if(s!=null&&s.driverId){t();const a=setInterval(t,3e4);return()=>clearInterval(a)}},[s==null?void 0:s.driverId]);const v=t=>new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN",minimumFractionDigits:0}).format(t),b=t=>{switch(t){case"CONFIRMED":return"bg-blue-100 text-blue-800";case"PREPARING":return"bg-yellow-100 text-yellow-800";case"OUT_FOR_DELIVERY":return"bg-orange-100 text-orange-800";case"DELIVERED":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},w=t=>{switch(t){case"CONFIRMED":return"Your order has been confirmed and is being prepared";case"PREPARING":return"Your fuel is being prepared for delivery";case"OUT_FOR_DELIVERY":return"Your order is on the way";case"DELIVERED":return"Your order has been delivered successfully";default:return"Processing your order"}};return N?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading order details..."})]})}):s?((()=>{var a;const t=(a=y[1])==null?void 0:a.state;return t?{id:t.orderId||"ORD-2024-001234",type:t.orderType||"COMMODITY",amount:t.amount||86500,items:t.orderType==="FUEL"?`${t.fuelType||"PMS"} Fuel Delivery (${t.quantity||20}L)`:"Rice (50kg) x2 bags",deliveryAddress:"No 15, Ahmadu Bello Way, Jos",estimatedDelivery:t.orderType==="FUEL"?"45-60 minutes":"30-45 minutes"}:{id:"ORD-2024-001234",type:"COMMODITY",amount:86500,items:"Rice (50kg) x2 bags",deliveryAddress:"No 15, Ahmadu Bello Way, Jos",estimatedDelivery:"30-45 minutes"}})(),e.jsx("div",{className:"min-h-screen bg-gray-50 w-full max-w-md mx-auto",children:e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsxs("div",{className:"text-center py-8",children:[e.jsx(E,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),e.jsx("h1",{className:"text-2xl font-bold text-[#131313] mb-2",children:"Order Confirmed!"}),e.jsx("p",{className:"text-gray-600",children:"Your fuel order has been placed successfully"})]}),e.jsx(o,{children:e.jsxs(m,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"font-semibold text-[#131313]",children:"Order Status"}),e.jsx(k,{className:b(s.status),children:s.status.replace("_"," ")})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:w(s.status)}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[e.jsx(C,{className:"w-4 h-4"}),e.jsxs("span",{children:["Estimated delivery: ",s.estimatedDeliveryTime]})]}),j&&e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-green-600 mt-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{children:"Real-time updates active"})]})]})}),e.jsx(o,{children:e.jsxs(m,{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-[#131313] mb-3",children:"Order Details"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Order ID"}),e.jsx("span",{className:"font-medium",children:s.id})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Station"}),e.jsx("span",{className:"font-medium",children:s.stationName})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Fuel Type"}),e.jsx("span",{className:"font-medium",children:s.fuelType})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Quantity"}),e.jsxs("span",{className:"font-medium",children:[s.quantity,"L"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Total Amount"}),e.jsx("span",{className:"font-bold text-[#4682b4]",children:v(s.totalAmount)})]})]})]})}),e.jsx(o,{children:e.jsxs(m,{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-[#131313] mb-3",children:"Delivery Location"}),e.jsxs("div",{className:"flex items-start space-x-3 mb-3",children:[e.jsx(I,{className:"w-5 h-5 text-[#4682b4] mt-0.5"}),e.jsx("p",{className:"text-gray-600",children:s.deliveryAddress})]}),e.jsx("div",{className:"h-48 rounded-lg overflow-hidden",children:e.jsx(S,{showUserLocation:!1,showNearbyUsers:!1,className:"w-full h-full",userRole:"CONSUMER",center:{lat:s.deliveryLatitude,lng:s.deliveryLongitude},markers:[{lat:s.deliveryLatitude,lng:s.deliveryLongitude,title:"Delivery Location",type:"delivery"},...d?[{lat:d.lat,lng:d.lng,title:"Driver Location",type:"driver"}]:[]]})})]})}),s.driverName&&e.jsx(o,{children:e.jsxs(m,{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-[#131313] mb-3",children:"Your Driver"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-[#4682b4] rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-medium",children:s.driverName.charAt(0)})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-[#131313]",children:s.driverName}),e.jsx("p",{className:"text-sm text-gray-600",children:"Fuel Delivery Driver"}),d&&e.jsx("p",{className:"text-xs text-green-600",children:"Live tracking active"})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(n,{variant:"outline",size:"icon",onClick:()=>window.location.href=`tel:${s.driverPhone}`,children:e.jsx(T,{className:"w-4 h-4"})}),e.jsx(n,{variant:"outline",size:"icon",onClick:()=>l(`/chat/driver/${s.id}`),children:e.jsx(R,{className:"w-4 h-4"})})]})]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(n,{onClick:()=>l(`/track-order/${s.id}`),className:"w-full bg-[#4682b4] hover:bg-[#0b1a51] text-white",children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Track Order"]}),e.jsx(n,{variant:"outline",onClick:()=>l("/order-history"),className:"w-full border-[#4682b4] text-[#4682b4]",children:"View Order History"}),e.jsx(n,{variant:"ghost",onClick:()=>l("/consumer-home"),className:"w-full text-gray-600",children:"Back to Home"})]})]})})):e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-600",children:"Order not found"}),e.jsx(n,{onClick:()=>l("/consumer-home"),className:"mt-4",children:"Go Home"})]})})}export{$ as default};
//# sourceMappingURL=order-confirmation-C0N2nsXI.js.map
