var d=Object.defineProperty;var f=(l,i,o)=>i in l?d(l,i,{enumerable:!0,configurable:!0,writable:!0,value:o}):l[i]=o;var r=(l,i,o)=>f(l,typeof i!="symbol"?i+"":i,o);class p{constructor(){r(this,"callbacks");r(this,"googleInitialized",!1);r(this,"facebookInitialized",!1);r(this,"appleInitialized",!1)}setCallbacks(i,o){this.callbacks={onSuccess:i,onError:o}}async signInWithGoogle(){var i,o,e;try{if(!this.googleInitialized)throw new Error("Google Sign-In not initialized");if(!((i=window.google)!=null&&i.accounts)){const a=await fetch("/api/auth/social-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider:"google"})});if(!a.ok)throw new Error("Google authentication failed");const t=await a.json();t.success&&((o=this.callbacks)!=null&&o.onSuccess)&&await this.callbacks.onSuccess(t.profile);return}window.google.accounts.oauth2.initTokenClient({client_id:void 0,scope:"email profile",callback:async a=>{var t,c;try{const n=await(await fetch(`https://www.googleapis.com/oauth2/v2/userinfo?access_token=${a.access_token}`)).json(),h={id:n.id,email:n.email,name:n.name,provider:"google",avatar:n.picture};(t=this.callbacks)!=null&&t.onSuccess&&await this.callbacks.onSuccess(h)}catch(s){(c=this.callbacks)!=null&&c.onError&&this.callbacks.onError(s)}}}).requestAccessToken()}catch(a){(e=this.callbacks)!=null&&e.onError&&this.callbacks.onError(a)}}async signInWithApple(){var i,o;try{if(!this.appleInitialized)throw new Error("Apple Sign-In not initialized");if(!window.AppleID){const e=await fetch("/api/auth/social-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider:"apple"})});if(!e.ok)throw new Error("Apple authentication failed");const a=await e.json();a.success&&((i=this.callbacks)!=null&&i.onSuccess)&&await this.callbacks.onSuccess(a.profile);return}window.AppleID.auth.signIn().then(e=>{var c,s,n;const{authorization:a}=e,t={id:a.user,email:a.email||"",name:`${((c=a.name)==null?void 0:c.firstName)||""} ${((s=a.name)==null?void 0:s.lastName)||""}`.trim(),provider:"apple"};(n=this.callbacks)!=null&&n.onSuccess&&this.callbacks.onSuccess(t)})}catch(e){(o=this.callbacks)!=null&&o.onError&&this.callbacks.onError(e)}}async signInWithFacebook(){var i,o;try{if(!this.facebookInitialized)throw new Error("Facebook SDK not initialized");if(!window.FB){const e=await fetch("/api/auth/social-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider:"facebook"})});if(!e.ok)throw new Error("Facebook authentication failed");const a=await e.json();a.success&&((i=this.callbacks)!=null&&i.onSuccess)&&await this.callbacks.onSuccess(a.profile);return}window.FB.login(e=>{var a;e.authResponse?window.FB.api("/me",{fields:"name,email,picture"},t=>{var s,n,h;const c={id:t.id,email:t.email,name:t.name,provider:"facebook",avatar:(n=(s=t.picture)==null?void 0:s.data)==null?void 0:n.url};(h=this.callbacks)!=null&&h.onSuccess&&this.callbacks.onSuccess(c)}):(a=this.callbacks)!=null&&a.onError&&this.callbacks.onError(new Error("Facebook login cancelled"))},{scope:"email"})}catch(e){(o=this.callbacks)!=null&&o.onError&&this.callbacks.onError(e)}}async initialize(){try{await this.initializeGoogle(),await this.initializeFacebook(),await this.initializeApple(),console.log("Social auth providers initialized")}catch(i){console.error("Failed to initialize social auth:",i)}}async initializeGoogle(){try{typeof window<"u"}catch(i){console.warn("Google Sign-In initialization failed:",i)}}async initializeFacebook(){try{typeof window<"u"}catch(i){console.warn("Facebook SDK initialization failed:",i)}}async initializeApple(){try{typeof window<"u"}catch(i){console.warn("Apple Sign-In initialization failed:",i)}}isGoogleAvailable(){return this.googleInitialized&&!1}isAppleAvailable(){return this.appleInitialized&&!1}isFacebookAvailable(){return this.facebookInitialized&&!1}}const w=new p;w.initialize().catch(console.error);export{w as socialAuth};
//# sourceMappingURL=social-auth-B25nWjSb.js.map
