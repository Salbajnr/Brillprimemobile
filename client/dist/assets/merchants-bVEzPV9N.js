import{c as v,u as b,r as l,e as y,j as e,B as a,A as w,aR as C,S,I as E,m as A,n as L,g as k,k as T}from"./index-CVqmz7v7.js";import{A as R,b as I,a as P}from"./avatar-aX6vUNG7.js";import{S as M}from"./star-CubuygiY.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=v("BadgeCheck",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);function H(){const[,d]=b(),[c,j]=l.useState(""),[t,m]=l.useState(""),[r,i]=l.useState(null),N=["RESTAURANT","SUPERMARKET","APPAREL","BEAUTY_COSMETICS","ELECTRONICS","MEDICAL_HEALTH","VEHICLE_SERVICE","OTHER"];l.useEffect(()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(s=>{i({lat:s.coords.latitude,lng:s.coords.longitude})},s=>{console.log("Location access denied:",s),i({lat:6.5244,lng:3.3792})}):i({lat:6.5244,lng:3.3792})},[]);const{data:o,isLoading:x,error:g}=y({queryKey:["/api/merchants/search",r,t,c],queryFn:async()=>{const s=new URLSearchParams;r&&(s.append("lat",r.lat.toString()),s.append("lng",r.lng.toString())),t&&s.append("category",t),c&&s.append("searchTerm",c),s.append("radius","10");const n=await fetch(`/api/merchants/search?${s}`);if(!n.ok)throw new Error("Failed to fetch merchants");return n.json()},enabled:!!r}),h=(o==null?void 0:o.merchants)||[],f=s=>{d(`/merchants/${s.id}`)},p=()=>{},u=s=>s.split("_").map(n=>n.charAt(0)+n.slice(1).toLowerCase()).join(" ");return e.jsxs("div",{className:"w-full max-w-md mx-auto min-h-screen bg-gray-50",children:[e.jsxs("div",{className:"bg-white border-b border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(a,{variant:"ghost",size:"sm",onClick:()=>d("/consumer-home"),className:"p-2",children:e.jsx(w,{className:"h-5 w-5"})}),e.jsx("h1",{className:"text-lg font-semibold",children:"Find Merchants"}),e.jsx(a,{variant:"ghost",size:"sm",className:"p-2",children:e.jsx(C,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"flex space-x-2 mb-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(S,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(E,{placeholder:"Search merchants...",value:c,onChange:s=>j(s.target.value),className:"pl-10",onKeyPress:s=>s.key==="Enter"&&p()})]}),e.jsx(a,{onClick:p,className:"bg-blue-600 hover:bg-blue-700",children:"Search"})]}),e.jsxs("div",{className:"flex space-x-2 overflow-x-auto pb-2",children:[e.jsx(a,{variant:t===""?"default":"outline",size:"sm",onClick:()=>m(""),className:"whitespace-nowrap",children:"All"}),N.map(s=>e.jsx(a,{variant:t===s?"default":"outline",size:"sm",onClick:()=>m(s),className:"whitespace-nowrap",children:u(s)},s))]})]}),x&&e.jsxs("div",{className:"p-4 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Finding merchants near you..."})]}),g&&e.jsxs("div",{className:"p-4 text-center",children:[e.jsx("p",{className:"text-red-600",children:"Failed to load merchants. Please try again."}),e.jsx(a,{onClick:()=>window.location.reload(),className:"mt-2",children:"Retry"})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[h.length===0&&!x&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-gray-600",children:"No merchants found in your area."}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Try adjusting your search or location."})]}),h.map(s=>e.jsx(A,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>f(s),children:e.jsx(L,{className:"p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsxs(R,{className:"h-12 w-12",children:[e.jsx(I,{src:s.businessLogo}),e.jsx(P,{children:s.businessName.charAt(0)})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:s.businessName}),s.isVerified&&e.jsx(B,{className:"h-4 w-4 text-blue-600"})]}),e.jsx(k,{variant:"secondary",className:"text-xs mb-2",children:u(s.businessType)}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 mb-2",children:s.businessDescription}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(M,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{children:s.rating}),e.jsxs("span",{children:["(",s.reviewCount,")"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(T,{className:"h-4 w-4"}),e.jsx("span",{className:"truncate",children:s.businessAddress})]})]})]})]})})},s.id))]})]})}export{H as default};
//# sourceMappingURL=merchants-bVEzPV9N.js.map
