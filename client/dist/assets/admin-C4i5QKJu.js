import{r as c,u as vi,R as Cr,a as de,b as bi,c as Ut}from"./router-DDmgEVBz.js";import{r as ji,a as Er,g as Rr}from"./vendor-DgTrhVr3.js";import{S as se,E as Ni,a as tt,H as wi,U as st,b as Je,D as Ye,c as Si,M as Ci,d as kr,T as ue,C as Tr,e as Ei,L as Ri,A as we,f as Tt,g as Ar,h as ki,i as Us,j as At,X as We,F as Or,R as je,k as Ti,l as ge,m as Ne,P as Bs,n as xt,o as $s,p as bs,q as Bt,r as ss,s as _r,t as rs,W as Ai,u as qs,v as Oi,N as _i,B as Pi,w as Di,x as Ii,y as Mi,z as St,G as Vs,I as Fi,J as Li,K as Ui,O as Bi}from"./ui-C-L56zRJ.js";var $t={exports:{}},Ue={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zs;function $i(){if(zs)return Ue;zs=1;var e=ji(),s=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function l(o,h,p){var u,m={},f=null,R=null;p!==void 0&&(f=""+p),h.key!==void 0&&(f=""+h.key),h.ref!==void 0&&(R=h.ref);for(u in h)n.call(h,u)&&!a.hasOwnProperty(u)&&(m[u]=h[u]);if(o&&o.defaultProps)for(u in h=o.defaultProps,h)m[u]===void 0&&(m[u]=h[u]);return{$$typeof:s,type:o,key:f,ref:R,props:m,_owner:i.current}}return Ue.Fragment=r,Ue.jsx=l,Ue.jsxs=l,Ue}var Ws;function qi(){return Ws||(Ws=1,$t.exports=$i()),$t.exports}var t=qi(),ot={},Ks;function Vi(){if(Ks)return ot;Ks=1;var e=Er();return ot.createRoot=e.createRoot,ot.hydrateRoot=e.hydrateRoot,ot}var zi=Vi();const Wi=Rr(zi);var Me=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Se=typeof window>"u"||"Deno"in globalThis;function G(){}function Ki(e,s){return typeof e=="function"?e(s):e}function ns(e){return typeof e=="number"&&e>=0&&e!==1/0}function Pr(e,s){return Math.max(e+(s||0)-Date.now(),0)}function ye(e,s){return typeof e=="function"?e(s):e}function Z(e,s){return typeof e=="function"?e(s):e}function Hs(e,s){const{type:r="all",exact:n,fetchStatus:i,predicate:a,queryKey:l,stale:o}=e;if(l){if(n){if(s.queryHash!==js(l,s.options))return!1}else if(!Xe(s.queryKey,l))return!1}if(r!=="all"){const h=s.isActive();if(r==="active"&&!h||r==="inactive"&&h)return!1}return!(typeof o=="boolean"&&s.isStale()!==o||i&&i!==s.state.fetchStatus||a&&!a(s))}function Gs(e,s){const{exact:r,status:n,predicate:i,mutationKey:a}=e;if(a){if(!s.options.mutationKey)return!1;if(r){if(Ce(s.options.mutationKey)!==Ce(a))return!1}else if(!Xe(s.options.mutationKey,a))return!1}return!(n&&s.state.status!==n||i&&!i(s))}function js(e,s){return(s?.queryKeyHashFn||Ce)(e)}function Ce(e){return JSON.stringify(e,(s,r)=>is(r)?Object.keys(r).sort().reduce((n,i)=>(n[i]=r[i],n),{}):r)}function Xe(e,s){return e===s?!0:typeof e!=typeof s?!1:e&&s&&typeof e=="object"&&typeof s=="object"?Object.keys(s).every(r=>Xe(e[r],s[r])):!1}function Dr(e,s){if(e===s)return e;const r=Qs(e)&&Qs(s);if(r||is(e)&&is(s)){const n=r?e:Object.keys(e),i=n.length,a=r?s:Object.keys(s),l=a.length,o=r?[]:{},h=new Set(n);let p=0;for(let u=0;u<l;u++){const m=r?u:a[u];(!r&&h.has(m)||r)&&e[m]===void 0&&s[m]===void 0?(o[m]=void 0,p++):(o[m]=Dr(e[m],s[m]),o[m]===e[m]&&e[m]!==void 0&&p++)}return i===l&&p===i?e:o}return s}function Ct(e,s){if(!s||Object.keys(e).length!==Object.keys(s).length)return!1;for(const r in e)if(e[r]!==s[r])return!1;return!0}function Qs(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function is(e){if(!Js(e))return!1;const s=e.constructor;if(s===void 0)return!0;const r=s.prototype;return!(!Js(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function Js(e){return Object.prototype.toString.call(e)==="[object Object]"}function Hi(e){return new Promise(s=>{setTimeout(s,e)})}function as(e,s,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,s):r.structuralSharing!==!1?Dr(e,s):s}function Gi(e,s,r=0){const n=[...e,s];return r&&n.length>r?n.slice(1):n}function Qi(e,s,r=0){const n=[s,...e];return r&&n.length>r?n.slice(0,-1):n}var Ns=Symbol();function Ir(e,s){return!e.queryFn&&s?.initialPromise?()=>s.initialPromise:!e.queryFn||e.queryFn===Ns?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function Mr(e,s){return typeof e=="function"?e(...s):!!e}var Ji=class extends Me{#t;#e;#s;constructor(){super(),this.#s=e=>{if(!Se&&window.addEventListener){const s=()=>e();return window.addEventListener("visibilitychange",s,!1),()=>{window.removeEventListener("visibilitychange",s)}}}}onSubscribe(){this.#e||this.setEventListener(this.#s)}onUnsubscribe(){this.hasListeners()||(this.#e?.(),this.#e=void 0)}setEventListener(e){this.#s=e,this.#e?.(),this.#e=e(s=>{typeof s=="boolean"?this.setFocused(s):this.onFocus()})}setFocused(e){this.#t!==e&&(this.#t=e,this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(s=>{s(e)})}isFocused(){return typeof this.#t=="boolean"?this.#t:globalThis.document?.visibilityState!=="hidden"}},ws=new Ji,Yi=class extends Me{#t=!0;#e;#s;constructor(){super(),this.#s=e=>{if(!Se&&window.addEventListener){const s=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",s,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",r)}}}}onSubscribe(){this.#e||this.setEventListener(this.#s)}onUnsubscribe(){this.hasListeners()||(this.#e?.(),this.#e=void 0)}setEventListener(e){this.#s=e,this.#e?.(),this.#e=e(this.setOnline.bind(this))}setOnline(e){this.#t!==e&&(this.#t=e,this.listeners.forEach(r=>{r(e)}))}isOnline(){return this.#t}},Et=new Yi;function os(){let e,s;const r=new Promise((i,a)=>{e=i,s=a});r.status="pending",r.catch(()=>{});function n(i){Object.assign(r,i),delete r.resolve,delete r.reject}return r.resolve=i=>{n({status:"fulfilled",value:i}),e(i)},r.reject=i=>{n({status:"rejected",reason:i}),s(i)},r}function Xi(e){return Math.min(1e3*2**e,3e4)}function Fr(e){return(e??"online")==="online"?Et.isOnline():!0}var Lr=class extends Error{constructor(e){super("CancelledError"),this.revert=e?.revert,this.silent=e?.silent}};function Ur(e){let s=!1,r=0,n;const i=os(),a=()=>i.status!=="pending",l=x=>{a()||(f(new Lr(x)),e.abort?.())},o=()=>{s=!0},h=()=>{s=!1},p=()=>ws.isFocused()&&(e.networkMode==="always"||Et.isOnline())&&e.canRun(),u=()=>Fr(e.networkMode)&&e.canRun(),m=x=>{a()||(n?.(),i.resolve(x))},f=x=>{a()||(n?.(),i.reject(x))},R=()=>new Promise(x=>{n=g=>{(a()||p())&&x(g)},e.onPause?.()}).then(()=>{n=void 0,a()||e.onContinue?.()}),k=()=>{if(a())return;let x;const g=r===0?e.initialPromise:void 0;try{x=g??e.fn()}catch(S){x=Promise.reject(S)}Promise.resolve(x).then(m).catch(S=>{if(a())return;const C=e.retry??(Se?0:3),E=e.retryDelay??Xi,N=typeof E=="function"?E(r,S):E,y=C===!0||typeof C=="number"&&r<C||typeof C=="function"&&C(r,S);if(s||!y){f(S);return}r++,e.onFail?.(r,S),Hi(N).then(()=>p()?void 0:R()).then(()=>{s?f(S):k()})})};return{promise:i,status:()=>i.status,cancel:l,continue:()=>(n?.(),i),cancelRetry:o,continueRetry:h,canStart:u,start:()=>(u()?k():R().then(k),i)}}var Zi=e=>setTimeout(e,0);function ea(){let e=[],s=0,r=o=>{o()},n=o=>{o()},i=Zi;const a=o=>{s?e.push(o):i(()=>{r(o)})},l=()=>{const o=e;e=[],o.length&&i(()=>{n(()=>{o.forEach(h=>{r(h)})})})};return{batch:o=>{let h;s++;try{h=o()}finally{s--,s||l()}return h},batchCalls:o=>(...h)=>{a(()=>{o(...h)})},schedule:a,setNotifyFunction:o=>{r=o},setBatchNotifyFunction:o=>{n=o},setScheduler:o=>{i=o}}}var q=ea(),Br=class{#t;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),ns(this.gcTime)&&(this.#t=setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Se?1/0:300*1e3))}clearGcTimeout(){this.#t&&(clearTimeout(this.#t),this.#t=void 0)}},ta=class extends Br{#t;#e;#s;#r;#n;#a;#o;constructor(e){super(),this.#o=!1,this.#a=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.#r=e.client,this.#s=this.#r.getQueryCache(),this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.#t=sa(this.options),this.state=e.state??this.#t,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#n?.promise}setOptions(e){this.options={...this.#a,...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#s.remove(this)}setData(e,s){const r=as(this.state.data,e,this.options);return this.#i({data:r,type:"success",dataUpdatedAt:s?.updatedAt,manual:s?.manual}),r}setState(e,s){this.#i({type:"setState",state:e,setStateOptions:s})}cancel(e){const s=this.#n?.promise;return this.#n?.cancel(e),s?s.then(G).catch(G):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#t)}isActive(){return this.observers.some(e=>Z(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Ns||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>ye(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!Pr(this.state.dataUpdatedAt,e)}onFocus(){this.observers.find(s=>s.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#n?.continue()}onOnline(){this.observers.find(s=>s.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#n?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.#s.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(s=>s!==e),this.observers.length||(this.#n&&(this.#o?this.#n.cancel({revert:!0}):this.#n.cancelRetry()),this.scheduleGc()),this.#s.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#i({type:"invalidate"})}async fetch(e,s){if(this.state.fetchStatus!=="idle"&&this.#n?.status()!=="rejected"){if(this.state.data!==void 0&&s?.cancelRefetch)this.cancel({silent:!0});else if(this.#n)return this.#n.continueRetry(),this.#n.promise}if(e&&this.setOptions(e),!this.options.queryFn){const o=this.observers.find(h=>h.options.queryFn);o&&this.setOptions(o.options)}const r=new AbortController,n=o=>{Object.defineProperty(o,"signal",{enumerable:!0,get:()=>(this.#o=!0,r.signal)})},i=()=>{const o=Ir(this.options,s),p=(()=>{const u={client:this.#r,queryKey:this.queryKey,meta:this.meta};return n(u),u})();return this.#o=!1,this.options.persister?this.options.persister(o,p,this):o(p)},l=(()=>{const o={fetchOptions:s,options:this.options,queryKey:this.queryKey,client:this.#r,state:this.state,fetchFn:i};return n(o),o})();this.options.behavior?.onFetch(l,this),this.#e=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==l.fetchOptions?.meta)&&this.#i({type:"fetch",meta:l.fetchOptions?.meta}),this.#n=Ur({initialPromise:s?.initialPromise,fn:l.fetchFn,abort:r.abort.bind(r),onFail:(o,h)=>{this.#i({type:"failed",failureCount:o,error:h})},onPause:()=>{this.#i({type:"pause"})},onContinue:()=>{this.#i({type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0});try{const o=await this.#n.start();if(o===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(o),this.#s.config.onSuccess?.(o,this),this.#s.config.onSettled?.(o,this.state.error,this),o}catch(o){if(o instanceof Lr){if(o.silent)return this.#n.promise;if(o.revert){if(this.setState({...this.#e,fetchStatus:"idle"}),this.state.data===void 0)throw o;return this.state.data}}throw this.#i({type:"error",error:o}),this.#s.config.onError?.(o,this),this.#s.config.onSettled?.(this.state.data,o,this),o}finally{this.scheduleGc()}}#i(e){const s=r=>{switch(e.type){case"failed":return{...r,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...$r(r.data,this.options),fetchMeta:e.meta??null};case"success":const n={...r,data:e.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#e=e.manual?n:void 0,n;case"error":const i=e.error;return{...r,error:i,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...e.state}}};this.state=s(this.state),q.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),this.#s.notify({query:this,type:"updated",action:e})})}};function $r(e,s){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Fr(s.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function sa(e){const s=typeof e.initialData=="function"?e.initialData():e.initialData,r=s!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:s,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var ra=class extends Me{constructor(e={}){super(),this.config=e,this.#t=new Map}#t;build(e,s,r){const n=s.queryKey,i=s.queryHash??js(n,s);let a=this.get(i);return a||(a=new ta({client:e,queryKey:n,queryHash:i,options:e.defaultQueryOptions(s),state:r,defaultOptions:e.getQueryDefaults(n)}),this.add(a)),a}add(e){this.#t.has(e.queryHash)||(this.#t.set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const s=this.#t.get(e.queryHash);s&&(e.destroy(),s===e&&this.#t.delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){q.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return this.#t.get(e)}getAll(){return[...this.#t.values()]}find(e){const s={exact:!0,...e};return this.getAll().find(r=>Hs(s,r))}findAll(e={}){const s=this.getAll();return Object.keys(e).length>0?s.filter(r=>Hs(e,r)):s}notify(e){q.batch(()=>{this.listeners.forEach(s=>{s(e)})})}onFocus(){q.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){q.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},na=class extends Br{#t;#e;#s;constructor(e){super(),this.mutationId=e.mutationId,this.#e=e.mutationCache,this.#t=[],this.state=e.state||qr(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#t.includes(e)||(this.#t.push(e),this.clearGcTimeout(),this.#e.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#t=this.#t.filter(s=>s!==e),this.scheduleGc(),this.#e.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#e.remove(this))}continue(){return this.#s?.continue()??this.execute(this.state.variables)}async execute(e){const s=()=>{this.#r({type:"continue"})};this.#s=Ur({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(i,a)=>{this.#r({type:"failed",failureCount:i,error:a})},onPause:()=>{this.#r({type:"pause"})},onContinue:s,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#e.canRun(this)});const r=this.state.status==="pending",n=!this.#s.canStart();try{if(r)s();else{this.#r({type:"pending",variables:e,isPaused:n}),await this.#e.config.onMutate?.(e,this);const a=await this.options.onMutate?.(e);a!==this.state.context&&this.#r({type:"pending",context:a,variables:e,isPaused:n})}const i=await this.#s.start();return await this.#e.config.onSuccess?.(i,e,this.state.context,this),await this.options.onSuccess?.(i,e,this.state.context),await this.#e.config.onSettled?.(i,null,this.state.variables,this.state.context,this),await this.options.onSettled?.(i,null,e,this.state.context),this.#r({type:"success",data:i}),i}catch(i){try{throw await this.#e.config.onError?.(i,e,this.state.context,this),await this.options.onError?.(i,e,this.state.context),await this.#e.config.onSettled?.(void 0,i,this.state.variables,this.state.context,this),await this.options.onSettled?.(void 0,i,e,this.state.context),i}finally{this.#r({type:"error",error:i})}}finally{this.#e.runNext(this)}}#r(e){const s=r=>{switch(e.type){case"failed":return{...r,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...r,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:e.error,failureCount:r.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=s(this.state),q.batch(()=>{this.#t.forEach(r=>{r.onMutationUpdate(e)}),this.#e.notify({mutation:this,type:"updated",action:e})})}};function qr(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var ia=class extends Me{constructor(e={}){super(),this.config=e,this.#t=new Set,this.#e=new Map,this.#s=0}#t;#e;#s;build(e,s,r){const n=new na({mutationCache:this,mutationId:++this.#s,options:e.defaultMutationOptions(s),state:r});return this.add(n),n}add(e){this.#t.add(e);const s=lt(e);if(typeof s=="string"){const r=this.#e.get(s);r?r.push(e):this.#e.set(s,[e])}this.notify({type:"added",mutation:e})}remove(e){if(this.#t.delete(e)){const s=lt(e);if(typeof s=="string"){const r=this.#e.get(s);if(r)if(r.length>1){const n=r.indexOf(e);n!==-1&&r.splice(n,1)}else r[0]===e&&this.#e.delete(s)}}this.notify({type:"removed",mutation:e})}canRun(e){const s=lt(e);if(typeof s=="string"){const n=this.#e.get(s)?.find(i=>i.state.status==="pending");return!n||n===e}else return!0}runNext(e){const s=lt(e);return typeof s=="string"?this.#e.get(s)?.find(n=>n!==e&&n.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){q.batch(()=>{this.#t.forEach(e=>{this.notify({type:"removed",mutation:e})}),this.#t.clear(),this.#e.clear()})}getAll(){return Array.from(this.#t)}find(e){const s={exact:!0,...e};return this.getAll().find(r=>Gs(s,r))}findAll(e={}){return this.getAll().filter(s=>Gs(e,s))}notify(e){q.batch(()=>{this.listeners.forEach(s=>{s(e)})})}resumePausedMutations(){const e=this.getAll().filter(s=>s.state.isPaused);return q.batch(()=>Promise.all(e.map(s=>s.continue().catch(G))))}};function lt(e){return e.options.scope?.id}function Ys(e){return{onFetch:(s,r)=>{const n=s.options,i=s.fetchOptions?.meta?.fetchMore?.direction,a=s.state.data?.pages||[],l=s.state.data?.pageParams||[];let o={pages:[],pageParams:[]},h=0;const p=async()=>{let u=!1;const m=k=>{Object.defineProperty(k,"signal",{enumerable:!0,get:()=>(s.signal.aborted?u=!0:s.signal.addEventListener("abort",()=>{u=!0}),s.signal)})},f=Ir(s.options,s.fetchOptions),R=async(k,x,g)=>{if(u)return Promise.reject();if(x==null&&k.pages.length)return Promise.resolve(k);const C=(()=>{const P={client:s.client,queryKey:s.queryKey,pageParam:x,direction:g?"backward":"forward",meta:s.options.meta};return m(P),P})(),E=await f(C),{maxPages:N}=s.options,y=g?Qi:Gi;return{pages:y(k.pages,E,N),pageParams:y(k.pageParams,x,N)}};if(i&&a.length){const k=i==="backward",x=k?aa:Xs,g={pages:a,pageParams:l},S=x(n,g);o=await R(g,S,k)}else{const k=e??a.length;do{const x=h===0?l[0]??n.initialPageParam:Xs(n,o);if(h>0&&x==null)break;o=await R(o,x),h++}while(h<k)}return o};s.options.persister?s.fetchFn=()=>s.options.persister?.(p,{client:s.client,queryKey:s.queryKey,meta:s.options.meta,signal:s.signal},r):s.fetchFn=p}}}function Xs(e,{pages:s,pageParams:r}){const n=s.length-1;return s.length>0?e.getNextPageParam(s[n],s,r[n],r):void 0}function aa(e,{pages:s,pageParams:r}){return s.length>0?e.getPreviousPageParam?.(s[0],s,r[0],r):void 0}var oa=class{#t;#e;#s;#r;#n;#a;#o;#i;constructor(e={}){this.#t=e.queryCache||new ra,this.#e=e.mutationCache||new ia,this.#s=e.defaultOptions||{},this.#r=new Map,this.#n=new Map,this.#a=0}mount(){this.#a++,this.#a===1&&(this.#o=ws.subscribe(async e=>{e&&(await this.resumePausedMutations(),this.#t.onFocus())}),this.#i=Et.subscribe(async e=>{e&&(await this.resumePausedMutations(),this.#t.onOnline())}))}unmount(){this.#a--,this.#a===0&&(this.#o?.(),this.#o=void 0,this.#i?.(),this.#i=void 0)}isFetching(e){return this.#t.findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return this.#e.findAll({...e,status:"pending"}).length}getQueryData(e){const s=this.defaultQueryOptions({queryKey:e});return this.#t.get(s.queryHash)?.state.data}ensureQueryData(e){const s=this.defaultQueryOptions(e),r=this.#t.build(this,s),n=r.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(ye(s.staleTime,r))&&this.prefetchQuery(s),Promise.resolve(n))}getQueriesData(e){return this.#t.findAll(e).map(({queryKey:s,state:r})=>{const n=r.data;return[s,n]})}setQueryData(e,s,r){const n=this.defaultQueryOptions({queryKey:e}),a=this.#t.get(n.queryHash)?.state.data,l=Ki(s,a);if(l!==void 0)return this.#t.build(this,n).setData(l,{...r,manual:!0})}setQueriesData(e,s,r){return q.batch(()=>this.#t.findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,s,r)]))}getQueryState(e){const s=this.defaultQueryOptions({queryKey:e});return this.#t.get(s.queryHash)?.state}removeQueries(e){const s=this.#t;q.batch(()=>{s.findAll(e).forEach(r=>{s.remove(r)})})}resetQueries(e,s){const r=this.#t;return q.batch(()=>(r.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...e},s)))}cancelQueries(e,s={}){const r={revert:!0,...s},n=q.batch(()=>this.#t.findAll(e).map(i=>i.cancel(r)));return Promise.all(n).then(G).catch(G)}invalidateQueries(e,s={}){return q.batch(()=>(this.#t.findAll(e).forEach(r=>{r.invalidate()}),e?.refetchType==="none"?Promise.resolve():this.refetchQueries({...e,type:e?.refetchType??e?.type??"active"},s)))}refetchQueries(e,s={}){const r={...s,cancelRefetch:s.cancelRefetch??!0},n=q.batch(()=>this.#t.findAll(e).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let a=i.fetch(void 0,r);return r.throwOnError||(a=a.catch(G)),i.state.fetchStatus==="paused"?Promise.resolve():a}));return Promise.all(n).then(G)}fetchQuery(e){const s=this.defaultQueryOptions(e);s.retry===void 0&&(s.retry=!1);const r=this.#t.build(this,s);return r.isStaleByTime(ye(s.staleTime,r))?r.fetch(s):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(G).catch(G)}fetchInfiniteQuery(e){return e.behavior=Ys(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(G).catch(G)}ensureInfiniteQueryData(e){return e.behavior=Ys(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Et.isOnline()?this.#e.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#t}getMutationCache(){return this.#e}getDefaultOptions(){return this.#s}setDefaultOptions(e){this.#s=e}setQueryDefaults(e,s){this.#r.set(Ce(e),{queryKey:e,defaultOptions:s})}getQueryDefaults(e){const s=[...this.#r.values()],r={};return s.forEach(n=>{Xe(e,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(e,s){this.#n.set(Ce(e),{mutationKey:e,defaultOptions:s})}getMutationDefaults(e){const s=[...this.#n.values()],r={};return s.forEach(n=>{Xe(e,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const s={...this.#s.queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return s.queryHash||(s.queryHash=js(s.queryKey,s)),s.refetchOnReconnect===void 0&&(s.refetchOnReconnect=s.networkMode!=="always"),s.throwOnError===void 0&&(s.throwOnError=!!s.suspense),!s.networkMode&&s.persister&&(s.networkMode="offlineFirst"),s.queryFn===Ns&&(s.enabled=!1),s}defaultMutationOptions(e){return e?._defaulted?e:{...this.#s.mutations,...e?.mutationKey&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){this.#t.clear(),this.#e.clear()}},la=class extends Me{constructor(e,s){super(),this.options=s,this.#t=e,this.#i=null,this.#o=os(),this.bindMethods(),this.setOptions(s)}#t;#e=void 0;#s=void 0;#r=void 0;#n;#a;#o;#i;#p;#h;#m;#c;#d;#l;#f=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#e.addObserver(this),Zs(this.#e,this.options)?this.#u():this.updateResult(),this.#v())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return ls(this.#e,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return ls(this.#e,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#b(),this.#j(),this.#e.removeObserver(this)}setOptions(e){const s=this.options,r=this.#e;if(this.options=this.#t.defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Z(this.options.enabled,this.#e)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#N(),this.#e.setOptions(this.options),s._defaulted&&!Ct(this.options,s)&&this.#t.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#e,observer:this});const n=this.hasListeners();n&&er(this.#e,r,this.options,s)&&this.#u(),this.updateResult(),n&&(this.#e!==r||Z(this.options.enabled,this.#e)!==Z(s.enabled,this.#e)||ye(this.options.staleTime,this.#e)!==ye(s.staleTime,this.#e))&&this.#x();const i=this.#g();n&&(this.#e!==r||Z(this.options.enabled,this.#e)!==Z(s.enabled,this.#e)||i!==this.#l)&&this.#y(i)}getOptimisticResult(e){const s=this.#t.getQueryCache().build(this.#t,e),r=this.createResult(s,e);return da(this,r)&&(this.#r=r,this.#a=this.options,this.#n=this.#e.state),r}getCurrentResult(){return this.#r}trackResult(e,s){return new Proxy(e,{get:(r,n)=>(this.trackProp(n),s?.(n),n==="promise"&&!this.options.experimental_prefetchInRender&&this.#o.status==="pending"&&this.#o.reject(new Error("experimental_prefetchInRender feature flag is not enabled")),Reflect.get(r,n))})}trackProp(e){this.#f.add(e)}getCurrentQuery(){return this.#e}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const s=this.#t.defaultQueryOptions(e),r=this.#t.getQueryCache().build(this.#t,s);return r.fetch().then(()=>this.createResult(r,s))}fetch(e){return this.#u({...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#r))}#u(e){this.#N();let s=this.#e.fetch(this.options,e);return e?.throwOnError||(s=s.catch(G)),s}#x(){this.#b();const e=ye(this.options.staleTime,this.#e);if(Se||this.#r.isStale||!ns(e))return;const r=Pr(this.#r.dataUpdatedAt,e)+1;this.#c=setTimeout(()=>{this.#r.isStale||this.updateResult()},r)}#g(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#e):this.options.refetchInterval)??!1}#y(e){this.#j(),this.#l=e,!(Se||Z(this.options.enabled,this.#e)===!1||!ns(this.#l)||this.#l===0)&&(this.#d=setInterval(()=>{(this.options.refetchIntervalInBackground||ws.isFocused())&&this.#u()},this.#l))}#v(){this.#x(),this.#y(this.#g())}#b(){this.#c&&(clearTimeout(this.#c),this.#c=void 0)}#j(){this.#d&&(clearInterval(this.#d),this.#d=void 0)}createResult(e,s){const r=this.#e,n=this.options,i=this.#r,a=this.#n,l=this.#a,h=e!==r?e.state:this.#s,{state:p}=e;let u={...p},m=!1,f;if(s._optimisticResults){const v=this.hasListeners(),D=!v&&Zs(e,s),w=v&&er(e,r,s,n);(D||w)&&(u={...u,...$r(p.data,e.options)}),s._optimisticResults==="isRestoring"&&(u.fetchStatus="idle")}let{error:R,errorUpdatedAt:k,status:x}=u;f=u.data;let g=!1;if(s.placeholderData!==void 0&&f===void 0&&x==="pending"){let v;i?.isPlaceholderData&&s.placeholderData===l?.placeholderData?(v=i.data,g=!0):v=typeof s.placeholderData=="function"?s.placeholderData(this.#m?.state.data,this.#m):s.placeholderData,v!==void 0&&(x="success",f=as(i?.data,v,s),m=!0)}if(s.select&&f!==void 0&&!g)if(i&&f===a?.data&&s.select===this.#p)f=this.#h;else try{this.#p=s.select,f=s.select(f),f=as(i?.data,f,s),this.#h=f,this.#i=null}catch(v){this.#i=v}this.#i&&(R=this.#i,f=this.#h,k=Date.now(),x="error");const S=u.fetchStatus==="fetching",C=x==="pending",E=x==="error",N=C&&S,y=f!==void 0,A={status:x,fetchStatus:u.fetchStatus,isPending:C,isSuccess:x==="success",isError:E,isInitialLoading:N,isLoading:N,data:f,dataUpdatedAt:u.dataUpdatedAt,error:R,errorUpdatedAt:k,failureCount:u.fetchFailureCount,failureReason:u.fetchFailureReason,errorUpdateCount:u.errorUpdateCount,isFetched:u.dataUpdateCount>0||u.errorUpdateCount>0,isFetchedAfterMount:u.dataUpdateCount>h.dataUpdateCount||u.errorUpdateCount>h.errorUpdateCount,isFetching:S,isRefetching:S&&!C,isLoadingError:E&&!y,isPaused:u.fetchStatus==="paused",isPlaceholderData:m,isRefetchError:E&&y,isStale:Ss(e,s),refetch:this.refetch,promise:this.#o,isEnabled:Z(s.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const v=_=>{A.status==="error"?_.reject(A.error):A.data!==void 0&&_.resolve(A.data)},D=()=>{const _=this.#o=A.promise=os();v(_)},w=this.#o;switch(w.status){case"pending":e.queryHash===r.queryHash&&v(w);break;case"fulfilled":(A.status==="error"||A.data!==w.value)&&D();break;case"rejected":(A.status!=="error"||A.error!==w.reason)&&D();break}}return A}updateResult(){const e=this.#r,s=this.createResult(this.#e,this.options);if(this.#n=this.#e.state,this.#a=this.options,this.#n.data!==void 0&&(this.#m=this.#e),Ct(s,e))return;this.#r=s;const r=()=>{if(!e)return!0;const{notifyOnChangeProps:n}=this.options,i=typeof n=="function"?n():n;if(i==="all"||!i&&!this.#f.size)return!0;const a=new Set(i??this.#f);return this.options.throwOnError&&a.add("error"),Object.keys(this.#r).some(l=>{const o=l;return this.#r[o]!==e[o]&&a.has(o)})};this.#w({listeners:r()})}#N(){const e=this.#t.getQueryCache().build(this.#t,this.options);if(e===this.#e)return;const s=this.#e;this.#e=e,this.#s=e.state,this.hasListeners()&&(s?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#v()}#w(e){q.batch(()=>{e.listeners&&this.listeners.forEach(s=>{s(this.#r)}),this.#t.getQueryCache().notify({query:this.#e,type:"observerResultsUpdated"})})}};function ca(e,s){return Z(s.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&s.retryOnMount===!1)}function Zs(e,s){return ca(e,s)||e.state.data!==void 0&&ls(e,s,s.refetchOnMount)}function ls(e,s,r){if(Z(s.enabled,e)!==!1&&ye(s.staleTime,e)!=="static"){const n=typeof r=="function"?r(e):r;return n==="always"||n!==!1&&Ss(e,s)}return!1}function er(e,s,r,n){return(e!==s||Z(n.enabled,e)===!1)&&(!r.suspense||e.state.status!=="error")&&Ss(e,r)}function Ss(e,s){return Z(s.enabled,e)!==!1&&e.isStaleByTime(ye(s.staleTime,e))}function da(e,s){return!Ct(e.getCurrentResult(),s)}var ua=class extends Me{#t;#e=void 0;#s;#r;constructor(s,r){super(),this.#t=s,this.setOptions(r),this.bindMethods(),this.#n()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(s){const r=this.options;this.options=this.#t.defaultMutationOptions(s),Ct(this.options,r)||this.#t.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#s,observer:this}),r?.mutationKey&&this.options.mutationKey&&Ce(r.mutationKey)!==Ce(this.options.mutationKey)?this.reset():this.#s?.state.status==="pending"&&this.#s.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#s?.removeObserver(this)}onMutationUpdate(s){this.#n(),this.#a(s)}getCurrentResult(){return this.#e}reset(){this.#s?.removeObserver(this),this.#s=void 0,this.#n(),this.#a()}mutate(s,r){return this.#r=r,this.#s?.removeObserver(this),this.#s=this.#t.getMutationCache().build(this.#t,this.options),this.#s.addObserver(this),this.#s.execute(s)}#n(){const s=this.#s?.state??qr();this.#e={...s,isPending:s.status==="pending",isSuccess:s.status==="success",isError:s.status==="error",isIdle:s.status==="idle",mutate:this.mutate,reset:this.reset}}#a(s){q.batch(()=>{if(this.#r&&this.hasListeners()){const r=this.#e.variables,n=this.#e.context;s?.type==="success"?(this.#r.onSuccess?.(s.data,r,n),this.#r.onSettled?.(s.data,null,r,n)):s?.type==="error"&&(this.#r.onError?.(s.error,r,n),this.#r.onSettled?.(void 0,s.error,r,n))}this.listeners.forEach(r=>{r(this.#e)})})}},Vr=c.createContext(void 0),rt=e=>{const s=c.useContext(Vr);if(!s)throw new Error("No QueryClient set, use QueryClientProvider to set one");return s},ha=({client:e,children:s})=>(c.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),t.jsx(Vr.Provider,{value:e,children:s})),zr=c.createContext(!1),ma=()=>c.useContext(zr);zr.Provider;function fa(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var pa=c.createContext(fa()),xa=()=>c.useContext(pa),ga=(e,s)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(s.isReset()||(e.retryOnMount=!1))},ya=e=>{c.useEffect(()=>{e.clearReset()},[e])},va=({result:e,errorResetBoundary:s,throwOnError:r,query:n,suspense:i})=>e.isError&&!s.isReset()&&!e.isFetching&&n&&(i&&e.data===void 0||Mr(r,[e.error,n])),ba=e=>{if(e.suspense){const s=n=>n==="static"?n:Math.max(n??1e3,1e3),r=e.staleTime;e.staleTime=typeof r=="function"?(...n)=>s(r(...n)):s(r),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},ja=(e,s)=>e.isLoading&&e.isFetching&&!s,Na=(e,s)=>e?.suspense&&s.isPending,tr=(e,s,r)=>s.fetchOptimistic(e).catch(()=>{r.clearReset()});function wa(e,s,r){const n=ma(),i=xa(),a=rt(),l=a.defaultQueryOptions(e);a.getDefaultOptions().queries?._experimental_beforeQuery?.(l),l._optimisticResults=n?"isRestoring":"optimistic",ba(l),ga(l,i),ya(i);const o=!a.getQueryCache().get(l.queryHash),[h]=c.useState(()=>new s(a,l)),p=h.getOptimisticResult(l),u=!n&&e.subscribed!==!1;if(c.useSyncExternalStore(c.useCallback(m=>{const f=u?h.subscribe(q.batchCalls(m)):G;return h.updateResult(),f},[h,u]),()=>h.getCurrentResult(),()=>h.getCurrentResult()),c.useEffect(()=>{h.setOptions(l)},[l,h]),Na(l,p))throw tr(l,h,i);if(va({result:p,errorResetBoundary:i,throwOnError:l.throwOnError,query:a.getQueryCache().get(l.queryHash),suspense:l.suspense}))throw p.error;return a.getDefaultOptions().queries?._experimental_afterQuery?.(l,p),l.experimental_prefetchInRender&&!Se&&ja(p,n)&&(o?tr(l,h,i):a.getQueryCache().get(l.queryHash)?.promise)?.catch(G).finally(()=>{h.updateResult()}),l.notifyOnChangeProps?p:h.trackResult(p)}function Oe(e,s){return wa(e,la)}function Ke(e,s){const r=rt(),[n]=c.useState(()=>new ua(r,e));c.useEffect(()=>{n.setOptions(e)},[n,e]);const i=c.useSyncExternalStore(c.useCallback(l=>n.subscribe(q.batchCalls(l)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),a=c.useCallback((l,o)=>{n.mutate(l,o).catch(G)},[n]);if(i.error&&Mr(n.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:a,mutateAsync:i.mutate}}const Sa=1,Ca=1e6;let qt=0;function Ea(){return qt=(qt+1)%Number.MAX_SAFE_INTEGER,qt.toString()}const Vt=new Map,sr=e=>{if(Vt.has(e))return;const s=setTimeout(()=>{Vt.delete(e),He({type:"REMOVE_TOAST",toastId:e})},Ca);Vt.set(e,s)},Ra=(e,s)=>{switch(s.type){case"ADD_TOAST":return{...e,toasts:[s.toast,...e.toasts].slice(0,Sa)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(r=>r.id===s.toast.id?{...r,...s.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=s;return r?sr(r):e.toasts.forEach(n=>{sr(n.id)}),{...e,toasts:e.toasts.map(n=>n.id===r||r===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return s.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(r=>r.id!==s.toastId)}}},gt=[];let yt={toasts:[]};function He(e){yt=Ra(yt,e),gt.forEach(s=>{s(yt)})}function ka({...e}){const s=Ea(),r=i=>He({type:"UPDATE_TOAST",toast:{...i,id:s}}),n=()=>He({type:"DISMISS_TOAST",toastId:s});return He({type:"ADD_TOAST",toast:{...e,id:s,open:!0,onOpenChange:i=>{i||n()}}}),{id:s,dismiss:n,update:r}}function Ot(){const[e,s]=c.useState(yt);return c.useEffect(()=>(gt.push(s),()=>{const r=gt.indexOf(s);r>-1&&gt.splice(r,1)}),[e]),{...e,toast:ka,dismiss:r=>He({type:"DISMISS_TOAST",toastId:r})}}function Ta(){const{toasts:e}=Ot();return t.jsx("div",{className:"fixed bottom-0 right-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",children:e.map(({id:s,title:r,description:n,action:i,...a})=>t.jsxs("div",{className:"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",...a,children:[t.jsxs("div",{className:"grid gap-1",children:[r&&t.jsx("div",{className:"text-sm font-semibold",children:r}),n&&t.jsx("div",{className:"text-sm opacity-90",children:n})]}),i]},s))})}const be={signIn:async({email:e,password:s})=>await Re("/auth/login",{method:"POST",body:JSON.stringify({email:e,password:s})}),signUp:async({email:e,password:s,fullName:r,role:n,phone:i})=>await Re("/auth/signup",{method:"POST",body:JSON.stringify({email:e,password:s,fullName:r,role:n,phone:i})}),validateSession:async()=>{const e=await Re("/auth/validate-session");return e.success?e.user:null},logout:async()=>await Re("/auth/logout",{method:"POST"}),fetchUser:async()=>await Re("/auth/me"),updateUser:async(e,s)=>await Re(`/auth/users/${e}`,{method:"PUT",body:JSON.stringify(s)})},Wr=c.createContext(null),Re=async(e,s={})=>{const r=await fetch(`/api${e}`,{credentials:"include",headers:{"Content-Type":"application/json",...s.headers},...s});if(r.status===204)return{success:r.ok,data:null,error:null,user:null};const n=await r.json();return{success:r.ok,data:r.ok?n:null,error:r.ok?null:n.message||n.error||"Request failed",user:n.user}};function Td({children:e}){const[s,r]=c.useState(null),[n,i]=c.useState(!0),[a,l]=c.useState(null),[o,h]=c.useState(!1),[p,u]=c.useState(!1);c.useEffect(()=>{(async()=>{try{const E=localStorage.getItem("user");if(E){const N=JSON.parse(E);console.log("Stored user data:",N);const y=await be.validateSession();y?(r(y),u(!0)):(localStorage.removeItem("user"),localStorage.removeItem("token"),r(null),u(!1))}else{const N=await be.validateSession();N?(r(N),u(!0),localStorage.setItem("user",JSON.stringify(N))):(r(null),u(!1))}}catch(E){console.error("Auth initialization error:",E),localStorage.removeItem("user"),localStorage.removeItem("token"),r(null),u(!1)}finally{h(!1),i(!1)}})()},[]);const m=async(C,E)=>{h(!0),g();try{const N=await be.signIn({email:C,password:E});if(N.success&&N.user)return r(N.user),u(!0),localStorage.setItem("user",JSON.stringify(N.user)),N.data?.token&&localStorage.setItem("token",N.data.token),N.user;throw new Error(N.error||"Login failed")}catch(N){throw console.error("Login error:",N),l(N.message||"Login failed. Please check your credentials and try again."),N}finally{h(!1)}},f=async(C,E,N,y,P)=>{h(!0),g();try{const A=y||C.split("@")[0],v=await be.signUp({email:C,password:E,fullName:A,phone:P||"",role:N||"CONSUMER"});if(v.success)return v.user&&localStorage.setItem("pending-user",JSON.stringify(v.user)),{success:!0,requiresEmailVerification:!0,user:v.user,data:v.data};throw new Error(v.error||"Registration failed")}catch(A){throw console.error("Registration error:",A),l(A.message||"Registration failed. Please try again."),A}finally{h(!1)}},R=async()=>{try{await be.logout()}catch(C){console.error("Logout error:",C)}finally{r(null),localStorage.removeItem("user"),localStorage.removeItem("token"),u(!1)}},k=async()=>{if(!(!p&&!s))try{const C=await be.fetchUser();C.success&&C.user?(r(C.user),u(!0),localStorage.setItem("user",JSON.stringify(C.user))):(r(null),localStorage.removeItem("user"),localStorage.removeItem("token"),u(!1),l(C.error||"Session expired. Please log in again."))}catch(C){console.error("Failed to refresh user:",C),r(null),localStorage.removeItem("user"),localStorage.removeItem("token"),u(!1),l(C.message||"An error occurred while refreshing user data.")}},x=async C=>{if(s){h(!0),l(null);try{const E=await be.updateUser(s.id,C);if(!E.success)throw new Error(E.error||"Failed to update user");const N=E.user;r(N),localStorage.setItem("user",JSON.stringify(N))}catch(E){l(E.message),console.error("Update user error:",E)}finally{h(!1)}}},g=()=>{l(null)},S=()=>!!s;return t.jsx(Wr.Provider,{value:{user:s,setUser:r,login:m,logout:R,signup:f,isLoading:n,loading:o,refreshUser:k,updateUser:x,error:a,clearError:g,isAuthenticated:S,setIsAuthenticated:u},children:e})}function Aa(){const e=c.useContext(Wr);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e}function Kr(e){var s,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(s=0;s<i;s++)e[s]&&(r=Kr(e[s]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function Oa(){for(var e,s,r=0,n="",i=arguments.length;r<i;r++)(e=arguments[r])&&(s=Kr(e))&&(n&&(n+=" "),n+=s);return n}const Cs="-",_a=e=>{const s=Da(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:l=>{const o=l.split(Cs);return o[0]===""&&o.length!==1&&o.shift(),Hr(o,s)||Pa(l)},getConflictingClassGroupIds:(l,o)=>{const h=r[l]||[];return o&&n[l]?[...h,...n[l]]:h}}},Hr=(e,s)=>{if(e.length===0)return s.classGroupId;const r=e[0],n=s.nextPart.get(r),i=n?Hr(e.slice(1),n):void 0;if(i)return i;if(s.validators.length===0)return;const a=e.join(Cs);return s.validators.find(({validator:l})=>l(a))?.classGroupId},rr=/^\[(.+)\]$/,Pa=e=>{if(rr.test(e)){const s=rr.exec(e)[1],r=s?.substring(0,s.indexOf(":"));if(r)return"arbitrary.."+r}},Da=e=>{const{theme:s,prefix:r}=e,n={nextPart:new Map,validators:[]};return Ma(Object.entries(e.classGroups),r).forEach(([a,l])=>{cs(l,n,a,s)}),n},cs=(e,s,r,n)=>{e.forEach(i=>{if(typeof i=="string"){const a=i===""?s:nr(s,i);a.classGroupId=r;return}if(typeof i=="function"){if(Ia(i)){cs(i(n),s,r,n);return}s.validators.push({validator:i,classGroupId:r});return}Object.entries(i).forEach(([a,l])=>{cs(l,nr(s,a),r,n)})})},nr=(e,s)=>{let r=e;return s.split(Cs).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},Ia=e=>e.isThemeGetter,Ma=(e,s)=>s?e.map(([r,n])=>{const i=n.map(a=>typeof a=="string"?s+a:typeof a=="object"?Object.fromEntries(Object.entries(a).map(([l,o])=>[s+l,o])):a);return[r,i]}):e,Fa=e=>{if(e<1)return{get:()=>{},set:()=>{}};let s=0,r=new Map,n=new Map;const i=(a,l)=>{r.set(a,l),s++,s>e&&(s=0,n=r,r=new Map)};return{get(a){let l=r.get(a);if(l!==void 0)return l;if((l=n.get(a))!==void 0)return i(a,l),l},set(a,l){r.has(a)?r.set(a,l):i(a,l)}}},Gr="!",La=e=>{const{separator:s,experimentalParseClassName:r}=e,n=s.length===1,i=s[0],a=s.length,l=o=>{const h=[];let p=0,u=0,m;for(let g=0;g<o.length;g++){let S=o[g];if(p===0){if(S===i&&(n||o.slice(g,g+a)===s)){h.push(o.slice(u,g)),u=g+a;continue}if(S==="/"){m=g;continue}}S==="["?p++:S==="]"&&p--}const f=h.length===0?o:o.substring(u),R=f.startsWith(Gr),k=R?f.substring(1):f,x=m&&m>u?m-u:void 0;return{modifiers:h,hasImportantModifier:R,baseClassName:k,maybePostfixModifierPosition:x}};return r?o=>r({className:o,parseClassName:l}):l},Ua=e=>{if(e.length<=1)return e;const s=[];let r=[];return e.forEach(n=>{n[0]==="["?(s.push(...r.sort(),n),r=[]):r.push(n)}),s.push(...r.sort()),s},Ba=e=>({cache:Fa(e.cacheSize),parseClassName:La(e),..._a(e)}),$a=/\s+/,qa=(e,s)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:i}=s,a=[],l=e.trim().split($a);let o="";for(let h=l.length-1;h>=0;h-=1){const p=l[h],{modifiers:u,hasImportantModifier:m,baseClassName:f,maybePostfixModifierPosition:R}=r(p);let k=!!R,x=n(k?f.substring(0,R):f);if(!x){if(!k){o=p+(o.length>0?" "+o:o);continue}if(x=n(f),!x){o=p+(o.length>0?" "+o:o);continue}k=!1}const g=Ua(u).join(":"),S=m?g+Gr:g,C=S+x;if(a.includes(C))continue;a.push(C);const E=i(x,k);for(let N=0;N<E.length;++N){const y=E[N];a.push(S+y)}o=p+(o.length>0?" "+o:o)}return o};function Va(){let e=0,s,r,n="";for(;e<arguments.length;)(s=arguments[e++])&&(r=Qr(s))&&(n&&(n+=" "),n+=r);return n}const Qr=e=>{if(typeof e=="string")return e;let s,r="";for(let n=0;n<e.length;n++)e[n]&&(s=Qr(e[n]))&&(r&&(r+=" "),r+=s);return r};function za(e,...s){let r,n,i,a=l;function l(h){const p=s.reduce((u,m)=>m(u),e());return r=Ba(p),n=r.cache.get,i=r.cache.set,a=o,o(h)}function o(h){const p=n(h);if(p)return p;const u=qa(h,r);return i(h,u),u}return function(){return a(Va.apply(null,arguments))}}const B=e=>{const s=r=>r[e]||[];return s.isThemeGetter=!0,s},Jr=/^\[(?:([a-z-]+):)?(.+)\]$/i,Wa=/^\d+\/\d+$/,Ka=new Set(["px","full","screen"]),Ha=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Ga=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Qa=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Ja=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Ya=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ce=e=>_e(e)||Ka.has(e)||Wa.test(e),me=e=>Fe(e,"length",io),_e=e=>!!e&&!Number.isNaN(Number(e)),zt=e=>Fe(e,"number",_e),Be=e=>!!e&&Number.isInteger(Number(e)),Xa=e=>e.endsWith("%")&&_e(e.slice(0,-1)),I=e=>Jr.test(e),fe=e=>Ha.test(e),Za=new Set(["length","size","percentage"]),eo=e=>Fe(e,Za,Yr),to=e=>Fe(e,"position",Yr),so=new Set(["image","url"]),ro=e=>Fe(e,so,oo),no=e=>Fe(e,"",ao),$e=()=>!0,Fe=(e,s,r)=>{const n=Jr.exec(e);return n?n[1]?typeof s=="string"?n[1]===s:s.has(n[1]):r(n[2]):!1},io=e=>Ga.test(e)&&!Qa.test(e),Yr=()=>!1,ao=e=>Ja.test(e),oo=e=>Ya.test(e),lo=()=>{const e=B("colors"),s=B("spacing"),r=B("blur"),n=B("brightness"),i=B("borderColor"),a=B("borderRadius"),l=B("borderSpacing"),o=B("borderWidth"),h=B("contrast"),p=B("grayscale"),u=B("hueRotate"),m=B("invert"),f=B("gap"),R=B("gradientColorStops"),k=B("gradientColorStopPositions"),x=B("inset"),g=B("margin"),S=B("opacity"),C=B("padding"),E=B("saturate"),N=B("scale"),y=B("sepia"),P=B("skew"),A=B("space"),v=B("translate"),D=()=>["auto","contain","none"],w=()=>["auto","hidden","clip","visible","scroll"],_=()=>["auto",I,s],b=()=>[I,s],j=()=>["",ce,me],d=()=>["auto",_e,I],T=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],O=()=>["solid","dashed","dotted","double","none"],M=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],H=()=>["start","end","center","between","around","evenly","stretch"],he=()=>["","0",I],Ls=()=>["auto","avoid","all","avoid-page","page","left","right","column"],le=()=>[_e,I];return{cacheSize:500,separator:":",theme:{colors:[$e],spacing:[ce,me],blur:["none","",fe,I],brightness:le(),borderColor:[e],borderRadius:["none","","full",fe,I],borderSpacing:b(),borderWidth:j(),contrast:le(),grayscale:he(),hueRotate:le(),invert:he(),gap:b(),gradientColorStops:[e],gradientColorStopPositions:[Xa,me],inset:_(),margin:_(),opacity:le(),padding:b(),saturate:le(),scale:le(),sepia:he(),skew:le(),space:b(),translate:b()},classGroups:{aspect:[{aspect:["auto","square","video",I]}],container:["container"],columns:[{columns:[fe]}],"break-after":[{"break-after":Ls()}],"break-before":[{"break-before":Ls()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...T(),I]}],overflow:[{overflow:w()}],"overflow-x":[{"overflow-x":w()}],"overflow-y":[{"overflow-y":w()}],overscroll:[{overscroll:D()}],"overscroll-x":[{"overscroll-x":D()}],"overscroll-y":[{"overscroll-y":D()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[x]}],"inset-x":[{"inset-x":[x]}],"inset-y":[{"inset-y":[x]}],start:[{start:[x]}],end:[{end:[x]}],top:[{top:[x]}],right:[{right:[x]}],bottom:[{bottom:[x]}],left:[{left:[x]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Be,I]}],basis:[{basis:_()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",I]}],grow:[{grow:he()}],shrink:[{shrink:he()}],order:[{order:["first","last","none",Be,I]}],"grid-cols":[{"grid-cols":[$e]}],"col-start-end":[{col:["auto",{span:["full",Be,I]},I]}],"col-start":[{"col-start":d()}],"col-end":[{"col-end":d()}],"grid-rows":[{"grid-rows":[$e]}],"row-start-end":[{row:["auto",{span:[Be,I]},I]}],"row-start":[{"row-start":d()}],"row-end":[{"row-end":d()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",I]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",I]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...H()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...H(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...H(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[C]}],px:[{px:[C]}],py:[{py:[C]}],ps:[{ps:[C]}],pe:[{pe:[C]}],pt:[{pt:[C]}],pr:[{pr:[C]}],pb:[{pb:[C]}],pl:[{pl:[C]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[A]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[A]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",I,s]}],"min-w":[{"min-w":[I,s,"min","max","fit"]}],"max-w":[{"max-w":[I,s,"none","full","min","max","fit","prose",{screen:[fe]},fe]}],h:[{h:[I,s,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[I,s,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[I,s,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[I,s,"auto","min","max","fit"]}],"font-size":[{text:["base",fe,me]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",zt]}],"font-family":[{font:[$e]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",I]}],"line-clamp":[{"line-clamp":["none",_e,zt]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",ce,I]}],"list-image":[{"list-image":["none",I]}],"list-style-type":[{list:["none","disc","decimal",I]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[S]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[S]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...O(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",ce,me]}],"underline-offset":[{"underline-offset":["auto",ce,I]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:b()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",I]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",I]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[S]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...T(),to]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",eo]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},ro]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[k]}],"gradient-via-pos":[{via:[k]}],"gradient-to-pos":[{to:[k]}],"gradient-from":[{from:[R]}],"gradient-via":[{via:[R]}],"gradient-to":[{to:[R]}],rounded:[{rounded:[a]}],"rounded-s":[{"rounded-s":[a]}],"rounded-e":[{"rounded-e":[a]}],"rounded-t":[{"rounded-t":[a]}],"rounded-r":[{"rounded-r":[a]}],"rounded-b":[{"rounded-b":[a]}],"rounded-l":[{"rounded-l":[a]}],"rounded-ss":[{"rounded-ss":[a]}],"rounded-se":[{"rounded-se":[a]}],"rounded-ee":[{"rounded-ee":[a]}],"rounded-es":[{"rounded-es":[a]}],"rounded-tl":[{"rounded-tl":[a]}],"rounded-tr":[{"rounded-tr":[a]}],"rounded-br":[{"rounded-br":[a]}],"rounded-bl":[{"rounded-bl":[a]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[S]}],"border-style":[{border:[...O(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[S]}],"divide-style":[{divide:O()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...O()]}],"outline-offset":[{"outline-offset":[ce,I]}],"outline-w":[{outline:[ce,me]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:j()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[S]}],"ring-offset-w":[{"ring-offset":[ce,me]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",fe,no]}],"shadow-color":[{shadow:[$e]}],opacity:[{opacity:[S]}],"mix-blend":[{"mix-blend":[...M(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":M()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[h]}],"drop-shadow":[{"drop-shadow":["","none",fe,I]}],grayscale:[{grayscale:[p]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[m]}],saturate:[{saturate:[E]}],sepia:[{sepia:[y]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[h]}],"backdrop-grayscale":[{"backdrop-grayscale":[p]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[m]}],"backdrop-opacity":[{"backdrop-opacity":[S]}],"backdrop-saturate":[{"backdrop-saturate":[E]}],"backdrop-sepia":[{"backdrop-sepia":[y]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[l]}],"border-spacing-x":[{"border-spacing-x":[l]}],"border-spacing-y":[{"border-spacing-y":[l]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",I]}],duration:[{duration:le()}],ease:[{ease:["linear","in","out","in-out",I]}],delay:[{delay:le()}],animate:[{animate:["none","spin","ping","pulse","bounce",I]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[N]}],"scale-x":[{"scale-x":[N]}],"scale-y":[{"scale-y":[N]}],rotate:[{rotate:[Be,I]}],"translate-x":[{"translate-x":[v]}],"translate-y":[{"translate-y":[v]}],"skew-x":[{"skew-x":[P]}],"skew-y":[{"skew-y":[P]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",I]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",I]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":b()}],"scroll-mx":[{"scroll-mx":b()}],"scroll-my":[{"scroll-my":b()}],"scroll-ms":[{"scroll-ms":b()}],"scroll-me":[{"scroll-me":b()}],"scroll-mt":[{"scroll-mt":b()}],"scroll-mr":[{"scroll-mr":b()}],"scroll-mb":[{"scroll-mb":b()}],"scroll-ml":[{"scroll-ml":b()}],"scroll-p":[{"scroll-p":b()}],"scroll-px":[{"scroll-px":b()}],"scroll-py":[{"scroll-py":b()}],"scroll-ps":[{"scroll-ps":b()}],"scroll-pe":[{"scroll-pe":b()}],"scroll-pt":[{"scroll-pt":b()}],"scroll-pr":[{"scroll-pr":b()}],"scroll-pb":[{"scroll-pb":b()}],"scroll-pl":[{"scroll-pl":b()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",I]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[ce,me,zt]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},co=za(lo);function V(...e){return co(Oa(e))}const L=c.forwardRef(({className:e,variant:s="default",size:r="default",...n},i)=>{const a={default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},l={default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"};return t.jsx("button",{className:V("inline-flex items-center justify-center whitespace-nowrap curved-button text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",a[s],l[r],e),ref:i,...n})});L.displayName="Button";const Xr=c.createContext(void 0);function uo({children:e}){const[s,r]=c.useState(null),[n,i]=c.useState(!0);c.useEffect(()=>{if(!window.location.hostname.startsWith("admin.")){i(!1);return}const p=localStorage.getItem("adminToken"),u=localStorage.getItem("adminUser");if(p&&u)try{const m=JSON.parse(u);r(m)}catch(m){console.error("Failed to parse admin user data:",m),localStorage.removeItem("adminToken"),localStorage.removeItem("adminUser")}i(!1)},[]);const o={user:s,isAuthenticated:!!s,isLoading:n,login:async(h,p)=>{try{const u=await fetch("/api/admin/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:h,password:p})});if(u.ok){const m=await u.json();return localStorage.setItem("adminToken",m.data.token),localStorage.setItem("adminUser",JSON.stringify(m.data.user)),r(m.data.user),!0}else return!1}catch(u){return console.error("Login failed:",u),!1}},logout:()=>{localStorage.removeItem("adminToken"),localStorage.removeItem("adminUser"),r(null),window.location.href="/admin/login"}};return t.jsx(Xr.Provider,{value:o,children:e})}function ho(){const e=c.useContext(Xr);if(e===void 0)throw new Error("useAdmin must be used within an AdminAuthProvider");return e}const Ze=c.forwardRef(({className:e,type:s,...r},n)=>t.jsx("input",{type:s,className:V("flex h-10 w-full curved-input border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...r}));Ze.displayName="Input";const ds=c.forwardRef(({className:e,...s},r)=>t.jsx("label",{ref:r,className:V("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",e),...s}));ds.displayName="Label";const U=c.forwardRef(({className:e,...s},r)=>t.jsx("div",{ref:r,className:V("curved-card border bg-card text-card-foreground shadow-sm",e),...s}));U.displayName="Card";const J=c.forwardRef(({className:e,...s},r)=>t.jsx("div",{ref:r,className:V("flex flex-col space-y-1.5 p-6",e),...s}));J.displayName="CardHeader";const Y=c.forwardRef(({className:e,...s},r)=>t.jsx("h3",{ref:r,className:V("text-2xl font-semibold leading-none tracking-tight",e),...s}));Y.displayName="CardTitle";const Ge=c.forwardRef(({className:e,...s},r)=>t.jsx("p",{ref:r,className:V("text-sm text-muted-foreground",e),...s}));Ge.displayName="CardDescription";const z=c.forwardRef(({className:e,...s},r)=>t.jsx("div",{ref:r,className:V("p-6 pt-0",e),...s}));z.displayName="CardContent";const mo=c.forwardRef(({className:e,...s},r)=>t.jsx("div",{ref:r,className:V("flex items-center p-6 pt-0",e),...s}));mo.displayName="CardFooter";function fo(){const[,e]=vi(),[s,r]=c.useState({email:"",password:""}),[n,i]=c.useState(!1),[a,l]=c.useState(!1),{toast:o}=Ot(),h=u=>{r(m=>({...m,[u.target.name]:u.target.value}))},p=async u=>{u.preventDefault(),l(!0);try{const f=await(await fetch("/api/auth/admin/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).json();f.success?(localStorage.setItem("adminToken",f.data.token),localStorage.setItem("adminUser",JSON.stringify(f.data.user)),o({title:"Login Successful",description:"Welcome to the admin panel"}),e("/dashboard")):o({title:"Login Failed",description:f.message||"Invalid credentials",variant:"destructive"})}catch(m){console.error("Login error:",m),o({title:"Error",description:"Failed to connect to server",variant:"destructive"})}finally{l(!1)}};return t.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:t.jsxs(U,{className:"w-full max-w-md",children:[t.jsxs(J,{className:"text-center",children:[t.jsx("div",{className:"mx-auto bg-blue-100 w-12 h-12 rounded-full flex items-center justify-center mb-4",children:t.jsx(se,{className:"h-6 w-6 text-blue-600"})}),t.jsx(Y,{className:"text-2xl font-bold",children:"Admin Panel"}),t.jsx(Ge,{children:"Sign in to access the BrillPrime admin dashboard"})]}),t.jsxs(z,{children:[t.jsxs("form",{onSubmit:p,className:"space-y-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(ds,{htmlFor:"email",children:"Email"}),t.jsx(Ze,{id:"email",name:"email",type:"email",placeholder:"admin@brillprime.com",value:s.email,onChange:h,required:!0,disabled:a})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(ds,{htmlFor:"password",children:"Password"}),t.jsxs("div",{className:"relative",children:[t.jsx(Ze,{id:"password",name:"password",type:n?"text":"password",placeholder:"Enter your password",value:s.password,onChange:h,required:!0,disabled:a}),t.jsx(L,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>i(!n),disabled:a,children:n?t.jsx(Ni,{className:"h-4 w-4"}):t.jsx(tt,{className:"h-4 w-4"})})]})]}),t.jsx(L,{type:"submit",className:"w-full",disabled:a,children:a?"Signing In...":"Sign In"})]}),t.jsxs("div",{className:"mt-6 text-center text-sm text-gray-600",children:[t.jsx("p",{children:"Authorized access only"}),t.jsx("p",{className:"text-xs mt-1",children:"This system is monitored and logged"})]})]})]})})}function po({children:e,currentPage:s,onPageChange:r}){const n=[{id:"dashboard",label:"Dashboard",icon:wi},{id:"users",label:"User Management",icon:st},{id:"kyc",label:"KYC Verification",icon:Je},{id:"transactions",label:"Transactions",icon:Ye},{id:"escrow",label:"Escrow Management",icon:Si},{id:"monitoring",label:"System Monitoring",icon:Ci},{id:"fraud",label:"Fraud Detection",icon:se},{id:"moderation",label:"Content Moderation",icon:kr},{id:"support",label:"Support Tickets",icon:ue},{id:"analytics",label:"Analytics",icon:Tr},{id:"security",label:"Security Center",icon:Ei}],i=()=>{localStorage.removeItem("adminToken"),window.location.href="/admin"};return t.jsxs("div",{className:"flex h-screen bg-gray-100",children:[t.jsxs("div",{className:"w-64 bg-white shadow-lg",children:[t.jsxs("div",{className:"p-6 border-b",children:[t.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Admin Panel"}),t.jsx("p",{className:"text-sm text-gray-600",children:"Brill Prime Management"})]}),t.jsx("nav",{className:"mt-6",children:n.map(a=>{const l=a.icon;return t.jsxs("button",{onClick:()=>r(a.id),className:`w-full flex items-center px-6 py-3 text-left hover:bg-gray-50 transition-colors ${s===a.id?"bg-blue-50 text-blue-600 border-r-2 border-blue-600":"text-gray-700"}`,"data-testid":`nav-${a.id}`,children:[t.jsx(l,{className:"w-5 h-5 mr-3"}),t.jsx("span",{children:a.label})]},a.id)})}),t.jsx("div",{className:"absolute bottom-0 w-64 p-6 border-t bg-white",children:t.jsxs("button",{onClick:i,className:"w-full flex items-center px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors","data-testid":"button-logout",children:[t.jsx(Ri,{className:"w-5 h-5 mr-3"}),t.jsx("span",{children:"Logout"})]})})]}),t.jsx("div",{className:"flex-1 overflow-hidden",children:t.jsx("div",{className:"h-full overflow-auto",children:e})})]})}function ir(){const[e,s]=c.useState({totalUsers:0,activeUsers:0,totalTransactions:0,totalRevenue:0,pendingKyc:0,fraudAlerts:0,systemUptime:99.9,responseTime:245}),[r,n]=c.useState(!0);c.useEffect(()=>{i()},[]);const i=async()=>{try{n(!0),setTimeout(()=>{s({totalUsers:15847,activeUsers:3421,totalTransactions:89234,totalRevenue:245e4,pendingKyc:127,fraudAlerts:8,systemUptime:99.9,responseTime:245}),n(!1)},1e3)}catch(l){console.error("Failed to fetch dashboard stats:",l),n(!1)}},a=[{title:"Total Users",value:e.totalUsers.toLocaleString(),icon:st,trend:"+12%",trendUp:!0,color:"bg-blue-500"},{title:"Active Users",value:e.activeUsers.toLocaleString(),icon:we,trend:"+8%",trendUp:!0,color:"bg-green-500"},{title:"Total Transactions",value:e.totalTransactions.toLocaleString(),icon:Ye,trend:"+15%",trendUp:!0,color:"bg-purple-500"},{title:"Total Revenue",value:`${(e.totalRevenue/1e6).toFixed(1)}M`,icon:Tt,trend:"+22%",trendUp:!0,color:"bg-yellow-500"},{title:"Pending KYC",value:e.pendingKyc.toString(),icon:Je,trend:"-5%",trendUp:!1,color:"bg-orange-500"},{title:"Fraud Alerts",value:e.fraudAlerts.toString(),icon:se,trend:"-12%",trendUp:!1,color:"bg-red-500"}];return r?t.jsx("div",{className:"p-6",children:t.jsxs("div",{className:"animate-pulse",children:[t.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-6"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((l,o)=>t.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[t.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-4"}),t.jsx("div",{className:"h-8 bg-gray-200 rounded w-3/4"})]},o))})]})}):t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Admin Dashboard"}),t.jsx("p",{className:"text-gray-600",children:"Overview of platform metrics and system health"})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:a.map((l,o)=>{const h=l.icon;return t.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:l.title}),t.jsx("p",{className:"text-2xl font-bold text-gray-900","data-testid":`stat-${l.title.toLowerCase().replace(/\s+/g,"-")}`,children:l.value}),t.jsxs("div",{className:"flex items-center mt-2",children:[l.trendUp?t.jsx(Ar,{className:"w-4 h-4 text-green-500"}):t.jsx(ki,{className:"w-4 h-4 text-red-500"}),t.jsx("span",{className:`text-sm ml-1 ${l.trendUp?"text-green-500":"text-red-500"}`,children:l.trend}),t.jsx("span",{className:"text-sm text-gray-500 ml-1",children:"vs last month"})]})]}),t.jsx("div",{className:`p-3 rounded-full ${l.color}`,children:t.jsx(h,{className:"w-6 h-6 text-white"})})]})},o)})}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"System Health"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-gray-600",children:"System Uptime"}),t.jsxs("span",{className:"font-semibold text-green-600","data-testid":"stat-uptime",children:[e.systemUptime,"%"]})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-gray-600",children:"Average Response Time"}),t.jsxs("span",{className:"font-semibold text-blue-600","data-testid":"stat-response-time",children:[e.responseTime,"ms"]})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-gray-600",children:"Server Status"}),t.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-sm rounded-full",children:"Healthy"})]})]})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("button",{className:"w-full text-left p-3 hover:bg-gray-50 rounded-lg transition-colors","data-testid":"button-review-kyc",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx(Je,{className:"w-5 h-5 text-orange-500 mr-3"}),t.jsxs("span",{children:["Review Pending KYC (",e.pendingKyc,")"]})]})}),t.jsx("button",{className:"w-full text-left p-3 hover:bg-gray-50 rounded-lg transition-colors","data-testid":"button-fraud-alerts",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx(ue,{className:"w-5 h-5 text-red-500 mr-3"}),t.jsxs("span",{children:["View Fraud Alerts (",e.fraudAlerts,")"]})]})}),t.jsx("button",{className:"w-full text-left p-3 hover:bg-gray-50 rounded-lg transition-colors","data-testid":"button-system-reports",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx(Tr,{className:"w-5 h-5 text-blue-500 mr-3"}),t.jsx("span",{children:"Generate System Reports"})]})})]})]})]})]})}const W=c.forwardRef(({className:e,variant:s="default",...r},n)=>{const i={default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"};return t.jsx("div",{ref:n,className:V("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",i[s],e),...r})});W.displayName="Badge";function xo(){const{toast:e}=Ot();rt();const[s,r]=c.useState({role:"all",status:"all",search:"",page:1,limit:20}),[n,i]=c.useState([]),[a,l]=c.useState(null),[o,h]=c.useState(""),[p,u]=c.useState("all"),[m,f]=c.useState("all"),[R,k]=c.useState("all"),[x,g]=c.useState([]),[S,C]=c.useState(!0),[E,N]=c.useState({totalUsers:0,activeUsers:0,verifiedUsers:0,pendingKyc:0}),[y,P]=c.useState({page:1,limit:20,total:0,pages:0}),A=async()=>{try{C(!0);const d=new URLSearchParams({page:y.page.toString(),limit:y.limit.toString(),search:o,role:p,status:m,verificationStatus:R}),T=await fetch(`/api/admin/users?${d}`,{credentials:"include",headers:{"Content-Type":"application/json"}});if(!T.ok)throw new Error("Failed to fetch users");const O=await T.json();g(O.data.users),N(O.data.stats),P(O.data.pagination)}catch(d){console.error("Failed to fetch users:",d),e({title:"Error",description:d.message||"Network error occurred",variant:"destructive"})}finally{C(!1)}};c.useEffect(()=>{A()},[y.page,o,p,m,R]),c.useEffect(()=>{P(d=>({...d,page:1}))},[o,p,m,R]);const v=async d=>{if(n.length===0)return;const T=prompt(`Reason for ${d.toLowerCase()}:`);if(T)try{const O=await fetch("/api/admin/users/bulk-update",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({userIds:n,action:d,reason:T})});if(O.ok)e({title:"Success",description:`${d} applied to ${n.length} users`}),i([]),A();else{const M=await O.json();e({title:"Error",description:M.message||"Failed to perform bulk action",variant:"destructive"})}}catch(O){e({title:"Error",description:O.message||"Network error occurred",variant:"destructive"})}},D=async(d,T)=>{const O=prompt(`Reason for changing status to ${T}:`);if(O)try{const M=await fetch(`/api/admin/users/${d}/status`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:T,reason:O})});if(M.ok)e({title:"Success",description:`User status updated to ${T}`}),A();else{const H=await M.json();e({title:"Error",description:H.message||"Failed to update status",variant:"destructive"})}}catch(M){e({title:"Error",description:M.message||"Network error occurred",variant:"destructive"})}},w=async d=>{const T=prompt("Reason for verification:");if(T)try{const O=await fetch(`/api/admin/users/${d}/verify`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({reason:T})});if(O.ok)e({title:"Success",description:"User verified successfully"}),A();else{const M=await O.json();e({title:"Error",description:M.message||"Failed to verify user",variant:"destructive"})}}catch(O){e({title:"Error",description:O.message||"Network error occurred",variant:"destructive"})}},_=d=>{P(T=>({...T,page:d}))},b=(d,T)=>{i(T?O=>[...O,d]:O=>O.filter(M=>M!==d))},j=d=>{i(d?x.map(T=>T.id):[])};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold",children:"User Management"}),t.jsxs("p",{className:"text-gray-600",children:[E.totalUsers," total users  ",E.activeUsers," active"]})]}),n.length>0&&t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(L,{size:"sm",variant:"outline",onClick:()=>v("activate"),disabled:S,children:[t.jsx(Je,{className:"h-4 w-4 mr-1"}),"Activate (",n.length,")"]}),t.jsxs(L,{size:"sm",variant:"outline",onClick:()=>v("deactivate"),disabled:S,children:[t.jsx(Us,{className:"h-4 w-4 mr-1"}),"Deactivate (",n.length,")"]}),t.jsxs(L,{size:"sm",variant:"outline",onClick:()=>v("verify"),disabled:S,children:[t.jsx(se,{className:"h-4 w-4 mr-1"}),"Verify (",n.length,")"]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[t.jsx("div",{className:"text-sm text-gray-600",children:"Total Users"}),t.jsx("div",{className:"text-2xl font-bold",children:E.totalUsers})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[t.jsx("div",{className:"text-sm text-gray-600",children:"Verified Users"}),t.jsx("div",{className:"text-2xl font-bold text-green-600",children:E.verifiedUsers})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[t.jsx("div",{className:"text-sm text-gray-600",children:"Merchants"}),t.jsx("div",{className:"text-2xl font-bold text-blue-600",children:E.merchants})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[t.jsx("div",{className:"text-sm text-gray-600",children:"Drivers"}),t.jsx("div",{className:"text-2xl font-bold text-purple-600",children:E.drivers})]})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx(At,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),t.jsx(Ze,{placeholder:"Search users by name or email...",value:o,onChange:d=>h(d.target.value),className:"pl-10"})]}),t.jsxs("select",{value:p,onChange:d=>u(d.target.value),className:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"all",children:"All Roles"}),t.jsx("option",{value:"CONSUMER",children:"Consumers"}),t.jsx("option",{value:"MERCHANT",children:"Merchants"}),t.jsx("option",{value:"DRIVER",children:"Drivers"}),t.jsx("option",{value:"ADMIN",children:"Admins"})]}),t.jsxs("select",{value:m,onChange:d=>f(d.target.value),className:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"all",children:"All Status"}),t.jsx("option",{value:"active",children:"Active"}),t.jsx("option",{value:"inactive",children:"Inactive"})]}),t.jsxs("select",{value:R,onChange:d=>k(d.target.value),className:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"all",children:"All Verification"}),t.jsx("option",{value:"verified",children:"Verified"}),t.jsx("option",{value:"unverified",children:"Unverified"})]})]}),t.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left",children:t.jsx("input",{type:"checkbox",checked:n.length===x.length&&x.length>0,onChange:d=>j(d.target.checked)})}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Joined"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:S?t.jsx("tr",{children:t.jsx("td",{colSpan:"8",className:"text-center py-8",children:t.jsxs("div",{className:"flex justify-center items-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),t.jsx("span",{className:"ml-2",children:"Loading users..."})]})})}):x.length===0?t.jsx("tr",{children:t.jsx("td",{colSpan:"8",className:"text-center py-8 text-gray-500",children:"No users found"})}):x.map(d=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("input",{type:"checkbox",checked:n.includes(d.id),onChange:T=>b(d.id,T.target.checked)})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-medium text-gray-900",children:d.fullName}),t.jsx("div",{className:"text-sm text-gray-500",children:d.email}),d.phoneNumber&&t.jsx("div",{className:"text-xs text-gray-400",children:d.phoneNumber})]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx(W,{variant:d.role==="ADMIN"?"destructive":d.role==="MERCHANT"?"default":d.role==="DRIVER"?"secondary":"outline",children:d.role})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("div",{className:"flex flex-col gap-1",children:[t.jsx(W,{variant:d.isActive?"default":"secondary",className:d.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800",children:d.isActive?"Active":"Inactive"}),d.isVerified&&t.jsx(W,{variant:"outline",className:"bg-blue-100 text-blue-800",children:"Verified"})]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(d.createdAt).toLocaleDateString()}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[t.jsx(L,{size:"sm",variant:"outline",onClick:()=>l(d),children:t.jsx(tt,{className:"h-4 w-4"})}),t.jsx(L,{size:"sm",variant:"outline",onClick:()=>D(d.id,d.isActive?"inactive":"active"),disabled:S,children:d.isActive?t.jsx(Us,{className:"h-4 w-4"}):t.jsx(Je,{className:"h-4 w-4"})}),!d.isVerified&&t.jsx(L,{size:"sm",variant:"outline",onClick:()=>w(d.id),disabled:S,children:t.jsx(se,{className:"h-4 w-4"})})]})]},d.id))})]})}),t.jsxs("div",{className:"flex justify-between items-center mt-6 px-6 py-4 bg-gray-50 border-t",children:[t.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",(y.page-1)*y.limit+1," to ",Math.min(y.page*y.limit,y.total)," of ",y.total," users"]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("button",{onClick:()=>_(Math.max(1,y.page-1)),disabled:y.page===1||S,className:"px-3 py-1 border rounded disabled:opacity-50",children:"Previous"}),t.jsxs("span",{className:"px-3 py-1",children:["Page ",y.page," of ",y.pages]}),t.jsx("button",{onClick:()=>_(Math.min(y.pages,y.page+1)),disabled:y.page===y.pages||S,className:"px-3 py-1 border rounded disabled:opacity-50",children:"Next"})]})]}),a&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"User Details"}),t.jsx(L,{variant:"ghost",size:"sm",onClick:()=>l(null),children:""})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Name"}),t.jsx("div",{className:"text-sm",children:a.fullName})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Email"}),t.jsx("div",{className:"text-sm",children:a.email})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Phone"}),t.jsx("div",{className:"text-sm",children:a.phoneNumber||"Not provided"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Role"}),t.jsx("div",{className:"text-sm",children:a.role})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Status"}),t.jsxs("div",{className:"text-sm",children:[a.isActive?"Active":"Inactive"," ",a.isVerified?" Verified":" Unverified"]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Member Since"}),t.jsx("div",{className:"text-sm",children:new Date(a.createdAt).toLocaleDateString()})]})]})]})})]})}function K(e,s,{checkForDefaultPrevented:r=!0}={}){return function(i){if(e?.(i),r===!1||!i.defaultPrevented)return s?.(i)}}function ar(e,s){if(typeof e=="function")return e(s);e!=null&&(e.current=s)}function Zr(...e){return s=>{let r=!1;const n=e.map(i=>{const a=ar(i,s);return!r&&typeof a=="function"&&(r=!0),a});if(r)return()=>{for(let i=0;i<n.length;i++){const a=n[i];typeof a=="function"?a():ar(e[i],null)}}}}function ae(...e){return c.useCallback(Zr(...e),e)}function go(e,s){const r=c.createContext(s),n=a=>{const{children:l,...o}=a,h=c.useMemo(()=>o,Object.values(o));return t.jsx(r.Provider,{value:h,children:l})};n.displayName=e+"Provider";function i(a){const l=c.useContext(r);if(l)return l;if(s!==void 0)return s;throw new Error(`\`${a}\` must be used within \`${e}\``)}return[n,i]}function _t(e,s=[]){let r=[];function n(a,l){const o=c.createContext(l),h=r.length;r=[...r,l];const p=m=>{const{scope:f,children:R,...k}=m,x=f?.[e]?.[h]||o,g=c.useMemo(()=>k,Object.values(k));return t.jsx(x.Provider,{value:g,children:R})};p.displayName=a+"Provider";function u(m,f){const R=f?.[e]?.[h]||o,k=c.useContext(R);if(k)return k;if(l!==void 0)return l;throw new Error(`\`${m}\` must be used within \`${a}\``)}return[p,u]}const i=()=>{const a=r.map(l=>c.createContext(l));return function(o){const h=o?.[e]||a;return c.useMemo(()=>({[`__scope${e}`]:{...o,[e]:h}}),[o,h])}};return i.scopeName=e,[n,yo(i,...s)]}function yo(...e){const s=e[0];if(e.length===1)return s;const r=()=>{const n=e.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(a){const l=n.reduce((o,{useScope:h,scopeName:p})=>{const m=h(a)[`__scope${p}`];return{...o,...m}},{});return c.useMemo(()=>({[`__scope${s.scopeName}`]:l}),[l])}};return r.scopeName=s.scopeName,r}var et=globalThis?.document?c.useLayoutEffect:()=>{},vo=Cr[" useId ".trim().toString()]||(()=>{}),bo=0;function Qe(e){const[s,r]=c.useState(vo());return et(()=>{r(n=>n??String(bo++))},[e]),s?`radix-${s}`:""}var jo=Cr[" useInsertionEffect ".trim().toString()]||et;function Es({prop:e,defaultProp:s,onChange:r=()=>{},caller:n}){const[i,a,l]=No({defaultProp:s,onChange:r}),o=e!==void 0,h=o?e:i;{const u=c.useRef(e!==void 0);c.useEffect(()=>{const m=u.current;m!==o&&console.warn(`${n} is changing from ${m?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=o},[o,n])}const p=c.useCallback(u=>{if(o){const m=wo(u)?u(e):u;m!==e&&l.current?.(m)}else a(u)},[o,e,a,l]);return[h,p]}function No({defaultProp:e,onChange:s}){const[r,n]=c.useState(e),i=c.useRef(r),a=c.useRef(s);return jo(()=>{a.current=s},[s]),c.useEffect(()=>{i.current!==r&&(a.current?.(r),i.current=r)},[r,i]),[r,n,a]}function wo(e){return typeof e=="function"}var en=Er();const So=Rr(en);function Rt(e){const s=Co(e),r=c.forwardRef((n,i)=>{const{children:a,...l}=n,o=c.Children.toArray(a),h=o.find(Ro);if(h){const p=h.props.children,u=o.map(m=>m===h?c.Children.count(p)>1?c.Children.only(null):c.isValidElement(p)?p.props.children:null:m);return t.jsx(s,{...l,ref:i,children:c.isValidElement(p)?c.cloneElement(p,void 0,u):null})}return t.jsx(s,{...l,ref:i,children:a})});return r.displayName=`${e}.Slot`,r}function Co(e){const s=c.forwardRef((r,n)=>{const{children:i,...a}=r;if(c.isValidElement(i)){const l=To(i),o=ko(a,i.props);return i.type!==c.Fragment&&(o.ref=n?Zr(n,l):l),c.cloneElement(i,o)}return c.Children.count(i)>1?c.Children.only(null):null});return s.displayName=`${e}.SlotClone`,s}var Eo=Symbol("radix.slottable");function Ro(e){return c.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===Eo}function ko(e,s){const r={...s};for(const n in s){const i=e[n],a=s[n];/^on[A-Z]/.test(n)?i&&a?r[n]=(...o)=>{const h=a(...o);return i(...o),h}:i&&(r[n]=i):n==="style"?r[n]={...i,...a}:n==="className"&&(r[n]=[i,a].filter(Boolean).join(" "))}return{...e,...r}}function To(e){let s=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=s&&"isReactWarning"in s&&s.isReactWarning;return r?e.ref:(s=Object.getOwnPropertyDescriptor(e,"ref")?.get,r=s&&"isReactWarning"in s&&s.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var Ao=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Q=Ao.reduce((e,s)=>{const r=Rt(`Primitive.${s}`),n=c.forwardRef((i,a)=>{const{asChild:l,...o}=i,h=l?r:s;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),t.jsx(h,{...o,ref:a})});return n.displayName=`Primitive.${s}`,{...e,[s]:n}},{});function Oo(e,s){e&&en.flushSync(()=>e.dispatchEvent(s))}function Ie(e){const s=c.useRef(e);return c.useEffect(()=>{s.current=e}),c.useMemo(()=>(...r)=>s.current?.(...r),[])}function _o(e,s=globalThis?.document){const r=Ie(e);c.useEffect(()=>{const n=i=>{i.key==="Escape"&&r(i)};return s.addEventListener("keydown",n,{capture:!0}),()=>s.removeEventListener("keydown",n,{capture:!0})},[r,s])}var Po="DismissableLayer",us="dismissableLayer.update",Do="dismissableLayer.pointerDownOutside",Io="dismissableLayer.focusOutside",or,tn=c.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),sn=c.forwardRef((e,s)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:i,onFocusOutside:a,onInteractOutside:l,onDismiss:o,...h}=e,p=c.useContext(tn),[u,m]=c.useState(null),f=u?.ownerDocument??globalThis?.document,[,R]=c.useState({}),k=ae(s,A=>m(A)),x=Array.from(p.layers),[g]=[...p.layersWithOutsidePointerEventsDisabled].slice(-1),S=x.indexOf(g),C=u?x.indexOf(u):-1,E=p.layersWithOutsidePointerEventsDisabled.size>0,N=C>=S,y=Lo(A=>{const v=A.target,D=[...p.branches].some(w=>w.contains(v));!N||D||(i?.(A),l?.(A),A.defaultPrevented||o?.())},f),P=Uo(A=>{const v=A.target;[...p.branches].some(w=>w.contains(v))||(a?.(A),l?.(A),A.defaultPrevented||o?.())},f);return _o(A=>{C===p.layers.size-1&&(n?.(A),!A.defaultPrevented&&o&&(A.preventDefault(),o()))},f),c.useEffect(()=>{if(u)return r&&(p.layersWithOutsidePointerEventsDisabled.size===0&&(or=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),p.layersWithOutsidePointerEventsDisabled.add(u)),p.layers.add(u),lr(),()=>{r&&p.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=or)}},[u,f,r,p]),c.useEffect(()=>()=>{u&&(p.layers.delete(u),p.layersWithOutsidePointerEventsDisabled.delete(u),lr())},[u,p]),c.useEffect(()=>{const A=()=>R({});return document.addEventListener(us,A),()=>document.removeEventListener(us,A)},[]),t.jsx(Q.div,{...h,ref:k,style:{pointerEvents:E?N?"auto":"none":void 0,...e.style},onFocusCapture:K(e.onFocusCapture,P.onFocusCapture),onBlurCapture:K(e.onBlurCapture,P.onBlurCapture),onPointerDownCapture:K(e.onPointerDownCapture,y.onPointerDownCapture)})});sn.displayName=Po;var Mo="DismissableLayerBranch",Fo=c.forwardRef((e,s)=>{const r=c.useContext(tn),n=c.useRef(null),i=ae(s,n);return c.useEffect(()=>{const a=n.current;if(a)return r.branches.add(a),()=>{r.branches.delete(a)}},[r.branches]),t.jsx(Q.div,{...e,ref:i})});Fo.displayName=Mo;function Lo(e,s=globalThis?.document){const r=Ie(e),n=c.useRef(!1),i=c.useRef(()=>{});return c.useEffect(()=>{const a=o=>{if(o.target&&!n.current){let h=function(){rn(Do,r,p,{discrete:!0})};const p={originalEvent:o};o.pointerType==="touch"?(s.removeEventListener("click",i.current),i.current=h,s.addEventListener("click",i.current,{once:!0})):h()}else s.removeEventListener("click",i.current);n.current=!1},l=window.setTimeout(()=>{s.addEventListener("pointerdown",a)},0);return()=>{window.clearTimeout(l),s.removeEventListener("pointerdown",a),s.removeEventListener("click",i.current)}},[s,r]),{onPointerDownCapture:()=>n.current=!0}}function Uo(e,s=globalThis?.document){const r=Ie(e),n=c.useRef(!1);return c.useEffect(()=>{const i=a=>{a.target&&!n.current&&rn(Io,r,{originalEvent:a},{discrete:!1})};return s.addEventListener("focusin",i),()=>s.removeEventListener("focusin",i)},[s,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function lr(){const e=new CustomEvent(us);document.dispatchEvent(e)}function rn(e,s,r,{discrete:n}){const i=r.originalEvent.target,a=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});s&&i.addEventListener(e,s,{once:!0}),n?Oo(i,a):i.dispatchEvent(a)}var Wt="focusScope.autoFocusOnMount",Kt="focusScope.autoFocusOnUnmount",cr={bubbles:!1,cancelable:!0},Bo="FocusScope",nn=c.forwardRef((e,s)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:i,onUnmountAutoFocus:a,...l}=e,[o,h]=c.useState(null),p=Ie(i),u=Ie(a),m=c.useRef(null),f=ae(s,x=>h(x)),R=c.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;c.useEffect(()=>{if(n){let x=function(E){if(R.paused||!o)return;const N=E.target;o.contains(N)?m.current=N:pe(m.current,{select:!0})},g=function(E){if(R.paused||!o)return;const N=E.relatedTarget;N!==null&&(o.contains(N)||pe(m.current,{select:!0}))},S=function(E){if(document.activeElement===document.body)for(const y of E)y.removedNodes.length>0&&pe(o)};document.addEventListener("focusin",x),document.addEventListener("focusout",g);const C=new MutationObserver(S);return o&&C.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",x),document.removeEventListener("focusout",g),C.disconnect()}}},[n,o,R.paused]),c.useEffect(()=>{if(o){ur.add(R);const x=document.activeElement;if(!o.contains(x)){const S=new CustomEvent(Wt,cr);o.addEventListener(Wt,p),o.dispatchEvent(S),S.defaultPrevented||($o(Ko(an(o)),{select:!0}),document.activeElement===x&&pe(o))}return()=>{o.removeEventListener(Wt,p),setTimeout(()=>{const S=new CustomEvent(Kt,cr);o.addEventListener(Kt,u),o.dispatchEvent(S),S.defaultPrevented||pe(x??document.body,{select:!0}),o.removeEventListener(Kt,u),ur.remove(R)},0)}}},[o,p,u,R]);const k=c.useCallback(x=>{if(!r&&!n||R.paused)return;const g=x.key==="Tab"&&!x.altKey&&!x.ctrlKey&&!x.metaKey,S=document.activeElement;if(g&&S){const C=x.currentTarget,[E,N]=qo(C);E&&N?!x.shiftKey&&S===N?(x.preventDefault(),r&&pe(E,{select:!0})):x.shiftKey&&S===E&&(x.preventDefault(),r&&pe(N,{select:!0})):S===C&&x.preventDefault()}},[r,n,R.paused]);return t.jsx(Q.div,{tabIndex:-1,...l,ref:f,onKeyDown:k})});nn.displayName=Bo;function $o(e,{select:s=!1}={}){const r=document.activeElement;for(const n of e)if(pe(n,{select:s}),document.activeElement!==r)return}function qo(e){const s=an(e),r=dr(s,e),n=dr(s.reverse(),e);return[r,n]}function an(e){const s=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const i=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||i?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)s.push(r.currentNode);return s}function dr(e,s){for(const r of e)if(!Vo(r,{upTo:s}))return r}function Vo(e,{upTo:s}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(s!==void 0&&e===s)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function zo(e){return e instanceof HTMLInputElement&&"select"in e}function pe(e,{select:s=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&zo(e)&&s&&e.select()}}var ur=Wo();function Wo(){let e=[];return{add(s){const r=e[0];s!==r&&r?.pause(),e=hr(e,s),e.unshift(s)},remove(s){e=hr(e,s),e[0]?.resume()}}}function hr(e,s){const r=[...e],n=r.indexOf(s);return n!==-1&&r.splice(n,1),r}function Ko(e){return e.filter(s=>s.tagName!=="A")}var Ho="Portal",on=c.forwardRef((e,s)=>{const{container:r,...n}=e,[i,a]=c.useState(!1);et(()=>a(!0),[]);const l=r||i&&globalThis?.document?.body;return l?So.createPortal(t.jsx(Q.div,{...n,ref:s}),l):null});on.displayName=Ho;function Go(e,s){return c.useReducer((r,n)=>s[r][n]??r,e)}var nt=e=>{const{present:s,children:r}=e,n=Qo(s),i=typeof r=="function"?r({present:n.isPresent}):c.Children.only(r),a=ae(n.ref,Jo(i));return typeof r=="function"||n.isPresent?c.cloneElement(i,{ref:a}):null};nt.displayName="Presence";function Qo(e){const[s,r]=c.useState(),n=c.useRef(null),i=c.useRef(e),a=c.useRef("none"),l=e?"mounted":"unmounted",[o,h]=Go(l,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return c.useEffect(()=>{const p=ct(n.current);a.current=o==="mounted"?p:"none"},[o]),et(()=>{const p=n.current,u=i.current;if(u!==e){const f=a.current,R=ct(p);e?h("MOUNT"):R==="none"||p?.display==="none"?h("UNMOUNT"):h(u&&f!==R?"ANIMATION_OUT":"UNMOUNT"),i.current=e}},[e,h]),et(()=>{if(s){let p;const u=s.ownerDocument.defaultView??window,m=R=>{const x=ct(n.current).includes(CSS.escape(R.animationName));if(R.target===s&&x&&(h("ANIMATION_END"),!i.current)){const g=s.style.animationFillMode;s.style.animationFillMode="forwards",p=u.setTimeout(()=>{s.style.animationFillMode==="forwards"&&(s.style.animationFillMode=g)})}},f=R=>{R.target===s&&(a.current=ct(n.current))};return s.addEventListener("animationstart",f),s.addEventListener("animationcancel",m),s.addEventListener("animationend",m),()=>{u.clearTimeout(p),s.removeEventListener("animationstart",f),s.removeEventListener("animationcancel",m),s.removeEventListener("animationend",m)}}else h("ANIMATION_END")},[s,h]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:c.useCallback(p=>{n.current=p?getComputedStyle(p):null,r(p)},[])}}function ct(e){return e?.animationName||"none"}function Jo(e){let s=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=s&&"isReactWarning"in s&&s.isReactWarning;return r?e.ref:(s=Object.getOwnPropertyDescriptor(e,"ref")?.get,r=s&&"isReactWarning"in s&&s.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var Ht=0;function Yo(){c.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??mr()),document.body.insertAdjacentElement("beforeend",e[1]??mr()),Ht++,()=>{Ht===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(s=>s.remove()),Ht--}},[])}function mr(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var ne=function(){return ne=Object.assign||function(s){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(s[a]=r[a])}return s},ne.apply(this,arguments)};function ln(e,s){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&s.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)s.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function Xo(e,s,r){if(r||arguments.length===2)for(var n=0,i=s.length,a;n<i;n++)(a||!(n in s))&&(a||(a=Array.prototype.slice.call(s,0,n)),a[n]=s[n]);return e.concat(a||Array.prototype.slice.call(s))}var vt="right-scroll-bar-position",bt="width-before-scroll-bar",Zo="with-scroll-bars-hidden",el="--removed-body-scroll-bar-size";function Gt(e,s){return typeof e=="function"?e(s):e&&(e.current=s),e}function tl(e,s){var r=c.useState(function(){return{value:e,callback:s,facade:{get current(){return r.value},set current(n){var i=r.value;i!==n&&(r.value=n,r.callback(n,i))}}}})[0];return r.callback=s,r.facade}var sl=typeof window<"u"?c.useLayoutEffect:c.useEffect,fr=new WeakMap;function rl(e,s){var r=tl(null,function(n){return e.forEach(function(i){return Gt(i,n)})});return sl(function(){var n=fr.get(r);if(n){var i=new Set(n),a=new Set(e),l=r.current;i.forEach(function(o){a.has(o)||Gt(o,null)}),a.forEach(function(o){i.has(o)||Gt(o,l)})}fr.set(r,e)},[e]),r}function nl(e){return e}function il(e,s){s===void 0&&(s=nl);var r=[],n=!1,i={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(a){var l=s(a,n);return r.push(l),function(){r=r.filter(function(o){return o!==l})}},assignSyncMedium:function(a){for(n=!0;r.length;){var l=r;r=[],l.forEach(a)}r={push:function(o){return a(o)},filter:function(){return r}}},assignMedium:function(a){n=!0;var l=[];if(r.length){var o=r;r=[],o.forEach(a),l=r}var h=function(){var u=l;l=[],u.forEach(a)},p=function(){return Promise.resolve().then(h)};p(),r={push:function(u){l.push(u),p()},filter:function(u){return l=l.filter(u),r}}}};return i}function al(e){e===void 0&&(e={});var s=il(null);return s.options=ne({async:!0,ssr:!1},e),s}var cn=function(e){var s=e.sideCar,r=ln(e,["sideCar"]);if(!s)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=s.read();if(!n)throw new Error("Sidecar medium not found");return c.createElement(n,ne({},r))};cn.isSideCarExport=!0;function ol(e,s){return e.useMedium(s),cn}var dn=al(),Qt=function(){},Pt=c.forwardRef(function(e,s){var r=c.useRef(null),n=c.useState({onScrollCapture:Qt,onWheelCapture:Qt,onTouchMoveCapture:Qt}),i=n[0],a=n[1],l=e.forwardProps,o=e.children,h=e.className,p=e.removeScrollBar,u=e.enabled,m=e.shards,f=e.sideCar,R=e.noRelative,k=e.noIsolation,x=e.inert,g=e.allowPinchZoom,S=e.as,C=S===void 0?"div":S,E=e.gapMode,N=ln(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),y=f,P=rl([r,s]),A=ne(ne({},N),i);return c.createElement(c.Fragment,null,u&&c.createElement(y,{sideCar:dn,removeScrollBar:p,shards:m,noRelative:R,noIsolation:k,inert:x,setCallbacks:a,allowPinchZoom:!!g,lockRef:r,gapMode:E}),l?c.cloneElement(c.Children.only(o),ne(ne({},A),{ref:P})):c.createElement(C,ne({},A,{className:h,ref:P}),o))});Pt.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Pt.classNames={fullWidth:bt,zeroRight:vt};var ll=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function cl(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var s=ll();return s&&e.setAttribute("nonce",s),e}function dl(e,s){e.styleSheet?e.styleSheet.cssText=s:e.appendChild(document.createTextNode(s))}function ul(e){var s=document.head||document.getElementsByTagName("head")[0];s.appendChild(e)}var hl=function(){var e=0,s=null;return{add:function(r){e==0&&(s=cl())&&(dl(s,r),ul(s)),e++},remove:function(){e--,!e&&s&&(s.parentNode&&s.parentNode.removeChild(s),s=null)}}},ml=function(){var e=hl();return function(s,r){c.useEffect(function(){return e.add(s),function(){e.remove()}},[s&&r])}},un=function(){var e=ml(),s=function(r){var n=r.styles,i=r.dynamic;return e(n,i),null};return s},fl={left:0,top:0,right:0,gap:0},Jt=function(e){return parseInt(e||"",10)||0},pl=function(e){var s=window.getComputedStyle(document.body),r=s[e==="padding"?"paddingLeft":"marginLeft"],n=s[e==="padding"?"paddingTop":"marginTop"],i=s[e==="padding"?"paddingRight":"marginRight"];return[Jt(r),Jt(n),Jt(i)]},xl=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return fl;var s=pl(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:s[0],top:s[1],right:s[2],gap:Math.max(0,n-r+s[2]-s[0])}},gl=un(),Pe="data-scroll-locked",yl=function(e,s,r,n){var i=e.left,a=e.top,l=e.right,o=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(Zo,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(o,"px ").concat(n,`;
  }
  body[`).concat(Pe,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([s&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(a,`px;
    padding-right: `).concat(l,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(o,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(vt,` {
    right: `).concat(o,"px ").concat(n,`;
  }
  
  .`).concat(bt,` {
    margin-right: `).concat(o,"px ").concat(n,`;
  }
  
  .`).concat(vt," .").concat(vt,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(bt," .").concat(bt,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(Pe,`] {
    `).concat(el,": ").concat(o,`px;
  }
`)},pr=function(){var e=parseInt(document.body.getAttribute(Pe)||"0",10);return isFinite(e)?e:0},vl=function(){c.useEffect(function(){return document.body.setAttribute(Pe,(pr()+1).toString()),function(){var e=pr()-1;e<=0?document.body.removeAttribute(Pe):document.body.setAttribute(Pe,e.toString())}},[])},bl=function(e){var s=e.noRelative,r=e.noImportant,n=e.gapMode,i=n===void 0?"margin":n;vl();var a=c.useMemo(function(){return xl(i)},[i]);return c.createElement(gl,{styles:yl(a,!s,i,r?"":"!important")})},hs=!1;if(typeof window<"u")try{var dt=Object.defineProperty({},"passive",{get:function(){return hs=!0,!0}});window.addEventListener("test",dt,dt),window.removeEventListener("test",dt,dt)}catch{hs=!1}var ke=hs?{passive:!1}:!1,jl=function(e){return e.tagName==="TEXTAREA"},hn=function(e,s){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[s]!=="hidden"&&!(r.overflowY===r.overflowX&&!jl(e)&&r[s]==="visible")},Nl=function(e){return hn(e,"overflowY")},wl=function(e){return hn(e,"overflowX")},xr=function(e,s){var r=s.ownerDocument,n=s;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var i=mn(e,n);if(i){var a=fn(e,n),l=a[1],o=a[2];if(l>o)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},Sl=function(e){var s=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[s,r,n]},Cl=function(e){var s=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[s,r,n]},mn=function(e,s){return e==="v"?Nl(s):wl(s)},fn=function(e,s){return e==="v"?Sl(s):Cl(s)},El=function(e,s){return e==="h"&&s==="rtl"?-1:1},Rl=function(e,s,r,n,i){var a=El(e,window.getComputedStyle(s).direction),l=a*n,o=r.target,h=s.contains(o),p=!1,u=l>0,m=0,f=0;do{if(!o)break;var R=fn(e,o),k=R[0],x=R[1],g=R[2],S=x-g-a*k;(k||S)&&mn(e,o)&&(m+=S,f+=k);var C=o.parentNode;o=C&&C.nodeType===Node.DOCUMENT_FRAGMENT_NODE?C.host:C}while(!h&&o!==document.body||h&&(s.contains(o)||s===o));return(u&&Math.abs(m)<1||!u&&Math.abs(f)<1)&&(p=!0),p},ut=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},gr=function(e){return[e.deltaX,e.deltaY]},yr=function(e){return e&&"current"in e?e.current:e},kl=function(e,s){return e[0]===s[0]&&e[1]===s[1]},Tl=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},Al=0,Te=[];function Ol(e){var s=c.useRef([]),r=c.useRef([0,0]),n=c.useRef(),i=c.useState(Al++)[0],a=c.useState(un)[0],l=c.useRef(e);c.useEffect(function(){l.current=e},[e]),c.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(i));var x=Xo([e.lockRef.current],(e.shards||[]).map(yr),!0).filter(Boolean);return x.forEach(function(g){return g.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),x.forEach(function(g){return g.classList.remove("allow-interactivity-".concat(i))})}}},[e.inert,e.lockRef.current,e.shards]);var o=c.useCallback(function(x,g){if("touches"in x&&x.touches.length===2||x.type==="wheel"&&x.ctrlKey)return!l.current.allowPinchZoom;var S=ut(x),C=r.current,E="deltaX"in x?x.deltaX:C[0]-S[0],N="deltaY"in x?x.deltaY:C[1]-S[1],y,P=x.target,A=Math.abs(E)>Math.abs(N)?"h":"v";if("touches"in x&&A==="h"&&P.type==="range")return!1;var v=xr(A,P);if(!v)return!0;if(v?y=A:(y=A==="v"?"h":"v",v=xr(A,P)),!v)return!1;if(!n.current&&"changedTouches"in x&&(E||N)&&(n.current=y),!y)return!0;var D=n.current||y;return Rl(D,g,x,D==="h"?E:N)},[]),h=c.useCallback(function(x){var g=x;if(!(!Te.length||Te[Te.length-1]!==a)){var S="deltaY"in g?gr(g):ut(g),C=s.current.filter(function(y){return y.name===g.type&&(y.target===g.target||g.target===y.shadowParent)&&kl(y.delta,S)})[0];if(C&&C.should){g.cancelable&&g.preventDefault();return}if(!C){var E=(l.current.shards||[]).map(yr).filter(Boolean).filter(function(y){return y.contains(g.target)}),N=E.length>0?o(g,E[0]):!l.current.noIsolation;N&&g.cancelable&&g.preventDefault()}}},[]),p=c.useCallback(function(x,g,S,C){var E={name:x,delta:g,target:S,should:C,shadowParent:_l(S)};s.current.push(E),setTimeout(function(){s.current=s.current.filter(function(N){return N!==E})},1)},[]),u=c.useCallback(function(x){r.current=ut(x),n.current=void 0},[]),m=c.useCallback(function(x){p(x.type,gr(x),x.target,o(x,e.lockRef.current))},[]),f=c.useCallback(function(x){p(x.type,ut(x),x.target,o(x,e.lockRef.current))},[]);c.useEffect(function(){return Te.push(a),e.setCallbacks({onScrollCapture:m,onWheelCapture:m,onTouchMoveCapture:f}),document.addEventListener("wheel",h,ke),document.addEventListener("touchmove",h,ke),document.addEventListener("touchstart",u,ke),function(){Te=Te.filter(function(x){return x!==a}),document.removeEventListener("wheel",h,ke),document.removeEventListener("touchmove",h,ke),document.removeEventListener("touchstart",u,ke)}},[]);var R=e.removeScrollBar,k=e.inert;return c.createElement(c.Fragment,null,k?c.createElement(a,{styles:Tl(i)}):null,R?c.createElement(bl,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function _l(e){for(var s=null;e!==null;)e instanceof ShadowRoot&&(s=e.host,e=e.host),e=e.parentNode;return s}const Pl=ol(dn,Ol);var pn=c.forwardRef(function(e,s){return c.createElement(Pt,ne({},e,{ref:s,sideCar:Pl}))});pn.classNames=Pt.classNames;var Dl=function(e){if(typeof document>"u")return null;var s=Array.isArray(e)?e[0]:e;return s.ownerDocument.body},Ae=new WeakMap,ht=new WeakMap,mt={},Yt=0,xn=function(e){return e&&(e.host||xn(e.parentNode))},Il=function(e,s){return s.map(function(r){if(e.contains(r))return r;var n=xn(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},Ml=function(e,s,r,n){var i=Il(s,Array.isArray(e)?e:[e]);mt[r]||(mt[r]=new WeakMap);var a=mt[r],l=[],o=new Set,h=new Set(i),p=function(m){!m||o.has(m)||(o.add(m),p(m.parentNode))};i.forEach(p);var u=function(m){!m||h.has(m)||Array.prototype.forEach.call(m.children,function(f){if(o.has(f))u(f);else try{var R=f.getAttribute(n),k=R!==null&&R!=="false",x=(Ae.get(f)||0)+1,g=(a.get(f)||0)+1;Ae.set(f,x),a.set(f,g),l.push(f),x===1&&k&&ht.set(f,!0),g===1&&f.setAttribute(r,"true"),k||f.setAttribute(n,"true")}catch(S){console.error("aria-hidden: cannot operate on ",f,S)}})};return u(s),o.clear(),Yt++,function(){l.forEach(function(m){var f=Ae.get(m)-1,R=a.get(m)-1;Ae.set(m,f),a.set(m,R),f||(ht.has(m)||m.removeAttribute(n),ht.delete(m)),R||m.removeAttribute(r)}),Yt--,Yt||(Ae=new WeakMap,Ae=new WeakMap,ht=new WeakMap,mt={})}},Fl=function(e,s,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),i=Dl(e);return i?(n.push.apply(n,Array.from(i.querySelectorAll("[aria-live], script"))),Ml(n,i,r,"aria-hidden")):function(){return null}},Dt="Dialog",[gn,Ad]=_t(Dt),[Ll,re]=gn(Dt),yn=e=>{const{__scopeDialog:s,children:r,open:n,defaultOpen:i,onOpenChange:a,modal:l=!0}=e,o=c.useRef(null),h=c.useRef(null),[p,u]=Es({prop:n,defaultProp:i??!1,onChange:a,caller:Dt});return t.jsx(Ll,{scope:s,triggerRef:o,contentRef:h,contentId:Qe(),titleId:Qe(),descriptionId:Qe(),open:p,onOpenChange:u,onOpenToggle:c.useCallback(()=>u(m=>!m),[u]),modal:l,children:r})};yn.displayName=Dt;var vn="DialogTrigger",Ul=c.forwardRef((e,s)=>{const{__scopeDialog:r,...n}=e,i=re(vn,r),a=ae(s,i.triggerRef);return t.jsx(Q.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":Ts(i.open),...n,ref:a,onClick:K(e.onClick,i.onOpenToggle)})});Ul.displayName=vn;var Rs="DialogPortal",[Bl,bn]=gn(Rs,{forceMount:void 0}),jn=e=>{const{__scopeDialog:s,forceMount:r,children:n,container:i}=e,a=re(Rs,s);return t.jsx(Bl,{scope:s,forceMount:r,children:c.Children.map(n,l=>t.jsx(nt,{present:r||a.open,children:t.jsx(on,{asChild:!0,container:i,children:l})}))})};jn.displayName=Rs;var kt="DialogOverlay",Nn=c.forwardRef((e,s)=>{const r=bn(kt,e.__scopeDialog),{forceMount:n=r.forceMount,...i}=e,a=re(kt,e.__scopeDialog);return a.modal?t.jsx(nt,{present:n||a.open,children:t.jsx(ql,{...i,ref:s})}):null});Nn.displayName=kt;var $l=Rt("DialogOverlay.RemoveScroll"),ql=c.forwardRef((e,s)=>{const{__scopeDialog:r,...n}=e,i=re(kt,r);return t.jsx(pn,{as:$l,allowPinchZoom:!0,shards:[i.contentRef],children:t.jsx(Q.div,{"data-state":Ts(i.open),...n,ref:s,style:{pointerEvents:"auto",...n.style}})})}),Ee="DialogContent",wn=c.forwardRef((e,s)=>{const r=bn(Ee,e.__scopeDialog),{forceMount:n=r.forceMount,...i}=e,a=re(Ee,e.__scopeDialog);return t.jsx(nt,{present:n||a.open,children:a.modal?t.jsx(Vl,{...i,ref:s}):t.jsx(zl,{...i,ref:s})})});wn.displayName=Ee;var Vl=c.forwardRef((e,s)=>{const r=re(Ee,e.__scopeDialog),n=c.useRef(null),i=ae(s,r.contentRef,n);return c.useEffect(()=>{const a=n.current;if(a)return Fl(a)},[]),t.jsx(Sn,{...e,ref:i,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:K(e.onCloseAutoFocus,a=>{a.preventDefault(),r.triggerRef.current?.focus()}),onPointerDownOutside:K(e.onPointerDownOutside,a=>{const l=a.detail.originalEvent,o=l.button===0&&l.ctrlKey===!0;(l.button===2||o)&&a.preventDefault()}),onFocusOutside:K(e.onFocusOutside,a=>a.preventDefault())})}),zl=c.forwardRef((e,s)=>{const r=re(Ee,e.__scopeDialog),n=c.useRef(!1),i=c.useRef(!1);return t.jsx(Sn,{...e,ref:s,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:a=>{e.onCloseAutoFocus?.(a),a.defaultPrevented||(n.current||r.triggerRef.current?.focus(),a.preventDefault()),n.current=!1,i.current=!1},onInteractOutside:a=>{e.onInteractOutside?.(a),a.defaultPrevented||(n.current=!0,a.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const l=a.target;r.triggerRef.current?.contains(l)&&a.preventDefault(),a.detail.originalEvent.type==="focusin"&&i.current&&a.preventDefault()}})}),Sn=c.forwardRef((e,s)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:i,onCloseAutoFocus:a,...l}=e,o=re(Ee,r),h=c.useRef(null),p=ae(s,h);return Yo(),t.jsxs(t.Fragment,{children:[t.jsx(nn,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:i,onUnmountAutoFocus:a,children:t.jsx(sn,{role:"dialog",id:o.contentId,"aria-describedby":o.descriptionId,"aria-labelledby":o.titleId,"data-state":Ts(o.open),...l,ref:p,onDismiss:()=>o.onOpenChange(!1)})}),t.jsxs(t.Fragment,{children:[t.jsx(Wl,{titleId:o.titleId}),t.jsx(Hl,{contentRef:h,descriptionId:o.descriptionId})]})]})}),ks="DialogTitle",Cn=c.forwardRef((e,s)=>{const{__scopeDialog:r,...n}=e,i=re(ks,r);return t.jsx(Q.h2,{id:i.titleId,...n,ref:s})});Cn.displayName=ks;var En="DialogDescription",Rn=c.forwardRef((e,s)=>{const{__scopeDialog:r,...n}=e,i=re(En,r);return t.jsx(Q.p,{id:i.descriptionId,...n,ref:s})});Rn.displayName=En;var kn="DialogClose",Tn=c.forwardRef((e,s)=>{const{__scopeDialog:r,...n}=e,i=re(kn,r);return t.jsx(Q.button,{type:"button",...n,ref:s,onClick:K(e.onClick,()=>i.onOpenChange(!1))})});Tn.displayName=kn;function Ts(e){return e?"open":"closed"}var An="DialogTitleWarning",[Od,On]=go(An,{contentName:Ee,titleName:ks,docsSlug:"dialog"}),Wl=({titleId:e})=>{const s=On(An),r=`\`${s.contentName}\` requires a \`${s.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${s.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${s.docsSlug}`;return c.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},Kl="DialogDescriptionWarning",Hl=({contentRef:e,descriptionId:s})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${On(Kl).contentName}}.`;return c.useEffect(()=>{const i=e.current?.getAttribute("aria-describedby");s&&i&&(document.getElementById(s)||console.warn(n))},[n,e,s]),null},Gl=yn,Ql=jn,_n=Nn,Pn=wn,Dn=Cn,In=Rn,Jl=Tn;const As=Gl,Yl=Ql,Mn=c.forwardRef(({className:e,...s},r)=>t.jsx(_n,{ref:r,className:V("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...s}));Mn.displayName=_n.displayName;const Fn=c.forwardRef(({className:e,children:s,...r},n)=>t.jsxs(Yl,{children:[t.jsx(Mn,{}),t.jsxs(Pn,{ref:n,className:V("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...r,children:[s,t.jsxs(Jl,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[t.jsx(We,{className:"h-4 w-4"}),t.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Fn.displayName=Pn.displayName;const Ln=({className:e,...s})=>t.jsx("div",{className:V("flex flex-col space-y-1.5 text-center sm:text-left",e),...s});Ln.displayName="DialogHeader";const Un=c.forwardRef(({className:e,...s},r)=>t.jsx(Dn,{ref:r,className:V("text-lg font-semibold leading-none tracking-tight",e),...s}));Un.displayName=Dn.displayName;const Xl=c.forwardRef(({className:e,...s},r)=>t.jsx(In,{ref:r,className:V("text-sm text-muted-foreground",e),...s}));Xl.displayName=In.displayName;const it=c.forwardRef(({className:e,...s},r)=>t.jsx("textarea",{className:V("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...s}));it.displayName="Textarea";function Zl({document:e,isOpen:s,onClose:r,onReview:n}){const[i,a]=c.useState(""),[l,o]=c.useState(!1),h=async p=>{o(!0);try{await n(e.id,p,i),r()}catch(u){console.error("Review failed:",u)}finally{o(!1)}};return t.jsx(As,{open:s,onOpenChange:r,children:t.jsxs("div",{className:"p-6 max-w-2xl",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"Review KYC Document"}),t.jsxs("div",{className:"mb-4",children:[t.jsxs("p",{children:[t.jsx("strong",{children:"User:"})," ",e.userName," (",e.userEmail,")"]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Document Type:"})," ",e.documentType]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Submitted:"})," ",new Date(e.submittedAt).toLocaleDateString()]})]}),t.jsx("div",{className:"mb-4",children:t.jsx("img",{src:e.documentUrl,alt:"KYC Document",className:"max-w-full h-auto border rounded"})}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"Review Notes (required for rejection)"}),t.jsx(it,{value:i,onChange:p=>a(p.target.value),placeholder:"Enter review notes...",rows:4})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx(L,{onClick:()=>h("approve"),disabled:l,className:"bg-green-600 hover:bg-green-700",children:"Approve"}),t.jsx(L,{onClick:()=>h("reject"),disabled:l||!i.trim(),variant:"destructive",children:"Reject"}),t.jsx(L,{variant:"outline",onClick:r,children:"Cancel"})]})]})})}function ec({selectedCount:e,onBatchAction:s}){const[r,n]=c.useState(!1),[i,a]=c.useState(""),[l,o]=c.useState(!1),h=async()=>{o(!0);try{await s("approve")}catch(u){console.error("Batch approve failed:",u)}finally{o(!1)}},p=async()=>{if(i.trim()){o(!0);try{await s("reject",i),n(!1),a("")}catch(u){console.error("Batch reject failed:",u)}finally{o(!1)}}};return e===0?null:t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg mb-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("span",{className:"text-sm font-medium",children:[e," document(s) selected"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(L,{size:"sm",onClick:h,disabled:l,className:"bg-green-600 hover:bg-green-700",children:"Approve All"}),t.jsx(L,{size:"sm",variant:"destructive",onClick:()=>n(!0),disabled:l,children:"Reject All"})]})]}),t.jsx(As,{open:r,onOpenChange:n,children:t.jsxs("div",{className:"p-6",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Reject Selected Documents"}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"Rejection Reason (required)"}),t.jsx(it,{value:i,onChange:u=>a(u.target.value),placeholder:"Enter reason for rejection...",rows:4})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx(L,{onClick:p,disabled:!i.trim()||l,variant:"destructive",children:"Confirm Reject"}),t.jsx(L,{variant:"outline",onClick:()=>n(!1),children:"Cancel"})]})]})})]})}function tc(){const[e,s]=c.useState([]),[r,n]=c.useState(null),[i,a]=c.useState([]),[l,o]=c.useState(!0),[h,p]=c.useState("all"),[u,m]=c.useState([]),[f,R]=c.useState({total:0,pending:0,approved:0,rejected:0});c.useEffect(()=>{g(),k()},[]);const k=async()=>{try{const y=await fetch("/api/admin/merchant-kyc/pending",{credentials:"include",headers:{"Content-Type":"application/json"}});if(y.ok){const P=await y.json();m(P.data?.submissions||[]),R(P.data?.stats||{total:0,pending:0,approved:0,rejected:0})}}catch(y){console.error("Failed to fetch merchant KYC submissions:",y)}},x=async(y,P,A)=>{try{(await fetch(`/api/admin/merchant-kyc/${y}/review`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:P,reason:A})})).ok&&await k()}catch(v){console.error("Failed to review merchant KYC:",v)}},g=async()=>{try{const y=await fetch("/api/admin/kyc/documents",{credentials:"include",headers:{"Content-Type":"application/json"}});if(y.ok){const P=await y.json();s(P.documents||[])}}catch(y){console.error("Failed to fetch KYC documents:",y)}finally{o(!1)}},S=e.filter(y=>h==="all"?!0:y.status===h),C=e.filter(y=>y.status==="PENDING").length,E=async(y,P,A)=>{try{(await fetch(`/api/admin/kyc/documents/${y}/review`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:P==="approve"?"APPROVED":"REJECTED",reason:A})})).ok&&(await g(),n(null))}catch(v){console.error("Failed to review document:",v)}},N=async(y,P)=>{try{(await fetch("/api/admin/kyc/batch-review",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({documentIds:i,action:y,reason:P})})).ok&&await g()}catch(A){console.error("Batch action failed:",A)}};return l?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold",children:"KYC Verification"}),t.jsxs("p",{className:"text-gray-600",children:[C," consumer documents | ",f.pending||0," merchant submissions pending"]})]}),i.length>0&&t.jsx(ec,{selectedCount:i.length,onBatchAction:N})]}),t.jsx("div",{className:"flex space-x-4",children:t.jsxs("select",{value:h,onChange:y=>p(y.target.value),className:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"all",children:"All Status"}),t.jsx("option",{value:"PENDING",children:"Pending"}),t.jsx("option",{value:"APPROVED",children:"Approved"}),t.jsx("option",{value:"REJECTED",children:"Rejected"})]})}),t.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left",children:t.jsx("input",{type:"checkbox",checked:i.length===S.length,onChange:y=>{y.target.checked?a(S.map(P=>P.id)):a([])}})}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Document Type"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Submitted"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:S.map(y=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("input",{type:"checkbox",checked:i.includes(y.id),onChange:P=>{P.target.checked?a([...i,y.id]):a(i.filter(A=>A!==y.id))}})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-medium text-gray-900",children:y.userName}),t.jsx("div",{className:"text-sm text-gray-500",children:y.userEmail})]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"text-sm text-gray-900",children:y.documentType.replace("_"," ")})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${y.status==="PENDING"?"bg-yellow-100 text-yellow-800":y.status==="APPROVED"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:y.status})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(y.submittedAt).toLocaleDateString()}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:t.jsx("button",{onClick:()=>n(y),className:"text-blue-600 hover:text-blue-900",children:"Review"})})]},y.id))})]})}),t.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden mt-8",children:[t.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[t.jsx("h3",{className:"text-lg font-medium",children:"Merchant KYC Submissions"}),t.jsxs("p",{className:"text-sm text-gray-600",children:[f.pending||0," pending submissions"]})]}),t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Business"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Business Type"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Owner"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Submitted"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:u.map(y=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-medium text-gray-900",children:y.businessRegistrationNumber}),t.jsx("div",{className:"text-sm text-gray-500",children:y.businessEmail})]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"text-sm text-gray-900",children:y.businessType?.replace("_"," ")})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-medium text-gray-900",children:y.ownerFullName}),t.jsx("div",{className:"text-sm text-gray-500",children:y.ownerNationalId})]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${y.status==="PENDING"?"bg-yellow-100 text-yellow-800":y.status==="APPROVED"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:y.status})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(y.submittedAt).toLocaleDateString()}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[t.jsx("button",{onClick:()=>x(y.id.toString(),"approve"),className:"text-green-600 hover:text-green-900",children:"Approve"}),t.jsx("button",{onClick:()=>x(y.id.toString(),"reject","Documents incomplete"),className:"text-red-600 hover:text-red-900",children:"Reject"})]})]},y.id))})]})]}),r&&t.jsx(Zl,{document:r,isOpen:!!r,onClose:()=>n(null),onReview:E})]})}function sc({transactionId:e,onClose:s}){return e?t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Transaction Details"}),t.jsx("button",{onClick:s,className:"text-gray-500 hover:text-gray-700",children:""})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:[t.jsx("strong",{children:"Transaction ID:"})," ",e]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Status:"})," Processing"]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Amount:"})," 1,000"]})]}),t.jsx("div",{className:"mt-6 flex justify-end",children:t.jsx("button",{onClick:s,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded hover:bg-gray-300",children:"Close"})})]})}):null}function rc({isOpen:e,onClose:s,transaction:r,onRefundProcess:n}){if(!e)return null;const i=async()=>{await n({transactionId:r.id,amount:r.amount,reason:"Admin initiated refund"}),s()};return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Process Refund"}),t.jsx("button",{onClick:s,className:"text-gray-500 hover:text-gray-700",children:""})]}),t.jsxs("div",{className:"space-y-2 mb-6",children:[t.jsxs("p",{children:[t.jsx("strong",{children:"Transaction ID:"})," ",r.id]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Refund Amount:"})," ",r.amount]})]}),t.jsxs("div",{className:"flex gap-2 justify-end",children:[t.jsx("button",{onClick:s,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded hover:bg-gray-300",children:"Cancel"}),t.jsx("button",{onClick:i,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Process Refund"})]})]})})}function nc(){const[e,s]=c.useState([]),[r,n]=c.useState({successTotal:0,successCount:0,failedCount:0,pendingCount:0}),[i,a]=c.useState(!0),[l,o]=c.useState(null),[h,p]=c.useState([]),[u,m]=c.useState({status:"",type:"",channel:"",minAmount:"",maxAmount:"",startDate:"",endDate:"",search:""}),[f,R]=c.useState({page:1,limit:20,total:0,totalPages:0}),[k,x]=c.useState(!1),[g,S]=c.useState(!1),[C,E]=c.useState(null),[N,y]=c.useState(null),[P,A]=c.useState(null),v=async()=>{try{a(!0);const d=new URLSearchParams({page:f.page.toString(),limit:f.limit.toString(),...Object.fromEntries(Object.entries(u).filter(([M,H])=>H))}),T=await fetch(`/api/admin/transactions?${d}`,{headers:{Authorization:`Bearer ${localStorage.getItem("adminToken")}`,"Content-Type":"application/json"}});if(!T.ok)throw new Error("Failed to fetch transactions");const O=await T.json();s(O.data.items),n(O.data.statistics),R(M=>({...M,total:O.data.total,totalPages:O.data.totalPages})),o(null)}catch(d){o(d instanceof Error?d.message:"Failed to fetch transactions")}finally{a(!1)}};c.useEffect(()=>{v()},[f.page,u]);const D=async(d,T,O)=>{try{if(E(`${T}-${d}`),!(await fetch(`/api/admin/transactions/${d}/${T}`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("adminToken")}`,"Content-Type":"application/json"},body:JSON.stringify(O||{})})).ok)throw new Error(`Failed to ${T} transaction`);v(),console.log(`Transaction ${T}ed successfully`)}catch(M){console.error(`Failed to ${T} transaction:`,M)}finally{E(null)}},w=async(d,T)=>{if(h.length!==0)try{if(E(`bulk-${d}`),!(await fetch("/api/admin/transactions/bulk-action",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("adminToken")}`,"Content-Type":"application/json"},body:JSON.stringify({transactionIds:h,action:d,reason:T})})).ok)throw new Error(`Failed to ${d} transactions`);p([]),S(!1),v(),console.log(`Bulk ${d} completed successfully`)}catch(O){console.error(`Failed to ${d} transactions:`,O)}finally{E(null)}},_=({status:d})=>{const O=(H=>{switch(H.toUpperCase()){case"SUCCESS":return{color:"bg-green-100 text-green-800",icon:ge};case"PENDING":return{color:"bg-yellow-100 text-yellow-800",icon:Ne};case"PROCESSING":return{color:"bg-blue-100 text-blue-800",icon:je};case"FAILED":return{color:"bg-red-100 text-red-800",icon:We};case"CANCELLED":return{color:"bg-gray-100 text-gray-800",icon:We};case"REVERSED":return{color:"bg-purple-100 text-purple-800",icon:$s};default:return{color:"bg-gray-100 text-gray-800",icon:ue}}})(d),M=O.icon;return t.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${O.color}`,children:[t.jsx(M,{className:"h-3 w-3 mr-1"}),d]})},b=(d,T="NGN")=>{const O=parseFloat(d);return new Intl.NumberFormat("en-NG",{style:"currency",currency:T==="NGN"?"NGN":"USD",minimumFractionDigits:2}).format(O)},j=d=>new Date(d).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Transaction Management"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Monitor and manage all financial transactions"})]}),t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsxs("button",{onClick:()=>x(!k),className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[t.jsx(Or,{className:"h-4 w-4 mr-2"}),"Filters"]}),t.jsxs("button",{onClick:v,disabled:i,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50",children:[t.jsx(je,{className:`h-4 w-4 mr-2 ${i?"animate-spin":""}`}),"Refresh"]}),t.jsxs("button",{className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[t.jsx(Ti,{className:"h-4 w-4 mr-2"}),"Export"]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[t.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:t.jsx("div",{className:"p-5",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx(Ye,{className:"h-6 w-6 text-green-400"})}),t.jsx("div",{className:"ml-5 w-0 flex-1",children:t.jsxs("dl",{children:[t.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Success"}),t.jsx("dd",{className:"text-lg font-medium text-gray-900",children:b(r.successTotal.toString())})]})})]})})}),t.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:t.jsx("div",{className:"p-5",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx(ge,{className:"h-6 w-6 text-green-400"})}),t.jsx("div",{className:"ml-5 w-0 flex-1",children:t.jsxs("dl",{children:[t.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Successful"}),t.jsx("dd",{className:"text-lg font-medium text-gray-900",children:r.successCount.toLocaleString()})]})})]})})}),t.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:t.jsx("div",{className:"p-5",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx(Ne,{className:"h-6 w-6 text-yellow-400"})}),t.jsx("div",{className:"ml-5 w-0 flex-1",children:t.jsxs("dl",{children:[t.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Pending"}),t.jsx("dd",{className:"text-lg font-medium text-gray-900",children:r.pendingCount.toLocaleString()})]})})]})})}),t.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:t.jsx("div",{className:"p-5",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx(ue,{className:"h-6 w-6 text-red-400"})}),t.jsx("div",{className:"ml-5 w-0 flex-1",children:t.jsxs("dl",{children:[t.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Failed"}),t.jsx("dd",{className:"text-lg font-medium text-gray-900",children:r.failedCount.toLocaleString()})]})})]})})})]}),k&&t.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"text",placeholder:"Search transactions...",value:u.search,onChange:d=>m(T=>({...T,search:d.target.value})),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"}),t.jsx(At,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),t.jsxs("select",{value:u.status,onChange:d=>m(T=>({...T,status:d.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[t.jsx("option",{value:"",children:"All Statuses"}),t.jsx("option",{value:"PENDING",children:"Pending"}),t.jsx("option",{value:"PROCESSING",children:"Processing"}),t.jsx("option",{value:"SUCCESS",children:"Success"}),t.jsx("option",{value:"FAILED",children:"Failed"}),t.jsx("option",{value:"CANCELLED",children:"Cancelled"}),t.jsx("option",{value:"REVERSED",children:"Reversed"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),t.jsxs("select",{value:u.type,onChange:d=>m(T=>({...T,type:d.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[t.jsx("option",{value:"",children:"All Types"}),t.jsx("option",{value:"DEPOSIT",children:"Deposit"}),t.jsx("option",{value:"WITHDRAWAL",children:"Withdrawal"}),t.jsx("option",{value:"TRANSFER",children:"Transfer"}),t.jsx("option",{value:"PAYMENT",children:"Payment"}),t.jsx("option",{value:"REFUND",children:"Refund"}),t.jsx("option",{value:"COMMISSION",children:"Commission"}),t.jsx("option",{value:"ESCROW_HOLD",children:"Escrow Hold"}),t.jsx("option",{value:"ESCROW_RELEASE",children:"Escrow Release"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Channel"}),t.jsxs("select",{value:u.channel,onChange:d=>m(T=>({...T,channel:d.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[t.jsx("option",{value:"",children:"All Channels"}),t.jsx("option",{value:"card",children:"Card"}),t.jsx("option",{value:"bank",children:"Bank Transfer"}),t.jsx("option",{value:"ussd",children:"USSD"}),t.jsx("option",{value:"qr",children:"QR Code"}),t.jsx("option",{value:"wallet",children:"Wallet"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Min Amount"}),t.jsx("input",{type:"number",placeholder:"0",value:u.minAmount,onChange:d=>m(T=>({...T,minAmount:d.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Amount"}),t.jsx("input",{type:"number",placeholder:"999999999",value:u.maxAmount,onChange:d=>m(T=>({...T,maxAmount:d.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),t.jsx("input",{type:"date",value:u.startDate,onChange:d=>m(T=>({...T,startDate:d.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),t.jsx("input",{type:"date",value:u.endDate,onChange:d=>m(T=>({...T,endDate:d.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})]}),t.jsx("div",{className:"mt-4 flex items-center justify-between",children:t.jsx("button",{onClick:()=>m({status:"",type:"",channel:"",minAmount:"",maxAmount:"",startDate:"",endDate:"",search:""}),className:"text-sm text-gray-500 hover:text-gray-700",children:"Clear all filters"})})]}),h.length>0&&t.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{className:"flex items-center",children:t.jsxs("span",{className:"text-sm font-medium text-blue-800",children:[h.length," transaction(s) selected"]})}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsxs("button",{onClick:()=>w("hold","Bulk hold operation"),disabled:!!C,className:"inline-flex items-center px-3 py-1.5 border border-transparent text-sm font-medium rounded text-yellow-700 bg-yellow-100 hover:bg-yellow-200 disabled:opacity-50",children:[t.jsx(Bs,{className:"h-4 w-4 mr-1"}),"Hold"]}),t.jsxs("button",{onClick:()=>w("release"),disabled:!!C,className:"inline-flex items-center px-3 py-1.5 border border-transparent text-sm font-medium rounded text-green-700 bg-green-100 hover:bg-green-200 disabled:opacity-50",children:[t.jsx(xt,{className:"h-4 w-4 mr-1"}),"Release"]}),t.jsxs("button",{onClick:()=>w("cancel","Bulk cancellation"),disabled:!!C,className:"inline-flex items-center px-3 py-1.5 border border-transparent text-sm font-medium rounded text-red-700 bg-red-100 hover:bg-red-200 disabled:opacity-50",children:[t.jsx(We,{className:"h-4 w-4 mr-1"}),"Cancel"]}),t.jsx("button",{onClick:()=>p([]),className:"text-sm text-gray-500 hover:text-gray-700",children:"Clear selection"})]})]})}),t.jsxs("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:[i?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx(je,{className:"h-8 w-8 animate-spin text-gray-400"})}):l?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsxs("div",{className:"text-center",children:[t.jsx(ue,{className:"h-8 w-8 text-red-400 mx-auto mb-2"}),t.jsx("p",{className:"text-gray-500",children:l}),t.jsx("button",{onClick:v,className:"mt-2 text-blue-600 hover:text-blue-500",children:"Try again"})]})}):e.length===0?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsxs("div",{className:"text-center",children:[t.jsx(Ye,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),t.jsx("p",{className:"text-gray-500",children:"No transactions found"})]})}):t.jsx("ul",{className:"divide-y divide-gray-200",children:e.map(d=>t.jsx("li",{className:"px-6 py-4",children:t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("input",{type:"checkbox",checked:h.includes(d.id),onChange:T=>{T.target.checked?p(O=>[...O,d.id]):p(O=>O.filter(M=>M!==d.id))},className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded mr-4"}),t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:d.user?.fullName||"Unknown User"}),t.jsxs("p",{className:"text-sm text-gray-500 truncate",children:[d.user?.email,"  ",d.user?.userId]})]}),t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"text-sm font-medium text-gray-900",children:b(d.amount,d.currency)}),t.jsxs("p",{className:"text-xs text-gray-500",children:["Fee: ",b(d.fee,d.currency)]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(_,{status:d.status}),t.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:d.type})]})]})]}),t.jsxs("div",{className:"mt-2 flex items-center justify-between text-sm text-gray-500",children:[t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("span",{children:j(d.initiatedAt)}),d.channel&&t.jsxs("span",{className:"capitalize",children:["via ",d.channel]}),d.paystackReference&&t.jsxs("span",{className:"font-mono text-xs",children:["Ref: ",d.paystackReference]})]}),t.jsxs("div",{className:"flex items-center space-x-1",children:[t.jsx("button",{onClick:()=>y(d.id),className:"p-1 text-gray-400 hover:text-gray-600",title:"View Details",children:t.jsx(tt,{className:"h-4 w-4"})}),d.status==="PENDING"&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>D(d.id,"hold",{reason:"Manual hold"}),disabled:C===`hold-${d.id}`,className:"p-1 text-yellow-400 hover:text-yellow-600 disabled:opacity-50",title:"Hold Transaction",children:t.jsx(Bs,{className:"h-4 w-4"})}),t.jsx("button",{onClick:()=>D(d.id,"release"),disabled:C===`release-${d.id}`,className:"p-1 text-green-400 hover:text-green-600 disabled:opacity-50",title:"Release Transaction",children:t.jsx(xt,{className:"h-4 w-4"})})]}),d.status==="PROCESSING"&&t.jsx("button",{onClick:()=>D(d.id,"release"),disabled:C===`release-${d.id}`,className:"p-1 text-green-400 hover:text-green-600 disabled:opacity-50",title:"Release Transaction",children:t.jsx(xt,{className:"h-4 w-4"})}),(d.status==="SUCCESS"||d.status==="COMPLETED")&&t.jsx("button",{onClick:()=>A(d),disabled:C===`refund-${d.id}`,className:"p-1 text-purple-400 hover:text-purple-600 disabled:opacity-50",title:"Refund Transaction",children:t.jsx($s,{className:"h-4 w-4"})}),t.jsx("button",{className:"p-1 text-gray-400 hover:text-gray-600",children:t.jsx(bs,{className:"h-4 w-4"})})]})]}),d.description&&t.jsx("div",{className:"mt-1",children:t.jsx("p",{className:"text-xs text-gray-600",children:d.description})})]})]})})},d.id))}),f.totalPages>1&&t.jsx("div",{className:"bg-white px-4 py-3 border-t border-gray-200 sm:px-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[t.jsx("button",{onClick:()=>R(d=>({...d,page:Math.max(1,d.page-1)})),disabled:f.page<=1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Previous"}),t.jsx("button",{onClick:()=>R(d=>({...d,page:Math.min(d.totalPages,d.page+1)})),disabled:f.page>=f.totalPages,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Next"})]}),t.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[t.jsx("div",{children:t.jsxs("p",{className:"text-sm text-gray-700",children:["Showing"," ",t.jsx("span",{className:"font-medium",children:(f.page-1)*f.limit+1})," ","to"," ",t.jsx("span",{className:"font-medium",children:Math.min(f.page*f.limit,f.total)})," ","of"," ",t.jsx("span",{className:"font-medium",children:f.total})," ","results"]})}),t.jsx("div",{children:t.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[t.jsx("button",{onClick:()=>R(d=>({...d,page:Math.max(1,d.page-1)})),disabled:f.page<=1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"Previous"}),Array.from({length:Math.min(5,f.totalPages)},(d,T)=>{const O=T+1;return t.jsx("button",{onClick:()=>R(M=>({...M,page:O})),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${f.page===O?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:O},O)}),t.jsx("button",{onClick:()=>R(d=>({...d,page:Math.min(d.totalPages,d.page+1)})),disabled:f.page>=f.totalPages,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"Next"})]})})]})]})})]}),t.jsx(sc,{isOpen:!!N,onClose:()=>y(null),transactionId:N||""}),t.jsx(rc,{isOpen:!!P,onClose:()=>A(null),transaction:P||{},onRefundProcess:async d=>{P&&await D(P.id,"refund",d)}})]})}const oe=Object.create(null);oe.open="0";oe.close="1";oe.ping="2";oe.pong="3";oe.message="4";oe.upgrade="5";oe.noop="6";const jt=Object.create(null);Object.keys(oe).forEach(e=>{jt[oe[e]]=e});const ms={type:"error",data:"parser error"},Bn=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",$n=typeof ArrayBuffer=="function",qn=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,Os=({type:e,data:s},r,n)=>Bn&&s instanceof Blob?r?n(s):vr(s,n):$n&&(s instanceof ArrayBuffer||qn(s))?r?n(s):vr(new Blob([s]),n):n(oe[e]+(s||"")),vr=(e,s)=>{const r=new FileReader;return r.onload=function(){const n=r.result.split(",")[1];s("b"+(n||""))},r.readAsDataURL(e)};function br(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let Xt;function ic(e,s){if(Bn&&e.data instanceof Blob)return e.data.arrayBuffer().then(br).then(s);if($n&&(e.data instanceof ArrayBuffer||qn(e.data)))return s(br(e.data));Os(e,!1,r=>{Xt||(Xt=new TextEncoder),s(Xt.encode(r))})}const jr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ze=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<jr.length;e++)ze[jr.charCodeAt(e)]=e;const ac=e=>{let s=e.length*.75,r=e.length,n,i=0,a,l,o,h;e[e.length-1]==="="&&(s--,e[e.length-2]==="="&&s--);const p=new ArrayBuffer(s),u=new Uint8Array(p);for(n=0;n<r;n+=4)a=ze[e.charCodeAt(n)],l=ze[e.charCodeAt(n+1)],o=ze[e.charCodeAt(n+2)],h=ze[e.charCodeAt(n+3)],u[i++]=a<<2|l>>4,u[i++]=(l&15)<<4|o>>2,u[i++]=(o&3)<<6|h&63;return p},oc=typeof ArrayBuffer=="function",_s=(e,s)=>{if(typeof e!="string")return{type:"message",data:Vn(e,s)};const r=e.charAt(0);return r==="b"?{type:"message",data:lc(e.substring(1),s)}:jt[r]?e.length>1?{type:jt[r],data:e.substring(1)}:{type:jt[r]}:ms},lc=(e,s)=>{if(oc){const r=ac(e);return Vn(r,s)}else return{base64:!0,data:e}},Vn=(e,s)=>{switch(s){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},zn="",cc=(e,s)=>{const r=e.length,n=new Array(r);let i=0;e.forEach((a,l)=>{Os(a,!1,o=>{n[l]=o,++i===r&&s(n.join(zn))})})},dc=(e,s)=>{const r=e.split(zn),n=[];for(let i=0;i<r.length;i++){const a=_s(r[i],s);if(n.push(a),a.type==="error")break}return n};function uc(){return new TransformStream({transform(e,s){ic(e,r=>{const n=r.length;let i;if(n<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,n);else if(n<65536){i=new Uint8Array(3);const a=new DataView(i.buffer);a.setUint8(0,126),a.setUint16(1,n)}else{i=new Uint8Array(9);const a=new DataView(i.buffer);a.setUint8(0,127),a.setBigUint64(1,BigInt(n))}e.data&&typeof e.data!="string"&&(i[0]|=128),s.enqueue(i),s.enqueue(r)})}})}let Zt;function ft(e){return e.reduce((s,r)=>s+r.length,0)}function pt(e,s){if(e[0].length===s)return e.shift();const r=new Uint8Array(s);let n=0;for(let i=0;i<s;i++)r[i]=e[0][n++],n===e[0].length&&(e.shift(),n=0);return e.length&&n<e[0].length&&(e[0]=e[0].slice(n)),r}function hc(e,s){Zt||(Zt=new TextDecoder);const r=[];let n=0,i=-1,a=!1;return new TransformStream({transform(l,o){for(r.push(l);;){if(n===0){if(ft(r)<1)break;const h=pt(r,1);a=(h[0]&128)===128,i=h[0]&127,i<126?n=3:i===126?n=1:n=2}else if(n===1){if(ft(r)<2)break;const h=pt(r,2);i=new DataView(h.buffer,h.byteOffset,h.length).getUint16(0),n=3}else if(n===2){if(ft(r)<8)break;const h=pt(r,8),p=new DataView(h.buffer,h.byteOffset,h.length),u=p.getUint32(0);if(u>Math.pow(2,21)-1){o.enqueue(ms);break}i=u*Math.pow(2,32)+p.getUint32(4),n=3}else{if(ft(r)<i)break;const h=pt(r,i);o.enqueue(_s(a?h:Zt.decode(h),s)),n=0}if(i===0||i>e){o.enqueue(ms);break}}}})}const Wn=4;function $(e){if(e)return mc(e)}function mc(e){for(var s in $.prototype)e[s]=$.prototype[s];return e}$.prototype.on=$.prototype.addEventListener=function(e,s){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(s),this};$.prototype.once=function(e,s){function r(){this.off(e,r),s.apply(this,arguments)}return r.fn=s,this.on(e,r),this};$.prototype.off=$.prototype.removeListener=$.prototype.removeAllListeners=$.prototype.removeEventListener=function(e,s){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+e];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var n,i=0;i<r.length;i++)if(n=r[i],n===s||n.fn===s){r.splice(i,1);break}return r.length===0&&delete this._callbacks["$"+e],this};$.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var s=new Array(arguments.length-1),r=this._callbacks["$"+e],n=1;n<arguments.length;n++)s[n-1]=arguments[n];if(r){r=r.slice(0);for(var n=0,i=r.length;n<i;++n)r[n].apply(this,s)}return this};$.prototype.emitReserved=$.prototype.emit;$.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};$.prototype.hasListeners=function(e){return!!this.listeners(e).length};const It=typeof Promise=="function"&&typeof Promise.resolve=="function"?s=>Promise.resolve().then(s):(s,r)=>r(s,0),ee=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),fc="arraybuffer";function Kn(e,...s){return s.reduce((r,n)=>(e.hasOwnProperty(n)&&(r[n]=e[n]),r),{})}const pc=ee.setTimeout,xc=ee.clearTimeout;function Mt(e,s){s.useNativeTimers?(e.setTimeoutFn=pc.bind(ee),e.clearTimeoutFn=xc.bind(ee)):(e.setTimeoutFn=ee.setTimeout.bind(ee),e.clearTimeoutFn=ee.clearTimeout.bind(ee))}const gc=1.33;function yc(e){return typeof e=="string"?vc(e):Math.ceil((e.byteLength||e.size)*gc)}function vc(e){let s=0,r=0;for(let n=0,i=e.length;n<i;n++)s=e.charCodeAt(n),s<128?r+=1:s<2048?r+=2:s<55296||s>=57344?r+=3:(n++,r+=4);return r}function Hn(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function bc(e){let s="";for(let r in e)e.hasOwnProperty(r)&&(s.length&&(s+="&"),s+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return s}function jc(e){let s={},r=e.split("&");for(let n=0,i=r.length;n<i;n++){let a=r[n].split("=");s[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return s}class Nc extends Error{constructor(s,r,n){super(s),this.description=r,this.context=n,this.type="TransportError"}}class Ps extends ${constructor(s){super(),this.writable=!1,Mt(this,s),this.opts=s,this.query=s.query,this.socket=s.socket,this.supportsBinary=!s.forceBase64}onError(s,r,n){return super.emitReserved("error",new Nc(s,r,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(s){this.readyState==="open"&&this.write(s)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(s){const r=_s(s,this.socket.binaryType);this.onPacket(r)}onPacket(s){super.emitReserved("packet",s)}onClose(s){this.readyState="closed",super.emitReserved("close",s)}pause(s){}createUri(s,r={}){return s+"://"+this._hostname()+this._port()+this.opts.path+this._query(r)}_hostname(){const s=this.opts.hostname;return s.indexOf(":")===-1?s:"["+s+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(s){const r=bc(s);return r.length?"?"+r:""}}class wc extends Ps{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(s){this.readyState="pausing";const r=()=>{this.readyState="paused",s()};if(this._polling||!this.writable){let n=0;this._polling&&(n++,this.once("pollComplete",function(){--n||r()})),this.writable||(n++,this.once("drain",function(){--n||r()}))}else r()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(s){const r=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};dc(s,this.socket.binaryType).forEach(r),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const s=()=>{this.write([{type:"close"}])};this.readyState==="open"?s():this.once("open",s)}write(s){this.writable=!1,cc(s,r=>{this.doWrite(r,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const s=this.opts.secure?"https":"http",r=this.query||{};return this.opts.timestampRequests!==!1&&(r[this.opts.timestampParam]=Hn()),!this.supportsBinary&&!r.sid&&(r.b64=1),this.createUri(s,r)}}let Gn=!1;try{Gn=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const Sc=Gn;function Cc(){}class Ec extends wc{constructor(s){if(super(s),typeof location<"u"){const r=location.protocol==="https:";let n=location.port;n||(n=r?"443":"80"),this.xd=typeof location<"u"&&s.hostname!==location.hostname||n!==s.port}}doWrite(s,r){const n=this.request({method:"POST",data:s});n.on("success",r),n.on("error",(i,a)=>{this.onError("xhr post error",i,a)})}doPoll(){const s=this.request();s.on("data",this.onData.bind(this)),s.on("error",(r,n)=>{this.onError("xhr poll error",r,n)}),this.pollXhr=s}}class ie extends ${constructor(s,r,n){super(),this.createRequest=s,Mt(this,n),this._opts=n,this._method=n.method||"GET",this._uri=r,this._data=n.data!==void 0?n.data:null,this._create()}_create(){var s;const r=Kn(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(r);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let i in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(i)&&n.setRequestHeader(i,this._opts.extraHeaders[i])}}catch{}if(this._method==="POST")try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}(s=this._opts.cookieJar)===null||s===void 0||s.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var i;n.readyState===3&&((i=this._opts.cookieJar)===null||i===void 0||i.parseCookies(n.getResponseHeader("set-cookie"))),n.readyState===4&&(n.status===200||n.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof n.status=="number"?n.status:0)},0))},n.send(this._data)}catch(i){this.setTimeoutFn(()=>{this._onError(i)},0);return}typeof document<"u"&&(this._index=ie.requestsCount++,ie.requests[this._index]=this)}_onError(s){this.emitReserved("error",s,this._xhr),this._cleanup(!0)}_cleanup(s){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=Cc,s)try{this._xhr.abort()}catch{}typeof document<"u"&&delete ie.requests[this._index],this._xhr=null}}_onLoad(){const s=this._xhr.responseText;s!==null&&(this.emitReserved("data",s),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}ie.requestsCount=0;ie.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Nr);else if(typeof addEventListener=="function"){const e="onpagehide"in ee?"pagehide":"unload";addEventListener(e,Nr,!1)}}function Nr(){for(let e in ie.requests)ie.requests.hasOwnProperty(e)&&ie.requests[e].abort()}const Rc=(function(){const e=Qn({xdomain:!1});return e&&e.responseType!==null})();class kc extends Ec{constructor(s){super(s);const r=s&&s.forceBase64;this.supportsBinary=Rc&&!r}request(s={}){return Object.assign(s,{xd:this.xd},this.opts),new ie(Qn,this.uri(),s)}}function Qn(e){const s=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!s||Sc))return new XMLHttpRequest}catch{}if(!s)try{return new ee[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Jn=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class Tc extends Ps{get name(){return"websocket"}doOpen(){const s=this.uri(),r=this.opts.protocols,n=Jn?{}:Kn(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(s,r,n)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=s=>this.onClose({description:"websocket connection closed",context:s}),this.ws.onmessage=s=>this.onData(s.data),this.ws.onerror=s=>this.onError("websocket error",s)}write(s){this.writable=!1;for(let r=0;r<s.length;r++){const n=s[r],i=r===s.length-1;Os(n,this.supportsBinary,a=>{try{this.doWrite(n,a)}catch{}i&&It(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const s=this.opts.secure?"wss":"ws",r=this.query||{};return this.opts.timestampRequests&&(r[this.opts.timestampParam]=Hn()),this.supportsBinary||(r.b64=1),this.createUri(s,r)}}const es=ee.WebSocket||ee.MozWebSocket;class Ac extends Tc{createSocket(s,r,n){return Jn?new es(s,r,n):r?new es(s,r):new es(s)}doWrite(s,r){this.ws.send(r)}}class Oc extends Ps{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(s){return this.emitReserved("error",s)}this._transport.closed.then(()=>{this.onClose()}).catch(s=>{this.onError("webtransport error",s)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(s=>{const r=hc(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=s.readable.pipeThrough(r).getReader(),i=uc();i.readable.pipeTo(s.writable),this._writer=i.writable.getWriter();const a=()=>{n.read().then(({done:o,value:h})=>{o||(this.onPacket(h),a())}).catch(o=>{})};a();const l={type:"open"};this.query.sid&&(l.data=`{"sid":"${this.query.sid}"}`),this._writer.write(l).then(()=>this.onOpen())})})}write(s){this.writable=!1;for(let r=0;r<s.length;r++){const n=s[r],i=r===s.length-1;this._writer.write(n).then(()=>{i&&It(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var s;(s=this._transport)===null||s===void 0||s.close()}}const _c={websocket:Ac,webtransport:Oc,polling:kc},Pc=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Dc=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function fs(e){if(e.length>8e3)throw"URI too long";const s=e,r=e.indexOf("["),n=e.indexOf("]");r!=-1&&n!=-1&&(e=e.substring(0,r)+e.substring(r,n).replace(/:/g,";")+e.substring(n,e.length));let i=Pc.exec(e||""),a={},l=14;for(;l--;)a[Dc[l]]=i[l]||"";return r!=-1&&n!=-1&&(a.source=s,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=Ic(a,a.path),a.queryKey=Mc(a,a.query),a}function Ic(e,s){const r=/\/{2,9}/g,n=s.replace(r,"/").split("/");return(s.slice(0,1)=="/"||s.length===0)&&n.splice(0,1),s.slice(-1)=="/"&&n.splice(n.length-1,1),n}function Mc(e,s){const r={};return s.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,i,a){i&&(r[i]=a)}),r}const ps=typeof addEventListener=="function"&&typeof removeEventListener=="function",Nt=[];ps&&addEventListener("offline",()=>{Nt.forEach(e=>e())},!1);class ve extends ${constructor(s,r){if(super(),this.binaryType=fc,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,s&&typeof s=="object"&&(r=s,s=null),s){const n=fs(s);r.hostname=n.host,r.secure=n.protocol==="https"||n.protocol==="wss",r.port=n.port,n.query&&(r.query=n.query)}else r.host&&(r.hostname=fs(r.host).host);Mt(this,r),this.secure=r.secure!=null?r.secure:typeof location<"u"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=r.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},r.transports.forEach(n=>{const i=n.prototype.name;this.transports.push(i),this._transportsByName[i]=n}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},r),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=jc(this.opts.query)),ps&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Nt.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(s){const r=Object.assign({},this.opts.query);r.EIO=Wn,r.transport=s,this.id&&(r.sid=this.id);const n=Object.assign({},this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[s]);return new this._transportsByName[s](n)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const s=this.opts.rememberUpgrade&&ve.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const r=this.createTransport(s);r.open(),this.setTransport(r)}setTransport(s){this.transport&&this.transport.removeAllListeners(),this.transport=s,s.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",r=>this._onClose("transport close",r))}onOpen(){this.readyState="open",ve.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(s){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",s),this.emitReserved("heartbeat"),s.type){case"open":this.onHandshake(JSON.parse(s.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const r=new Error("server error");r.code=s.data,this._onError(r);break;case"message":this.emitReserved("data",s.data),this.emitReserved("message",s.data);break}}onHandshake(s){this.emitReserved("handshake",s),this.id=s.sid,this.transport.query.sid=s.sid,this._pingInterval=s.pingInterval,this._pingTimeout=s.pingTimeout,this._maxPayload=s.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const s=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+s,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},s),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const s=this._getWritablePackets();this.transport.send(s),this._prevBufferLen=s.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let r=1;for(let n=0;n<this.writeBuffer.length;n++){const i=this.writeBuffer[n].data;if(i&&(r+=yc(i)),n>0&&r>this._maxPayload)return this.writeBuffer.slice(0,n);r+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const s=Date.now()>this._pingTimeoutTime;return s&&(this._pingTimeoutTime=0,It(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),s}write(s,r,n){return this._sendPacket("message",s,r,n),this}send(s,r,n){return this._sendPacket("message",s,r,n),this}_sendPacket(s,r,n,i){if(typeof r=="function"&&(i=r,r=void 0),typeof n=="function"&&(i=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;const a={type:s,data:r,options:n};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),i&&this.once("flush",i),this.flush()}close(){const s=()=>{this._onClose("forced close"),this.transport.close()},r=()=>{this.off("upgrade",r),this.off("upgradeError",r),s()},n=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():s()}):this.upgrading?n():s()),this}_onError(s){if(ve.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",s),this._onClose("transport error",s)}_onClose(s,r){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),ps&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const n=Nt.indexOf(this._offlineEventListener);n!==-1&&Nt.splice(n,1)}this.readyState="closed",this.id=null,this.emitReserved("close",s,r),this.writeBuffer=[],this._prevBufferLen=0}}}ve.protocol=Wn;class Fc extends ve{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let s=0;s<this._upgrades.length;s++)this._probe(this._upgrades[s])}_probe(s){let r=this.createTransport(s),n=!1;ve.priorWebsocketSuccess=!1;const i=()=>{n||(r.send([{type:"ping",data:"probe"}]),r.once("packet",m=>{if(!n)if(m.type==="pong"&&m.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",r),!r)return;ve.priorWebsocketSuccess=r.name==="websocket",this.transport.pause(()=>{n||this.readyState!=="closed"&&(u(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{const f=new Error("probe error");f.transport=r.name,this.emitReserved("upgradeError",f)}}))};function a(){n||(n=!0,u(),r.close(),r=null)}const l=m=>{const f=new Error("probe error: "+m);f.transport=r.name,a(),this.emitReserved("upgradeError",f)};function o(){l("transport closed")}function h(){l("socket closed")}function p(m){r&&m.name!==r.name&&a()}const u=()=>{r.removeListener("open",i),r.removeListener("error",l),r.removeListener("close",o),this.off("close",h),this.off("upgrading",p)};r.once("open",i),r.once("error",l),r.once("close",o),this.once("close",h),this.once("upgrading",p),this._upgrades.indexOf("webtransport")!==-1&&s!=="webtransport"?this.setTimeoutFn(()=>{n||r.open()},200):r.open()}onHandshake(s){this._upgrades=this._filterUpgrades(s.upgrades),super.onHandshake(s)}_filterUpgrades(s){const r=[];for(let n=0;n<s.length;n++)~this.transports.indexOf(s[n])&&r.push(s[n]);return r}}let Lc=class extends Fc{constructor(s,r={}){const n=typeof s=="object"?s:r;(!n.transports||n.transports&&typeof n.transports[0]=="string")&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map(i=>_c[i]).filter(i=>!!i)),super(s,n)}};function Uc(e,s="",r){let n=e;r=r||typeof location<"u"&&location,e==null&&(e=r.protocol+"//"+r.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=r.protocol+e:e=r.host+e),/^(https?|wss?):\/\//.test(e)||(typeof r<"u"?e=r.protocol+"//"+e:e="https://"+e),n=fs(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const a=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+a+":"+n.port+s,n.href=n.protocol+"://"+a+(r&&r.port===n.port?"":":"+n.port),n}const Bc=typeof ArrayBuffer=="function",$c=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,Yn=Object.prototype.toString,qc=typeof Blob=="function"||typeof Blob<"u"&&Yn.call(Blob)==="[object BlobConstructor]",Vc=typeof File=="function"||typeof File<"u"&&Yn.call(File)==="[object FileConstructor]";function Ds(e){return Bc&&(e instanceof ArrayBuffer||$c(e))||qc&&e instanceof Blob||Vc&&e instanceof File}function wt(e,s){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let r=0,n=e.length;r<n;r++)if(wt(e[r]))return!0;return!1}if(Ds(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return wt(e.toJSON(),!0);for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&wt(e[r]))return!0;return!1}function zc(e){const s=[],r=e.data,n=e;return n.data=xs(r,s),n.attachments=s.length,{packet:n,buffers:s}}function xs(e,s){if(!e)return e;if(Ds(e)){const r={_placeholder:!0,num:s.length};return s.push(e),r}else if(Array.isArray(e)){const r=new Array(e.length);for(let n=0;n<e.length;n++)r[n]=xs(e[n],s);return r}else if(typeof e=="object"&&!(e instanceof Date)){const r={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=xs(e[n],s));return r}return e}function Wc(e,s){return e.data=gs(e.data,s),delete e.attachments,e}function gs(e,s){if(!e)return e;if(e&&e._placeholder===!0){if(typeof e.num=="number"&&e.num>=0&&e.num<s.length)return s[e.num];throw new Error("illegal attachments")}else if(Array.isArray(e))for(let r=0;r<e.length;r++)e[r]=gs(e[r],s);else if(typeof e=="object")for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=gs(e[r],s));return e}const Kc=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Hc=5;var F;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(F||(F={}));class Gc{constructor(s){this.replacer=s}encode(s){return(s.type===F.EVENT||s.type===F.ACK)&&wt(s)?this.encodeAsBinary({type:s.type===F.EVENT?F.BINARY_EVENT:F.BINARY_ACK,nsp:s.nsp,data:s.data,id:s.id}):[this.encodeAsString(s)]}encodeAsString(s){let r=""+s.type;return(s.type===F.BINARY_EVENT||s.type===F.BINARY_ACK)&&(r+=s.attachments+"-"),s.nsp&&s.nsp!=="/"&&(r+=s.nsp+","),s.id!=null&&(r+=s.id),s.data!=null&&(r+=JSON.stringify(s.data,this.replacer)),r}encodeAsBinary(s){const r=zc(s),n=this.encodeAsString(r.packet),i=r.buffers;return i.unshift(n),i}}function wr(e){return Object.prototype.toString.call(e)==="[object Object]"}class Is extends ${constructor(s){super(),this.reviver=s}add(s){let r;if(typeof s=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");r=this.decodeString(s);const n=r.type===F.BINARY_EVENT;n||r.type===F.BINARY_ACK?(r.type=n?F.EVENT:F.ACK,this.reconstructor=new Qc(r),r.attachments===0&&super.emitReserved("decoded",r)):super.emitReserved("decoded",r)}else if(Ds(s)||s.base64)if(this.reconstructor)r=this.reconstructor.takeBinaryData(s),r&&(this.reconstructor=null,super.emitReserved("decoded",r));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+s)}decodeString(s){let r=0;const n={type:Number(s.charAt(0))};if(F[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===F.BINARY_EVENT||n.type===F.BINARY_ACK){const a=r+1;for(;s.charAt(++r)!=="-"&&r!=s.length;);const l=s.substring(a,r);if(l!=Number(l)||s.charAt(r)!=="-")throw new Error("Illegal attachments");n.attachments=Number(l)}if(s.charAt(r+1)==="/"){const a=r+1;for(;++r&&!(s.charAt(r)===","||r===s.length););n.nsp=s.substring(a,r)}else n.nsp="/";const i=s.charAt(r+1);if(i!==""&&Number(i)==i){const a=r+1;for(;++r;){const l=s.charAt(r);if(l==null||Number(l)!=l){--r;break}if(r===s.length)break}n.id=Number(s.substring(a,r+1))}if(s.charAt(++r)){const a=this.tryParse(s.substr(r));if(Is.isPayloadValid(n.type,a))n.data=a;else throw new Error("invalid payload")}return n}tryParse(s){try{return JSON.parse(s,this.reviver)}catch{return!1}}static isPayloadValid(s,r){switch(s){case F.CONNECT:return wr(r);case F.DISCONNECT:return r===void 0;case F.CONNECT_ERROR:return typeof r=="string"||wr(r);case F.EVENT:case F.BINARY_EVENT:return Array.isArray(r)&&(typeof r[0]=="number"||typeof r[0]=="string"&&Kc.indexOf(r[0])===-1);case F.ACK:case F.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Qc{constructor(s){this.packet=s,this.buffers=[],this.reconPack=s}takeBinaryData(s){if(this.buffers.push(s),this.buffers.length===this.reconPack.attachments){const r=Wc(this.reconPack,this.buffers);return this.finishedReconstruction(),r}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const Jc=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Is,Encoder:Gc,get PacketType(){return F},protocol:Hc},Symbol.toStringTag,{value:"Module"}));function te(e,s,r){return e.on(s,r),function(){e.off(s,r)}}const Yc=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Xn extends ${constructor(s,r,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=s,this.nsp=r,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const s=this.io;this.subs=[te(s,"open",this.onopen.bind(this)),te(s,"packet",this.onpacket.bind(this)),te(s,"error",this.onerror.bind(this)),te(s,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...s){return s.unshift("message"),this.emit.apply(this,s),this}emit(s,...r){var n,i,a;if(Yc.hasOwnProperty(s))throw new Error('"'+s.toString()+'" is a reserved event name');if(r.unshift(s),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(r),this;const l={type:F.EVENT,data:r};if(l.options={},l.options.compress=this.flags.compress!==!1,typeof r[r.length-1]=="function"){const u=this.ids++,m=r.pop();this._registerAckCallback(u,m),l.id=u}const o=(i=(n=this.io.engine)===null||n===void 0?void 0:n.transport)===null||i===void 0?void 0:i.writable,h=this.connected&&!(!((a=this.io.engine)===null||a===void 0)&&a._hasPingExpired());return this.flags.volatile&&!o||(h?(this.notifyOutgoingListeners(l),this.packet(l)):this.sendBuffer.push(l)),this.flags={},this}_registerAckCallback(s,r){var n;const i=(n=this.flags.timeout)!==null&&n!==void 0?n:this._opts.ackTimeout;if(i===void 0){this.acks[s]=r;return}const a=this.io.setTimeoutFn(()=>{delete this.acks[s];for(let o=0;o<this.sendBuffer.length;o++)this.sendBuffer[o].id===s&&this.sendBuffer.splice(o,1);r.call(this,new Error("operation has timed out"))},i),l=(...o)=>{this.io.clearTimeoutFn(a),r.apply(this,o)};l.withError=!0,this.acks[s]=l}emitWithAck(s,...r){return new Promise((n,i)=>{const a=(l,o)=>l?i(l):n(o);a.withError=!0,r.push(a),this.emit(s,...r)})}_addToQueue(s){let r;typeof s[s.length-1]=="function"&&(r=s.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:s,flags:Object.assign({fromQueue:!0},this.flags)};s.push((i,...a)=>n!==this._queue[0]?void 0:(i!==null?n.tryCount>this._opts.retries&&(this._queue.shift(),r&&r(i)):(this._queue.shift(),r&&r(null,...a)),n.pending=!1,this._drainQueue())),this._queue.push(n),this._drainQueue()}_drainQueue(s=!1){if(!this.connected||this._queue.length===0)return;const r=this._queue[0];r.pending&&!s||(r.pending=!0,r.tryCount++,this.flags=r.flags,this.emit.apply(this,r.args))}packet(s){s.nsp=this.nsp,this.io._packet(s)}onopen(){typeof this.auth=="function"?this.auth(s=>{this._sendConnectPacket(s)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(s){this.packet({type:F.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},s):s})}onerror(s){this.connected||this.emitReserved("connect_error",s)}onclose(s,r){this.connected=!1,delete this.id,this.emitReserved("disconnect",s,r),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(s=>{if(!this.sendBuffer.some(n=>String(n.id)===s)){const n=this.acks[s];delete this.acks[s],n.withError&&n.call(this,new Error("socket has been disconnected"))}})}onpacket(s){if(s.nsp===this.nsp)switch(s.type){case F.CONNECT:s.data&&s.data.sid?this.onconnect(s.data.sid,s.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case F.EVENT:case F.BINARY_EVENT:this.onevent(s);break;case F.ACK:case F.BINARY_ACK:this.onack(s);break;case F.DISCONNECT:this.ondisconnect();break;case F.CONNECT_ERROR:this.destroy();const n=new Error(s.data.message);n.data=s.data.data,this.emitReserved("connect_error",n);break}}onevent(s){const r=s.data||[];s.id!=null&&r.push(this.ack(s.id)),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(s){if(this._anyListeners&&this._anyListeners.length){const r=this._anyListeners.slice();for(const n of r)n.apply(this,s)}super.emit.apply(this,s),this._pid&&s.length&&typeof s[s.length-1]=="string"&&(this._lastOffset=s[s.length-1])}ack(s){const r=this;let n=!1;return function(...i){n||(n=!0,r.packet({type:F.ACK,id:s,data:i}))}}onack(s){const r=this.acks[s.id];typeof r=="function"&&(delete this.acks[s.id],r.withError&&s.data.unshift(null),r.apply(this,s.data))}onconnect(s,r){this.id=s,this.recovered=r&&this._pid===r,this._pid=r,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(s=>this.emitEvent(s)),this.receiveBuffer=[],this.sendBuffer.forEach(s=>{this.notifyOutgoingListeners(s),this.packet(s)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(s=>s()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:F.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(s){return this.flags.compress=s,this}get volatile(){return this.flags.volatile=!0,this}timeout(s){return this.flags.timeout=s,this}onAny(s){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(s),this}prependAny(s){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(s),this}offAny(s){if(!this._anyListeners)return this;if(s){const r=this._anyListeners;for(let n=0;n<r.length;n++)if(s===r[n])return r.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(s){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(s),this}prependAnyOutgoing(s){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(s),this}offAnyOutgoing(s){if(!this._anyOutgoingListeners)return this;if(s){const r=this._anyOutgoingListeners;for(let n=0;n<r.length;n++)if(s===r[n])return r.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(s){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const r=this._anyOutgoingListeners.slice();for(const n of r)n.apply(this,s.data)}}}function Le(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Le.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var s=Math.random(),r=Math.floor(s*this.jitter*e);e=(Math.floor(s*10)&1)==0?e-r:e+r}return Math.min(e,this.max)|0};Le.prototype.reset=function(){this.attempts=0};Le.prototype.setMin=function(e){this.ms=e};Le.prototype.setMax=function(e){this.max=e};Le.prototype.setJitter=function(e){this.jitter=e};class ys extends ${constructor(s,r){var n;super(),this.nsps={},this.subs=[],s&&typeof s=="object"&&(r=s,s=void 0),r=r||{},r.path=r.path||"/socket.io",this.opts=r,Mt(this,r),this.reconnection(r.reconnection!==!1),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor((n=r.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new Le({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(r.timeout==null?2e4:r.timeout),this._readyState="closed",this.uri=s;const i=r.parser||Jc;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=r.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(s){return arguments.length?(this._reconnection=!!s,s||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(s){return s===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=s,this)}reconnectionDelay(s){var r;return s===void 0?this._reconnectionDelay:(this._reconnectionDelay=s,(r=this.backoff)===null||r===void 0||r.setMin(s),this)}randomizationFactor(s){var r;return s===void 0?this._randomizationFactor:(this._randomizationFactor=s,(r=this.backoff)===null||r===void 0||r.setJitter(s),this)}reconnectionDelayMax(s){var r;return s===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=s,(r=this.backoff)===null||r===void 0||r.setMax(s),this)}timeout(s){return arguments.length?(this._timeout=s,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(s){if(~this._readyState.indexOf("open"))return this;this.engine=new Lc(this.uri,this.opts);const r=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const i=te(r,"open",function(){n.onopen(),s&&s()}),a=o=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",o),s?s(o):this.maybeReconnectOnOpen()},l=te(r,"error",a);if(this._timeout!==!1){const o=this._timeout,h=this.setTimeoutFn(()=>{i(),a(new Error("timeout")),r.close()},o);this.opts.autoUnref&&h.unref(),this.subs.push(()=>{this.clearTimeoutFn(h)})}return this.subs.push(i),this.subs.push(l),this}connect(s){return this.open(s)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const s=this.engine;this.subs.push(te(s,"ping",this.onping.bind(this)),te(s,"data",this.ondata.bind(this)),te(s,"error",this.onerror.bind(this)),te(s,"close",this.onclose.bind(this)),te(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(s){try{this.decoder.add(s)}catch(r){this.onclose("parse error",r)}}ondecoded(s){It(()=>{this.emitReserved("packet",s)},this.setTimeoutFn)}onerror(s){this.emitReserved("error",s)}socket(s,r){let n=this.nsps[s];return n?this._autoConnect&&!n.active&&n.connect():(n=new Xn(this,s,r),this.nsps[s]=n),n}_destroy(s){const r=Object.keys(this.nsps);for(const n of r)if(this.nsps[n].active)return;this._close()}_packet(s){const r=this.encoder.encode(s);for(let n=0;n<r.length;n++)this.engine.write(r[n],s.options)}cleanup(){this.subs.forEach(s=>s()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(s,r){var n;this.cleanup(),(n=this.engine)===null||n===void 0||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",s,r),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const s=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const r=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{s.skipReconnect||(this.emitReserved("reconnect_attempt",s.backoff.attempts),!s.skipReconnect&&s.open(i=>{i?(s._reconnecting=!1,s.reconnect(),this.emitReserved("reconnect_error",i)):s.onreconnect()}))},r);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const s=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",s)}}const qe={};function De(e,s){typeof e=="object"&&(s=e,e=void 0),s=s||{};const r=Uc(e,s.path||"/socket.io"),n=r.source,i=r.id,a=r.path,l=qe[i]&&a in qe[i].nsps,o=s.forceNew||s["force new connection"]||s.multiplex===!1||l;let h;return o?h=new ys(n,s):(qe[i]||(qe[i]=new ys(n,s)),h=qe[i]),r.query&&!s.query&&(s.query=r.queryKey),h.socket(r.path,s)}Object.assign(De,{Manager:ys,Socket:Xn,io:De,connect:De});function Xc(){const[e,s]=c.useState([]),[r,n]=c.useState({cpu:0,memory:0,database:0,activeConnections:0,requestsPerSecond:0,responseTime:0,uptime:0,errors:0}),[i,a]=c.useState({activeUsers:0,onlineDrivers:0,activeOrders:0,completedOrdersToday:0,totalRevenue:0,systemHealth:"HEALTHY"}),[l,o]=c.useState(null),[h,p]=c.useState(null),[u,m]=c.useState(!1),[f,R]=c.useState(!0),[k,x]=c.useState("roadmap"),[g,S]=c.useState({status:"",showBattery:!0,showSignal:!0}),C=c.useRef(null);c.useEffect(()=>{const v=De("ws://localhost:5000",{path:"/ws",transports:["websocket"]});return v.on("connect",()=>{console.log("Monitoring dashboard connected"),m(!0),v.emit("join_admin_room","monitoring")}),v.on("disconnect",()=>{m(!1)}),v.on("driver_location_update",D=>{s(w=>{const _=w.findIndex(j=>j.driverId===D.driverId),b={driverId:D.driverId,driverName:D.driverName||`Driver ${D.driverId}`,latitude:D.latitude,longitude:D.longitude,status:D.status,lastUpdate:new Date(D.timestamp).toISOString(),orderId:D.orderId,batteryLevel:D.batteryLevel,signalStrength:D.signalStrength};if(_>=0){const j=[...w];return j[_]=b,j}else return[b,...w]})}),v.on("system_metric_update",D=>{n(D.metrics)}),p(v),()=>{v.disconnect()}},[]);const E=async()=>{try{R(!0);const[v,D,w]=await Promise.all([fetch("/api/admin/monitoring/drivers",{headers:{Authorization:`Bearer ${localStorage.getItem("adminToken")}`,"Content-Type":"application/json"}}),fetch("/api/admin/monitoring/system-metrics",{headers:{Authorization:`Bearer ${localStorage.getItem("adminToken")}`,"Content-Type":"application/json"}}),fetch("/api/admin/monitoring/live-metrics",{headers:{Authorization:`Bearer ${localStorage.getItem("adminToken")}`,"Content-Type":"application/json"}})]);if(v.ok){const _=await v.json();s(_.data)}if(D.ok){const _=await D.json();n(_.data)}if(w.ok){const _=await w.json();a(_.data)}}catch(v){console.error("Failed to fetch monitoring data:",v)}finally{R(!1)}};c.useEffect(()=>{E();const v=setInterval(E,3e4);return()=>clearInterval(v)},[]);const N=v=>{switch(v){case"ONLINE":return"bg-green-500";case"BUSY":return"bg-blue-500";case"IDLE":return"bg-yellow-500";case"OFFLINE":return"bg-gray-500";default:return"bg-gray-500"}},y=v=>{switch(v){case"HEALTHY":return"text-green-600 bg-green-100";case"WARNING":return"text-yellow-600 bg-yellow-100";case"CRITICAL":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},P=e.filter(v=>!(g.status&&v.status!==g.status)),A=v=>{const D=Math.floor(v/86400),w=Math.floor(v%86400/3600),_=Math.floor(v%3600/60);return`${D}d ${w}h ${_}m`};return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[t.jsx(we,{className:"h-6 w-6 mr-2 text-blue-600"}),"Real-time Monitoring"]}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Live system monitoring and driver tracking"})]}),t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:`h-2 w-2 rounded-full ${u?"bg-green-500":"bg-red-500"}`}),t.jsx("span",{className:"text-sm text-gray-500",children:u?"Connected":"Disconnected"})]}),t.jsxs("button",{onClick:E,disabled:f,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50",children:[t.jsx(je,{className:`h-4 w-4 mr-2 ${f?"animate-spin":""}`}),"Refresh"]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[t.jsx("div",{className:"bg-white rounded-lg shadow p-4 border-l-4 border-blue-500",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx(st,{className:"h-8 w-8 text-blue-500"}),t.jsxs("div",{className:"ml-3",children:[t.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Active Users"}),t.jsx("p",{className:"text-lg font-semibold text-gray-900",children:i.activeUsers.toLocaleString()})]})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4 border-l-4 border-green-500",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx(Bt,{className:"h-8 w-8 text-green-500"}),t.jsxs("div",{className:"ml-3",children:[t.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Online Drivers"}),t.jsx("p",{className:"text-lg font-semibold text-gray-900",children:i.onlineDrivers.toLocaleString()})]})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4 border-l-4 border-orange-500",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx(we,{className:"h-8 w-8 text-orange-500"}),t.jsxs("div",{className:"ml-3",children:[t.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Active Orders"}),t.jsx("p",{className:"text-lg font-semibold text-gray-900",children:i.activeOrders.toLocaleString()})]})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4 border-l-4 border-purple-500",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx(Tt,{className:"h-8 w-8 text-purple-500"}),t.jsxs("div",{className:"ml-3",children:[t.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Completed Today"}),t.jsx("p",{className:"text-lg font-semibold text-gray-900",children:i.completedOrdersToday.toLocaleString()})]})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4 border-l-4 border-indigo-500",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"text-indigo-500 text-2xl font-bold",children:""}),t.jsxs("div",{className:"ml-3",children:[t.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Revenue Today"}),t.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:["",i.totalRevenue.toLocaleString()]})]})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4 border-l-4 border-red-500",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx(ue,{className:"h-8 w-8 text-red-500"}),t.jsxs("div",{className:"ml-3",children:[t.jsx("p",{className:"text-sm font-medium text-gray-500",children:"System Health"}),t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${y(i.systemHealth)}`,children:i.systemHealth})]})]})})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white rounded-lg shadow",children:[t.jsx("div",{className:"p-6 border-b border-gray-200",children:t.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[t.jsx(ss,{className:"h-5 w-5 mr-2 text-gray-500"}),"System Metrics"]})}),t.jsxs("div",{className:"p-6 space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx(_r,{className:"h-4 w-4 text-blue-500 mr-2"}),t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"CPU Usage"})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:`h-2 rounded-full ${r.cpu>80?"bg-red-500":r.cpu>60?"bg-yellow-500":"bg-green-500"}`,style:{width:`${r.cpu}%`}})}),t.jsxs("span",{className:"text-sm text-gray-600",children:[r.cpu,"%"]})]})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx(rs,{className:"h-4 w-4 text-green-500 mr-2"}),t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Memory Usage"})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:`h-2 rounded-full ${r.memory>80?"bg-red-500":r.memory>60?"bg-yellow-500":"bg-green-500"}`,style:{width:`${r.memory}%`}})}),t.jsxs("span",{className:"text-sm text-gray-600",children:[r.memory,"%"]})]})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx(Ai,{className:"h-4 w-4 text-purple-500 mr-2"}),t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Database"})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:`h-2 rounded-full ${r.database>80?"bg-red-500":r.database>60?"bg-yellow-500":"bg-green-500"}`,style:{width:`${r.database}%`}})}),t.jsxs("span",{className:"text-sm text-gray-600",children:[r.database,"%"]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-4",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Active Connections"}),t.jsx("p",{className:"text-lg font-semibold text-gray-900",children:r.activeConnections})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Requests/sec"}),t.jsx("p",{className:"text-lg font-semibold text-gray-900",children:r.requestsPerSecond})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Response Time"}),t.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:[r.responseTime,"ms"]})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Uptime"}),t.jsx("p",{className:"text-lg font-semibold text-gray-900",children:A(r.uptime)})]})]})]})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow",children:[t.jsx("div",{className:"p-6 border-b border-gray-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[t.jsx(Bt,{className:"h-5 w-5 mr-2 text-gray-500"}),"Driver Status Overview"]}),t.jsxs("select",{value:g.status,onChange:v=>S(D=>({...D,status:v.target.value})),className:"text-sm border border-gray-300 rounded-md px-3 py-1",children:[t.jsx("option",{value:"",children:"All Status"}),t.jsx("option",{value:"ONLINE",children:"Online"}),t.jsx("option",{value:"BUSY",children:"Busy"}),t.jsx("option",{value:"IDLE",children:"Idle"}),t.jsx("option",{value:"OFFLINE",children:"Offline"})]})]})}),t.jsx("div",{className:"p-6",children:t.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{className:"flex items-center justify-center mb-2",children:[t.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full mr-2"}),t.jsx("span",{className:"text-sm text-gray-600",children:"Online"})]}),t.jsx("p",{className:"text-xl font-bold text-gray-900",children:e.filter(v=>v.status==="ONLINE").length})]}),t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{className:"flex items-center justify-center mb-2",children:[t.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full mr-2"}),t.jsx("span",{className:"text-sm text-gray-600",children:"Busy"})]}),t.jsx("p",{className:"text-xl font-bold text-gray-900",children:e.filter(v=>v.status==="BUSY").length})]}),t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{className:"flex items-center justify-center mb-2",children:[t.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full mr-2"}),t.jsx("span",{className:"text-sm text-gray-600",children:"Idle"})]}),t.jsx("p",{className:"text-xl font-bold text-gray-900",children:e.filter(v=>v.status==="IDLE").length})]}),t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{className:"flex items-center justify-center mb-2",children:[t.jsx("div",{className:"w-3 h-3 bg-gray-500 rounded-full mr-2"}),t.jsx("span",{className:"text-sm text-gray-600",children:"Offline"})]}),t.jsx("p",{className:"text-xl font-bold text-gray-900",children:e.filter(v=>v.status==="OFFLINE").length})]})]})})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsx("div",{className:"lg:col-span-2",children:t.jsxs("div",{className:"bg-white rounded-lg shadow",children:[t.jsx("div",{className:"p-6 border-b border-gray-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[t.jsx(qs,{className:"h-5 w-5 mr-2 text-red-500"}),"Driver Location Tracking"]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("button",{onClick:()=>x(k==="roadmap"?"satellite":"roadmap"),className:"px-3 py-1 text-sm border border-gray-300 rounded-md hover:bg-gray-50",children:k==="roadmap"?"Satellite":"Roadmap"}),t.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600",children:t.jsx(Oi,{className:"h-4 w-4"})})]})]})}),t.jsx("div",{className:"relative h-96",children:t.jsxs("div",{ref:C,className:"w-full h-full bg-gray-100 rounded-b-lg flex items-center justify-center",children:[t.jsxs("div",{className:"text-center",children:[t.jsx(qs,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),t.jsxs("p",{className:"text-gray-500",children:["Interactive map showing ",P.length," drivers"]}),t.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Map integration would show real locations here"})]}),t.jsx("div",{className:"absolute inset-0 pointer-events-none",children:P.slice(0,5).map((v,D)=>t.jsx("div",{className:"absolute",style:{left:`${20+D*15}%`,top:`${30+D*10}%`},children:t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:`w-4 h-4 rounded-full border-2 border-white shadow-md ${N(v.status)}`}),t.jsx("div",{className:"absolute -top-8 left-1/2 transform -translate-x-1/2 bg-black text-white text-xs px-2 py-1 rounded opacity-90 whitespace-nowrap",children:v.driverName})]})},v.driverId))})]})})]})}),t.jsx("div",{className:"lg:col-span-1",children:t.jsxs("div",{className:"bg-white rounded-lg shadow",children:[t.jsx("div",{className:"p-6 border-b border-gray-200",children:t.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[t.jsx(_i,{className:"h-5 w-5 mr-2 text-blue-500"}),"Active Drivers (",P.length,")"]})}),t.jsx("div",{className:"max-h-96 overflow-y-auto",children:P.length===0?t.jsxs("div",{className:"p-6 text-center text-gray-500",children:[t.jsx(Bt,{className:"h-8 w-8 mx-auto mb-2 text-gray-400"}),t.jsx("p",{children:"No drivers found"})]}):t.jsx("ul",{className:"divide-y divide-gray-200",children:P.map(v=>t.jsxs("li",{className:`p-4 cursor-pointer hover:bg-gray-50 ${l?.driverId===v.driverId?"bg-blue-50":""}`,onClick:()=>o(v),children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:`w-3 h-3 rounded-full ${N(v.status)}`}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-900",children:v.driverName}),t.jsxs("p",{className:"text-xs text-gray-500",children:["ID: ",v.driverId]})]})]}),t.jsx("div",{className:"text-right",children:t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${v.status==="ONLINE"?"bg-green-100 text-green-800":v.status==="BUSY"?"bg-blue-100 text-blue-800":v.status==="IDLE"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:v.status})})]}),g.showBattery&&v.batteryLevel&&t.jsxs("div",{className:"mt-2 flex items-center space-x-2",children:[t.jsx(Pi,{className:"h-3 w-3 text-gray-400"}),t.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-1",children:t.jsx("div",{className:`h-1 rounded-full ${v.batteryLevel>50?"bg-green-500":v.batteryLevel>20?"bg-yellow-500":"bg-red-500"}`,style:{width:`${v.batteryLevel}%`}})}),t.jsxs("span",{className:"text-xs text-gray-500",children:[v.batteryLevel,"%"]})]}),g.showSignal&&v.signalStrength&&t.jsxs("div",{className:"mt-1 flex items-center space-x-2",children:[t.jsx(Di,{className:"h-3 w-3 text-gray-400"}),t.jsx("div",{className:"flex space-x-1",children:[1,2,3,4].map(D=>t.jsx("div",{className:`w-1 h-2 rounded-sm ${D<=(v.signalStrength||0)/25?"bg-green-500":"bg-gray-300"}`},D))}),t.jsxs("span",{className:"text-xs text-gray-500",children:[v.signalStrength,"%"]})]}),t.jsxs("div",{className:"mt-2 flex items-center text-xs text-gray-500",children:[t.jsx(Ne,{className:"h-3 w-3 mr-1"}),"Last update: ",new Date(v.lastUpdate).toLocaleTimeString()]})]},v.driverId))})})]})})]})]})}function Zc(){const[e,s]=c.useState([]),[r,n]=c.useState([]),[i,a]=c.useState({totalAlerts:0,criticalAlerts:0,resolvedToday:0,falsePositiveRate:0,avgResolutionTime:0,blockedTransactions:0,flaggedAccounts:0,totalRiskReduction:0}),[l,o]=c.useState(!0),[h,p]=c.useState(null),[u,m]=c.useState([]),[f,R]=c.useState({severity:"",status:"",type:"",search:"",startDate:"",endDate:""}),[k,x]=c.useState(!1),[g,S]=c.useState(null);c.useEffect(()=>{const w=De("ws://localhost:5000",{path:"/ws",transports:["websocket"]});return w.on("connect",()=>{console.log("Fraud dashboard connected"),w.emit("join_admin_room","fraud")}),w.on("fraud_alert",_=>{_.type==="fraud_alert"&&(s(b=>[_.alert,...b]),E())}),w.on("suspicious_activity",_=>{_.type==="suspicious_activity"&&n(b=>[_.activity,...b.slice(0,49)])}),w.on("fraud_alert_updated",_=>{_.type==="fraud_alert_updated"&&C()}),()=>w.disconnect()},[]);const C=async()=>{try{o(!0);const w=new URLSearchParams({...Object.fromEntries(Object.entries(f).filter(([M,H])=>H))}),[_,b,j]=await Promise.all([fetch(`/api/admin/fraud/alerts?${w}`,{headers:{Authorization:`Bearer ${localStorage.getItem("adminToken")}`,"Content-Type":"application/json"}}),fetch("/api/admin/fraud/activities",{headers:{Authorization:`Bearer ${localStorage.getItem("adminToken")}`,"Content-Type":"application/json"}}),fetch("/api/admin/fraud/stats",{headers:{Authorization:`Bearer ${localStorage.getItem("adminToken")}`,"Content-Type":"application/json"}})]);if(!_.ok||!b.ok||!j.ok)throw new Error("Failed to fetch fraud data");const[d,T,O]=await Promise.all([_.json(),b.json(),j.json()]);s(d.data),n(T.data),a(O.data),p(null)}catch(w){p(w instanceof Error?w.message:"Failed to fetch fraud data")}finally{o(!1)}},E=async()=>{try{const w=await fetch("/api/admin/fraud/stats",{headers:{Authorization:`Bearer ${localStorage.getItem("adminToken")}`,"Content-Type":"application/json"}});if(w.ok){const _=await w.json();a(_.data)}}catch(w){console.error("Failed to fetch stats:",w)}};c.useEffect(()=>{C()},[f]);const N=async(w,_,b)=>{try{if(S(`${_}-${w}`),!(await fetch(`/api/admin/fraud/alerts/${w}/${_}`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("adminToken")}`,"Content-Type":"application/json"},body:JSON.stringify({reason:b})})).ok)throw new Error(`Failed to ${_} alert`);C(),console.log(`Alert ${_}ed successfully`)}catch(j){console.error(`Failed to ${_} alert:`,j)}finally{S(null)}},y=async(w,_)=>{if(u.length!==0)try{if(S(`bulk-${w}`),!(await fetch("/api/admin/fraud/alerts/bulk-action",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("adminToken")}`,"Content-Type":"application/json"},body:JSON.stringify({alertIds:u,action:w,reason:_})})).ok)throw new Error(`Failed to ${w} alerts`);m([]),C(),console.log(`Bulk ${w} completed successfully`)}catch(b){console.error(`Failed to ${w} alerts:`,b)}finally{S(null)}},P=async(w,_,b)=>{try{if(!(await fetch(`/api/admin/fraud/users/${w}/${_}`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("adminToken")}`,"Content-Type":"application/json"},body:JSON.stringify({reason:b})})).ok)throw new Error(`Failed to ${_} user`);C(),console.log(`User ${_}ged successfully`)}catch(j){console.error(`Failed to ${_} user:`,j)}},A=w=>{switch(w){case"CRITICAL":return"bg-red-100 text-red-800 border-red-200";case"HIGH":return"bg-orange-100 text-orange-800 border-orange-200";case"MEDIUM":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"LOW":return"bg-blue-100 text-blue-800 border-blue-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},v=w=>{switch(w){case"ACTIVE":return"bg-red-100 text-red-800";case"INVESTIGATING":return"bg-blue-100 text-blue-800";case"RESOLVED":return"bg-green-100 text-green-800";case"FALSE_POSITIVE":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},D=w=>new Date(w).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[t.jsx(se,{className:"h-6 w-6 mr-2 text-red-600"}),"Fraud Detection Dashboard"]}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Monitor and manage suspicious activities in real-time"})]}),t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsxs("button",{onClick:()=>x(!k),className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[t.jsx(Or,{className:"h-4 w-4 mr-2"}),"Filters"]}),t.jsxs("button",{onClick:C,disabled:l,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 disabled:opacity-50",children:[t.jsx(je,{className:`h-4 w-4 mr-2 ${l?"animate-spin":""}`}),"Refresh"]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[t.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg border-l-4 border-red-500",children:t.jsx("div",{className:"p-5",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx(ue,{className:"h-6 w-6 text-red-400"})}),t.jsx("div",{className:"ml-5 w-0 flex-1",children:t.jsxs("dl",{children:[t.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Active Alerts"}),t.jsx("dd",{className:"text-lg font-medium text-gray-900",children:i.totalAlerts.toLocaleString()})]})})]})})}),t.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg border-l-4 border-orange-500",children:t.jsx("div",{className:"p-5",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx(Tt,{className:"h-6 w-6 text-orange-400"})}),t.jsx("div",{className:"ml-5 w-0 flex-1",children:t.jsxs("dl",{children:[t.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Critical Alerts"}),t.jsx("dd",{className:"text-lg font-medium text-gray-900",children:i.criticalAlerts.toLocaleString()})]})})]})})}),t.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg border-l-4 border-green-500",children:t.jsx("div",{className:"p-5",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx(ge,{className:"h-6 w-6 text-green-400"})}),t.jsx("div",{className:"ml-5 w-0 flex-1",children:t.jsxs("dl",{children:[t.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Resolved Today"}),t.jsx("dd",{className:"text-lg font-medium text-gray-900",children:i.resolvedToday.toLocaleString()})]})})]})})}),t.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg border-l-4 border-blue-500",children:t.jsx("div",{className:"p-5",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx(st,{className:"h-6 w-6 text-blue-400"})}),t.jsx("div",{className:"ml-5 w-0 flex-1",children:t.jsxs("dl",{children:[t.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Flagged Accounts"}),t.jsx("dd",{className:"text-lg font-medium text-gray-900",children:i.flaggedAccounts.toLocaleString()})]})})]})})})]}),k&&t.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"text",placeholder:"Search alerts...",value:f.search,onChange:w=>R(_=>({..._,search:w.target.value})),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-red-500 focus:border-red-500 sm:text-sm"}),t.jsx(At,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Severity"}),t.jsxs("select",{value:f.severity,onChange:w=>R(_=>({..._,severity:w.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-red-500 focus:border-red-500 sm:text-sm",children:[t.jsx("option",{value:"",children:"All Severities"}),t.jsx("option",{value:"CRITICAL",children:"Critical"}),t.jsx("option",{value:"HIGH",children:"High"}),t.jsx("option",{value:"MEDIUM",children:"Medium"}),t.jsx("option",{value:"LOW",children:"Low"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),t.jsxs("select",{value:f.status,onChange:w=>R(_=>({..._,status:w.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-red-500 focus:border-red-500 sm:text-sm",children:[t.jsx("option",{value:"",children:"All Statuses"}),t.jsx("option",{value:"ACTIVE",children:"Active"}),t.jsx("option",{value:"INVESTIGATING",children:"Investigating"}),t.jsx("option",{value:"RESOLVED",children:"Resolved"}),t.jsx("option",{value:"FALSE_POSITIVE",children:"False Positive"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),t.jsxs("select",{value:f.type,onChange:w=>R(_=>({..._,type:w.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-red-500 focus:border-red-500 sm:text-sm",children:[t.jsx("option",{value:"",children:"All Types"}),t.jsx("option",{value:"SUSPICIOUS_LOGIN",children:"Suspicious Login"}),t.jsx("option",{value:"UNUSUAL_TRANSACTION",children:"Unusual Transaction"}),t.jsx("option",{value:"VELOCITY_CHECK",children:"Velocity Check"}),t.jsx("option",{value:"DEVICE_MISMATCH",children:"Device Mismatch"}),t.jsx("option",{value:"LOCATION_ANOMALY",children:"Location Anomaly"}),t.jsx("option",{value:"PATTERN_MATCHING",children:"Pattern Matching"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),t.jsx("input",{type:"date",value:f.startDate,onChange:w=>R(_=>({..._,startDate:w.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-red-500 focus:border-red-500 sm:text-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),t.jsx("input",{type:"date",value:f.endDate,onChange:w=>R(_=>({..._,endDate:w.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-red-500 focus:border-red-500 sm:text-sm"})]})]}),t.jsx("div",{className:"mt-4",children:t.jsx("button",{onClick:()=>R({severity:"",status:"",type:"",search:"",startDate:"",endDate:""}),className:"text-sm text-gray-500 hover:text-gray-700",children:"Clear all filters"})})]}),u.length>0&&t.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{className:"flex items-center",children:t.jsxs("span",{className:"text-sm font-medium text-red-800",children:[u.length," alert(s) selected"]})}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsxs("button",{onClick:()=>y("investigate"),disabled:!!g,className:"inline-flex items-center px-3 py-1.5 border border-transparent text-sm font-medium rounded text-blue-700 bg-blue-100 hover:bg-blue-200 disabled:opacity-50",children:[t.jsx(xt,{className:"h-4 w-4 mr-1"}),"Investigate"]}),t.jsxs("button",{onClick:()=>y("resolve","Bulk resolution"),disabled:!!g,className:"inline-flex items-center px-3 py-1.5 border border-transparent text-sm font-medium rounded text-green-700 bg-green-100 hover:bg-green-200 disabled:opacity-50",children:[t.jsx(ge,{className:"h-4 w-4 mr-1"}),"Resolve"]}),t.jsxs("button",{onClick:()=>y("false_positive","Marked as false positive"),disabled:!!g,className:"inline-flex items-center px-3 py-1.5 border border-transparent text-sm font-medium rounded text-gray-700 bg-gray-100 hover:bg-gray-200 disabled:opacity-50",children:[t.jsx(We,{className:"h-4 w-4 mr-1"}),"False Positive"]}),t.jsx("button",{onClick:()=>m([]),className:"text-sm text-gray-500 hover:text-gray-700",children:"Clear selection"})]})]})}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsx("div",{className:"lg:col-span-2",children:t.jsxs("div",{className:"bg-white shadow rounded-lg",children:[t.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:t.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Fraud Alerts"})}),t.jsx("div",{className:"max-h-96 overflow-y-auto",children:l?t.jsx("div",{className:"flex items-center justify-center h-32",children:t.jsx(je,{className:"h-6 w-6 animate-spin text-gray-400"})}):e.length===0?t.jsx("div",{className:"flex items-center justify-center h-32",children:t.jsxs("div",{className:"text-center",children:[t.jsx(se,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),t.jsx("p",{className:"text-gray-500",children:"No fraud alerts found"})]})}):t.jsx("ul",{className:"divide-y divide-gray-200",children:e.map(w=>t.jsx("li",{className:"px-6 py-4",children:t.jsxs("div",{className:"flex items-start space-x-3",children:[t.jsx("input",{type:"checkbox",checked:u.includes(w.id),onChange:_=>{_.target.checked?m(b=>[...b,w.id]):m(b=>b.filter(j=>j!==w.id))},className:"h-4 w-4 text-red-600 focus:ring-red-500 border-gray-300 rounded mt-1"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${A(w.severity)}`,children:w.severity}),t.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${v(w.status)}`,children:w.status}),t.jsxs("span",{className:"text-xs text-gray-500",children:["Risk Score: ",w.riskScore,"%"]})]}),t.jsxs("div",{className:"flex items-center space-x-1",children:[t.jsx("button",{onClick:()=>N(w.id,"investigate"),disabled:g===`investigate-${w.id}`,className:"p-1 text-blue-400 hover:text-blue-600 disabled:opacity-50",title:"Investigate",children:t.jsx(tt,{className:"h-4 w-4"})}),t.jsx("button",{onClick:()=>P(w.userId,"flag","Flagged due to fraud alert"),className:"p-1 text-orange-400 hover:text-orange-600",title:"Flag Account",children:t.jsx(Ii,{className:"h-4 w-4"})}),t.jsx("button",{onClick:()=>N(w.id,"resolve","Manual resolution"),disabled:g===`resolve-${w.id}`,className:"p-1 text-green-400 hover:text-green-600 disabled:opacity-50",title:"Resolve",children:t.jsx(ge,{className:"h-4 w-4"})}),t.jsx("button",{className:"p-1 text-gray-400 hover:text-gray-600",children:t.jsx(bs,{className:"h-4 w-4"})})]})]}),t.jsxs("div",{className:"mt-2",children:[t.jsx("p",{className:"text-sm font-medium text-gray-900",children:w.title}),t.jsx("p",{className:"text-sm text-gray-600",children:w.description})]}),t.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs text-gray-500",children:[t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsxs("span",{children:["User: ",w.user.fullName]}),t.jsxs("span",{children:["(",w.user.userId,")"]}),t.jsx("span",{children:D(w.detectedAt)})]}),w.metadata.relatedAlerts&&t.jsxs("span",{className:"text-red-600 font-medium",children:["+",w.metadata.relatedAlerts," related"]})]})]})]})},w.id))})})]})}),t.jsx("div",{className:"lg:col-span-1",children:t.jsxs("div",{className:"bg-white shadow rounded-lg",children:[t.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:t.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[t.jsx(we,{className:"h-5 w-5 mr-2 text-green-500"}),"Live Activity Monitor"]})}),t.jsx("div",{className:"max-h-96 overflow-y-auto",children:r.length===0?t.jsx("div",{className:"flex items-center justify-center h-32",children:t.jsxs("div",{className:"text-center",children:[t.jsx(we,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),t.jsx("p",{className:"text-gray-500 text-sm",children:"No recent activities"})]})}):t.jsx("ul",{className:"divide-y divide-gray-200",children:r.map(w=>t.jsx("li",{className:"px-6 py-3",children:t.jsxs("div",{className:"flex items-start space-x-3",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx("div",{className:"h-2 w-2 bg-red-500 rounded-full mt-2 animate-pulse"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-sm font-medium text-gray-900",children:w.activityType}),t.jsx("p",{className:"text-xs text-gray-600",children:w.description}),t.jsx("div",{className:"mt-1 flex flex-wrap gap-1",children:w.riskIndicators.map((_,b)=>t.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-red-100 text-red-800",children:_},b))}),t.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[t.jsx("div",{children:w.user.fullName}),t.jsx("div",{children:D(w.timestamp)})]})]})]})},w.id))})})]})})]})]})}function ed(e){const s=e+"CollectionProvider",[r,n]=_t(s),[i,a]=r(s,{collectionRef:{current:null},itemMap:new Map}),l=x=>{const{scope:g,children:S}=x,C=de.useRef(null),E=de.useRef(new Map).current;return t.jsx(i,{scope:g,itemMap:E,collectionRef:C,children:S})};l.displayName=s;const o=e+"CollectionSlot",h=Rt(o),p=de.forwardRef((x,g)=>{const{scope:S,children:C}=x,E=a(o,S),N=ae(g,E.collectionRef);return t.jsx(h,{ref:N,children:C})});p.displayName=o;const u=e+"CollectionItemSlot",m="data-radix-collection-item",f=Rt(u),R=de.forwardRef((x,g)=>{const{scope:S,children:C,...E}=x,N=de.useRef(null),y=ae(g,N),P=a(u,S);return de.useEffect(()=>(P.itemMap.set(N,{ref:N,...E}),()=>void P.itemMap.delete(N))),t.jsx(f,{[m]:"",ref:y,children:C})});R.displayName=u;function k(x){const g=a(e+"CollectionConsumer",x);return de.useCallback(()=>{const C=g.collectionRef.current;if(!C)return[];const E=Array.from(C.querySelectorAll(`[${m}]`));return Array.from(g.itemMap.values()).sort((P,A)=>E.indexOf(P.ref.current)-E.indexOf(A.ref.current))},[g.collectionRef,g.itemMap])}return[{Provider:l,Slot:p,ItemSlot:R},k,n]}var td=c.createContext(void 0);function Zn(e){const s=c.useContext(td);return e||s||"ltr"}var ts="rovingFocusGroup.onEntryFocus",sd={bubbles:!1,cancelable:!0},at="RovingFocusGroup",[vs,ei,rd]=ed(at),[nd,ti]=_t(at,[rd]),[id,ad]=nd(at),si=c.forwardRef((e,s)=>t.jsx(vs.Provider,{scope:e.__scopeRovingFocusGroup,children:t.jsx(vs.Slot,{scope:e.__scopeRovingFocusGroup,children:t.jsx(od,{...e,ref:s})})}));si.displayName=at;var od=c.forwardRef((e,s)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:i=!1,dir:a,currentTabStopId:l,defaultCurrentTabStopId:o,onCurrentTabStopIdChange:h,onEntryFocus:p,preventScrollOnEntryFocus:u=!1,...m}=e,f=c.useRef(null),R=ae(s,f),k=Zn(a),[x,g]=Es({prop:l,defaultProp:o??null,onChange:h,caller:at}),[S,C]=c.useState(!1),E=Ie(p),N=ei(r),y=c.useRef(!1),[P,A]=c.useState(0);return c.useEffect(()=>{const v=f.current;if(v)return v.addEventListener(ts,E),()=>v.removeEventListener(ts,E)},[E]),t.jsx(id,{scope:r,orientation:n,dir:k,loop:i,currentTabStopId:x,onItemFocus:c.useCallback(v=>g(v),[g]),onItemShiftTab:c.useCallback(()=>C(!0),[]),onFocusableItemAdd:c.useCallback(()=>A(v=>v+1),[]),onFocusableItemRemove:c.useCallback(()=>A(v=>v-1),[]),children:t.jsx(Q.div,{tabIndex:S||P===0?-1:0,"data-orientation":n,...m,ref:R,style:{outline:"none",...e.style},onMouseDown:K(e.onMouseDown,()=>{y.current=!0}),onFocus:K(e.onFocus,v=>{const D=!y.current;if(v.target===v.currentTarget&&D&&!S){const w=new CustomEvent(ts,sd);if(v.currentTarget.dispatchEvent(w),!w.defaultPrevented){const _=N().filter(O=>O.focusable),b=_.find(O=>O.active),j=_.find(O=>O.id===x),T=[b,j,..._].filter(Boolean).map(O=>O.ref.current);ii(T,u)}}y.current=!1}),onBlur:K(e.onBlur,()=>C(!1))})})}),ri="RovingFocusGroupItem",ni=c.forwardRef((e,s)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:i=!1,tabStopId:a,children:l,...o}=e,h=Qe(),p=a||h,u=ad(ri,r),m=u.currentTabStopId===p,f=ei(r),{onFocusableItemAdd:R,onFocusableItemRemove:k,currentTabStopId:x}=u;return c.useEffect(()=>{if(n)return R(),()=>k()},[n,R,k]),t.jsx(vs.ItemSlot,{scope:r,id:p,focusable:n,active:i,children:t.jsx(Q.span,{tabIndex:m?0:-1,"data-orientation":u.orientation,...o,ref:s,onMouseDown:K(e.onMouseDown,g=>{n?u.onItemFocus(p):g.preventDefault()}),onFocus:K(e.onFocus,()=>u.onItemFocus(p)),onKeyDown:K(e.onKeyDown,g=>{if(g.key==="Tab"&&g.shiftKey){u.onItemShiftTab();return}if(g.target!==g.currentTarget)return;const S=dd(g,u.orientation,u.dir);if(S!==void 0){if(g.metaKey||g.ctrlKey||g.altKey||g.shiftKey)return;g.preventDefault();let E=f().filter(N=>N.focusable).map(N=>N.ref.current);if(S==="last")E.reverse();else if(S==="prev"||S==="next"){S==="prev"&&E.reverse();const N=E.indexOf(g.currentTarget);E=u.loop?ud(E,N+1):E.slice(N+1)}setTimeout(()=>ii(E))}}),children:typeof l=="function"?l({isCurrentTabStop:m,hasTabStop:x!=null}):l})})});ni.displayName=ri;var ld={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function cd(e,s){return s!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function dd(e,s,r){const n=cd(e.key,r);if(!(s==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(s==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return ld[n]}function ii(e,s=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:s}),document.activeElement!==r))return}function ud(e,s){return e.map((r,n)=>e[(s+n)%e.length])}var hd=si,md=ni,Ft="Tabs",[fd,Pd]=_t(Ft,[ti]),ai=ti(),[pd,Ms]=fd(Ft),oi=c.forwardRef((e,s)=>{const{__scopeTabs:r,value:n,onValueChange:i,defaultValue:a,orientation:l="horizontal",dir:o,activationMode:h="automatic",...p}=e,u=Zn(o),[m,f]=Es({prop:n,onChange:i,defaultProp:a??"",caller:Ft});return t.jsx(pd,{scope:r,baseId:Qe(),value:m,onValueChange:f,orientation:l,dir:u,activationMode:h,children:t.jsx(Q.div,{dir:u,"data-orientation":l,...p,ref:s})})});oi.displayName=Ft;var li="TabsList",ci=c.forwardRef((e,s)=>{const{__scopeTabs:r,loop:n=!0,...i}=e,a=Ms(li,r),l=ai(r);return t.jsx(hd,{asChild:!0,...l,orientation:a.orientation,dir:a.dir,loop:n,children:t.jsx(Q.div,{role:"tablist","aria-orientation":a.orientation,...i,ref:s})})});ci.displayName=li;var di="TabsTrigger",ui=c.forwardRef((e,s)=>{const{__scopeTabs:r,value:n,disabled:i=!1,...a}=e,l=Ms(di,r),o=ai(r),h=fi(l.baseId,n),p=pi(l.baseId,n),u=n===l.value;return t.jsx(md,{asChild:!0,...o,focusable:!i,active:u,children:t.jsx(Q.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":p,"data-state":u?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:h,...a,ref:s,onMouseDown:K(e.onMouseDown,m=>{!i&&m.button===0&&m.ctrlKey===!1?l.onValueChange(n):m.preventDefault()}),onKeyDown:K(e.onKeyDown,m=>{[" ","Enter"].includes(m.key)&&l.onValueChange(n)}),onFocus:K(e.onFocus,()=>{const m=l.activationMode!=="manual";!u&&!i&&m&&l.onValueChange(n)})})})});ui.displayName=di;var hi="TabsContent",mi=c.forwardRef((e,s)=>{const{__scopeTabs:r,value:n,forceMount:i,children:a,...l}=e,o=Ms(hi,r),h=fi(o.baseId,n),p=pi(o.baseId,n),u=n===o.value,m=c.useRef(u);return c.useEffect(()=>{const f=requestAnimationFrame(()=>m.current=!1);return()=>cancelAnimationFrame(f)},[]),t.jsx(nt,{present:i||u,children:({present:f})=>t.jsx(Q.div,{"data-state":u?"active":"inactive","data-orientation":o.orientation,role:"tabpanel","aria-labelledby":h,hidden:!f,id:p,tabIndex:0,...l,ref:s,style:{...e.style,animationDuration:m.current?"0s":void 0},children:f&&a})})});mi.displayName=hi;function fi(e,s){return`${e}-trigger-${s}`}function pi(e,s){return`${e}-content-${s}`}var xd=oi,xi=ci,gi=ui,yi=mi;const Fs=xd,Lt=c.forwardRef(({className:e,...s},r)=>t.jsx(xi,{ref:r,className:V("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...s}));Lt.displayName=xi.displayName;const X=c.forwardRef(({className:e,...s},r)=>t.jsx(gi,{ref:r,className:V("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...s}));X.displayName=gi.displayName;const xe=c.forwardRef(({className:e,...s},r)=>t.jsx(yi,{ref:r,className:V("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...s}));xe.displayName=yi.displayName;function gd(){const[e,s]=c.useState(null),[r,n]=c.useState(!1),{user:i}=Aa(),a=c.useRef(0),l=5;return c.useEffect(()=>{if(!i){e&&(e.disconnect(),s(null),n(!1));return}const u=window.location.origin,m=De(u,{transports:["websocket","polling"],autoConnect:!0,reconnection:!0,reconnectionAttempts:l,reconnectionDelay:1e3});return m.on("connect",()=>{console.log("WebSocket connected"),n(!0),a.current=0,m.emit("join_user_room",i.id),i.role==="ADMIN"&&(m.emit("join_admin_room","user_management"),m.emit("join_admin_room","transaction_monitoring"),m.emit("join_admin_room","kyc_verification"))}),m.on("disconnect",()=>{console.log("WebSocket disconnected"),n(!1)}),m.on("connect_error",f=>{console.error("WebSocket connection error:",f),a.current+=1,a.current>=l&&console.error("Max reconnection attempts reached")}),m.on("CONNECTION_ACK",f=>{console.log("Connection acknowledged:",f)}),s(m),()=>{m.disconnect()}},[i]),{socket:e,connected:r,emit:(u,m)=>{e&&r?e.emit(u,m):console.warn("Socket not connected, cannot emit event:",u)},on:(u,m)=>{e&&e.on(u,m)},off:(u,m)=>{e&&(m?e.off(u,m):e.off(u))}}}const yd=()=>{const[e,s]=c.useState([]),[r,n]=c.useState({totalTickets:0,openTickets:0,inProgressTickets:0,resolvedTickets:0,urgentTickets:0,unassignedTickets:0}),[i,a]=c.useState([]),[l,o]=c.useState(!0),[h,p]=c.useState([]),[u,m]=c.useState(null),[f,R]=c.useState(null),[k,x]=c.useState({status:"",priority:"",search:"",page:1}),[g,S]=c.useState(""),[C,E]=c.useState(""),{toast:N}=Ot(),{socket:y}=gd();c.useEffect(()=>{P(),A()},[k]),c.useEffect(()=>{if(y)return y.on("new_support_ticket",d=>{n(T=>({...T,totalTickets:T.totalTickets+1,openTickets:T.openTickets+1})),A(),N({title:"New Support Ticket",description:`New ${d.priority} priority ticket: ${d.subject}`})}),y.on("ticket_response",d=>{u===d.ticketId&&v(d.ticketId),N({title:"New Response",description:`User responded to ticket ${d.ticketNumber}`})}),()=>{y.off("new_support_ticket"),y.off("ticket_response")}},[y,u,N]);const P=async()=>{try{const T=await(await fetch("/api/admin-support/dashboard/stats",{credentials:"include"})).json();T.success&&(n(T.stats),a(T.recentTickets))}catch(d){console.error("Failed to fetch dashboard stats:",d)}},A=async()=>{try{const d=new URLSearchParams;k.status&&d.append("status",k.status),k.priority&&d.append("priority",k.priority),k.search&&d.append("search",k.search),d.append("page",k.page.toString());const O=await(await fetch(`/api/admin-support/tickets?${d}`,{credentials:"include"})).json();O.success?s(O.tickets):N({title:"Error",description:O.message||"Failed to fetch tickets",variant:"destructive"})}catch{N({title:"Error",description:"Failed to fetch support tickets",variant:"destructive"})}finally{o(!1)}},v=async d=>{try{const O=await(await fetch(`/api/admin-support/tickets/${d}`,{credentials:"include"})).json();O.success&&R(O)}catch{N({title:"Error",description:"Failed to fetch ticket details",variant:"destructive"})}},D=async(d,T)=>{try{const M=await(await fetch(`/api/admin-support/tickets/${d}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(T)})).json();M.success?(A(),P(),u===d&&v(d),N({title:"Success",description:"Ticket updated successfully"})):N({title:"Error",description:M.message||"Failed to update ticket",variant:"destructive"})}catch{N({title:"Error",description:"Failed to update ticket",variant:"destructive"})}},w=async d=>{if(d.preventDefault(),!(!u||!g.trim()))try{const O=await(await fetch(`/api/admin-support/tickets/${u}/responses`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({message:g,changeStatus:C||void 0})})).json();O.success?(S(""),E(""),v(u),A(),P(),N({title:"Success",description:"Response added successfully"})):N({title:"Error",description:O.message||"Failed to add response",variant:"destructive"})}catch{N({title:"Error",description:"Failed to add response",variant:"destructive"})}},_=async(d,T)=>{if(h.length===0){N({title:"Warning",description:"Please select tickets to perform bulk actions",variant:"destructive"});return}try{const M=await(await fetch("/api/admin-support/tickets/bulk",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({ticketIds:h,action:d,value:T})})).json();M.success?(p([]),A(),P(),N({title:"Success",description:M.message})):N({title:"Error",description:M.message||"Failed to perform bulk action",variant:"destructive"})}catch{N({title:"Error",description:"Failed to perform bulk action",variant:"destructive"})}},b=d=>{switch(d){case"OPEN":return"bg-blue-100 text-blue-800";case"IN_PROGRESS":return"bg-yellow-100 text-yellow-800";case"RESOLVED":return"bg-green-100 text-green-800";case"CLOSED":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},j=d=>{switch(d){case"LOW":return"bg-gray-100 text-gray-800";case"NORMAL":return"bg-blue-100 text-blue-800";case"HIGH":return"bg-orange-100 text-orange-800";case"URGENT":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return l?t.jsx("div",{className:"flex-1 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"}),t.jsx("p",{className:"mt-4 text-gray-600",children:"Loading support dashboard..."})]})}):t.jsx("div",{className:"flex-1 p-6 bg-gray-50",children:t.jsxs("div",{className:"max-w-7xl mx-auto",children:[t.jsx("div",{className:"flex items-center justify-between mb-6",children:t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Support Management"}),t.jsx("p",{className:"text-gray-600 mt-1",children:"Manage customer support tickets and responses"})]})}),t.jsxs(Fs,{defaultValue:"dashboard",className:"w-full",children:[t.jsxs(Lt,{className:"grid w-full grid-cols-3",children:[t.jsx(X,{value:"dashboard",children:"Dashboard"}),t.jsx(X,{value:"tickets",children:"All Tickets"}),t.jsx(X,{value:"details",children:"Ticket Details"})]}),t.jsxs(xe,{value:"dashboard",className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4",children:[t.jsxs(U,{className:"p-4 rounded-brill",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Total"}),t.jsx("p",{className:"text-2xl font-bold text-blue-600",children:r.totalTickets})]}),t.jsxs(U,{className:"p-4 rounded-brill",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Open"}),t.jsx("p",{className:"text-2xl font-bold text-orange-600",children:r.openTickets})]}),t.jsxs(U,{className:"p-4 rounded-brill",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"In Progress"}),t.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:r.inProgressTickets})]}),t.jsxs(U,{className:"p-4 rounded-brill",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Resolved"}),t.jsx("p",{className:"text-2xl font-bold text-green-600",children:r.resolvedTickets})]}),t.jsxs(U,{className:"p-4 rounded-brill",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Urgent"}),t.jsx("p",{className:"text-2xl font-bold text-red-600",children:r.urgentTickets})]}),t.jsxs(U,{className:"p-4 rounded-brill",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Unassigned"}),t.jsx("p",{className:"text-2xl font-bold text-purple-600",children:r.unassignedTickets})]})]}),t.jsx(U,{className:"rounded-brill",children:t.jsxs("div",{className:"p-6",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Recent Tickets"}),t.jsx("div",{className:"space-y-3",children:i.map(d=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[t.jsxs("div",{children:[t.jsxs("h4",{className:"font-medium text-gray-900",children:["#",d.ticketNumber]}),t.jsx("p",{className:"text-sm text-gray-600",children:d.subject})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(W,{className:j(d.priority),children:d.priority}),t.jsx(W,{className:b(d.status),children:d.status})]})]},d.id))})]})})]}),t.jsxs(xe,{value:"tickets",className:"space-y-6",children:[t.jsx(U,{className:"p-4 rounded-brill",children:t.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[t.jsx(Ze,{placeholder:"Search tickets...",value:k.search,onChange:d=>x({...k,search:d.target.value,page:1}),className:"max-w-xs rounded-brill"}),t.jsxs("select",{value:k.status,onChange:d=>x({...k,status:d.target.value,page:1}),className:"px-3 py-2 border border-gray-300 rounded-brill focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"",children:"All Status"}),t.jsx("option",{value:"OPEN",children:"Open"}),t.jsx("option",{value:"IN_PROGRESS",children:"In Progress"}),t.jsx("option",{value:"RESOLVED",children:"Resolved"}),t.jsx("option",{value:"CLOSED",children:"Closed"})]}),t.jsxs("select",{value:k.priority,onChange:d=>x({...k,priority:d.target.value,page:1}),className:"px-3 py-2 border border-gray-300 rounded-brill focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"",children:"All Priority"}),t.jsx("option",{value:"LOW",children:"Low"}),t.jsx("option",{value:"NORMAL",children:"Normal"}),t.jsx("option",{value:"HIGH",children:"High"}),t.jsx("option",{value:"URGENT",children:"Urgent"})]})]})}),h.length>0&&t.jsx(U,{className:"p-4 rounded-brill",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("span",{className:"text-sm text-gray-600",children:[h.length," ticket(s) selected"]}),t.jsx(L,{size:"sm",onClick:()=>_("status","IN_PROGRESS"),className:"rounded-brill",children:"Mark In Progress"}),t.jsx(L,{size:"sm",onClick:()=>_("status","RESOLVED"),className:"rounded-brill",children:"Mark Resolved"}),t.jsx(L,{size:"sm",variant:"outline",onClick:()=>p([]),className:"rounded-brill",children:"Clear Selection"})]})}),t.jsx(U,{className:"rounded-brill",children:t.jsx("div",{className:"p-6",children:t.jsx("div",{className:"space-y-4",children:e.map(d=>t.jsxs("div",{className:"flex items-start gap-4 p-4 border border-gray-200 rounded-lg hover:bg-gray-50",children:[t.jsx("input",{type:"checkbox",checked:h.includes(d.id),onChange:T=>{T.target.checked?p([...h,d.id]):p(h.filter(O=>O!==d.id))},className:"mt-1"}),t.jsx("div",{className:"flex-1 cursor-pointer",onClick:()=>{m(d.id),v(d.id)},children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsxs("h4",{className:"font-medium text-gray-900",children:["#",d.ticketNumber," - ",d.subject]}),t.jsxs("p",{className:"text-sm text-gray-600",children:[d.name," (",d.email,") - ",d.userRole]}),t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Created: ",new Date(d.createdAt).toLocaleString()]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(W,{className:j(d.priority),children:d.priority}),t.jsx(W,{className:b(d.status),children:d.status})]})]})})]},d.id))})})})]}),t.jsx(xe,{value:"details",children:t.jsx(U,{className:"rounded-brill",children:t.jsx("div",{className:"p-6",children:u&&f?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsxs("h3",{className:"text-xl font-semibold",children:["#",f.ticket.ticketNumber]}),t.jsx("h4",{className:"text-lg text-gray-900 mt-1",children:f.ticket.subject}),t.jsxs("p",{className:"text-gray-600 mt-1",children:[f.ticket.name," (",f.ticket.email,")"]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(W,{className:j(f.ticket.priority),children:f.ticket.priority}),t.jsx(W,{className:b(f.ticket.status),children:f.ticket.status})]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(L,{size:"sm",onClick:()=>D(u,{status:"IN_PROGRESS"}),disabled:f.ticket.status==="IN_PROGRESS",className:"rounded-brill",children:"In Progress"}),t.jsx(L,{size:"sm",onClick:()=>D(u,{status:"RESOLVED"}),disabled:f.ticket.status==="RESOLVED",className:"rounded-brill",children:"Resolve"})]}),t.jsxs("div",{children:[t.jsx("h5",{className:"font-medium text-gray-700 mb-2",children:"Original Message"}),t.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:t.jsx("p",{className:"text-gray-700",children:f.ticket.message})})]}),f.responses.length>0&&t.jsxs("div",{children:[t.jsx("h5",{className:"font-medium text-gray-700 mb-2",children:"Conversation"}),t.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:f.responses.map(d=>t.jsxs("div",{className:`p-4 rounded-lg ${d.responderType==="ADMIN"?"bg-blue-50":"bg-gray-50"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx(W,{variant:d.responderType==="ADMIN"?"default":"secondary",children:d.responderType==="ADMIN"?"Support Agent":"Customer"}),t.jsx("span",{className:"text-xs text-gray-500",children:new Date(d.createdAt).toLocaleString()})]}),t.jsx("p",{className:"text-gray-700",children:d.message})]},d.id))})]}),t.jsxs("form",{onSubmit:w,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Admin Response"}),t.jsx(it,{value:g,onChange:d=>S(d.target.value),placeholder:"Type your response to the customer...",rows:4,className:"rounded-brill"})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("select",{value:C,onChange:d=>E(d.target.value),className:"px-3 py-2 border border-gray-300 rounded-brill focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"",children:"Keep current status"}),t.jsx("option",{value:"IN_PROGRESS",children:"Mark In Progress"}),t.jsx("option",{value:"RESOLVED",children:"Mark Resolved"}),t.jsx("option",{value:"CLOSED",children:"Mark Closed"})]}),t.jsx(L,{type:"submit",disabled:!g.trim(),className:"rounded-brill",children:"Send Response"})]})]})]}):t.jsx("div",{className:"text-center py-12",children:t.jsx("p",{className:"text-gray-600",children:"Select a ticket from the tickets tab to view details"})})})})})]})]})})},vd=()=>{const[e,s]=c.useState("all"),[r,n]=c.useState(null),[i,a]=c.useState(!1),[l,o]=c.useState(""),[h,p]=c.useState(""),[u,m]=c.useState(null),f=rt();c.useEffect(()=>{const d=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}`,T=new WebSocket(d);return T.onopen=()=>{console.log("WebSocket connected for admin escrow management"),T.send(JSON.stringify({type:"join_room",room:"admin_dashboard"}))},T.onmessage=O=>{switch(JSON.parse(O.data).type){case"escrow_dispute_resolved":case"escrow_status_update":case"dispute_escalated":f.invalidateQueries({queryKey:["admin-escrow"]}),f.invalidateQueries({queryKey:["escrow-analytics"]}),toast({title:"Escrow Update",description:"Escrow transaction status has been updated"});break}},T.onclose=()=>{console.log("WebSocket disconnected")},m(T),()=>{T.close()}},[f]);const{data:R,isLoading:k}=Oe({queryKey:["admin-escrow",e],queryFn:async()=>{const j=await fetch(`/api/admin/escrow?status=${e}&limit=50&offset=0`,{credentials:"include"});if(!j.ok)throw new Error("Failed to fetch escrow transactions");return j.json()},refetchInterval:3e4}),{data:x}=Oe({queryKey:["escrow-analytics"],queryFn:async()=>{const j=await fetch("/api/admin/escrow/analytics",{credentials:"include"});if(!j.ok)throw new Error("Failed to fetch analytics");return j.json()},refetchInterval:6e4}),{data:g}=Oe({queryKey:["dispute-evidence",r?.id],queryFn:async()=>{if(!r)return null;const j=await fetch(`/api/admin/escrow/${r.id}/evidence`,{credentials:"include"});if(!j.ok)throw new Error("Failed to fetch evidence");return j.json()},enabled:!!r&&r.status==="DISPUTED"}),S=Ke({mutationFn:async({action:j,notes:d,partialAmount:T})=>{const O=await fetch("/api/admin/escrow/resolve-dispute",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({escrowId:r?.id,action:j,notes:d,partialAmount:T})});if(!O.ok)throw new Error("Failed to resolve dispute");return O.json()},onSuccess:()=>{toast({title:"Dispute Resolved",description:"The dispute has been successfully resolved"}),a(!1),o(""),p(""),f.invalidateQueries({queryKey:["admin-escrow"]}),f.invalidateQueries({queryKey:["escrow-analytics"]})},onError:j=>{toast({title:"Error",description:j.message||"Failed to resolve dispute",variant:"destructive"})}}),C=Ke({mutationFn:async j=>{const d=await fetch("/api/admin/escrow/release",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({escrowId:j,reason:"Admin early release"})});if(!d.ok)throw new Error("Failed to release escrow");return d.json()},onSuccess:()=>{toast({title:"Escrow Released",description:"Escrow funds have been released successfully"}),f.invalidateQueries({queryKey:["admin-escrow"]}),f.invalidateQueries({queryKey:["escrow-analytics"]})},onError:j=>{toast({title:"Error",description:j.message||"Failed to release escrow",variant:"destructive"})}}),E=j=>{switch(j){case"HELD":return t.jsx(W,{className:"bg-green-100 text-green-800",children:"ACTIVE"});case"DISPUTED":return t.jsx(W,{className:"bg-red-100 text-red-800",children:"DISPUTED"});case"RELEASED_TO_SELLER":case"RELEASED_TO_DRIVER":return t.jsx(W,{className:"bg-gray-100 text-gray-800",children:"RELEASED"});case"REFUNDED":return t.jsx(W,{className:"bg-blue-100 text-blue-800",children:"REFUNDED"});default:return t.jsx(W,{className:"bg-yellow-100 text-yellow-800",children:"PENDING"})}},N=j=>{switch(j){case"DISPUTED":return"border-red-500";case"HELD":return"border-green-500";default:return"border-gray-200"}},y=j=>new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN"}).format(parseFloat(j)),P=j=>{const d=new Date(j),O=new Date().getTime()-d.getTime(),M=Math.round(O/6e4),H=Math.round(O/36e5),he=Math.round(O/864e5);return M<60?`${M} min ago`:H<24?`${H} hour${H>1?"s":""} ago`:`${he} day${he>1?"s":""} ago`},A=j=>{if(!l.trim()){toast({title:"Error",description:"Please enter resolution notes",variant:"destructive"});return}if(j==="partial"&&(!h||parseFloat(h)<=0)){toast({title:"Error",description:"Please enter a valid partial refund amount",variant:"destructive"});return}S.mutate({action:j,notes:l,partialAmount:j==="partial"?parseFloat(h):void 0})},v=j=>{window.confirm("Are you sure you want to release this escrow?")&&C.mutate(j)};if(k)return t.jsx("div",{className:"flex items-center justify-center h-96",children:t.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})});const D=R?.data?.transactions||[],w=R?.data?.totalCount||0,_=R?.data?.escrowBalance||"0",b=R?.data?.disputedCount||0;return t.jsxs("div",{className:"flex h-screen bg-gray-50",children:[t.jsxs("div",{className:"w-16 bg-white shadow-lg flex flex-col items-center py-4 space-y-4",children:[t.jsx(L,{variant:"ghost",size:"sm",onClick:()=>window.history.back(),children:t.jsx(Mi,{className:"w-6 h-6"})}),t.jsx("div",{className:"w-8 h-8 rounded-lg bg-blue-600 flex items-center justify-center",children:t.jsx(se,{className:"w-5 h-5 text-white"})})]}),t.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[t.jsx("header",{className:"bg-white shadow-sm border-b p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-blue-900",children:"Escrow Management"}),t.jsx("p",{className:"text-sm text-gray-600",children:"Monitor and manage payment escrow transactions"})]}),t.jsxs("div",{className:"flex items-center space-x-6",children:[t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"text-lg font-bold text-black",children:y(_)}),t.jsx("p",{className:"text-xs text-gray-600",children:"Total Escrow Balance"})]}),t.jsx("div",{className:"w-px h-8 bg-gray-300"}),t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"text-lg font-bold text-red-600",children:b}),t.jsx("p",{className:"text-xs text-gray-600",children:"Pending Disputes"})]})]})]})}),t.jsx("div",{className:"p-6 bg-white border-b",children:t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsx(U,{children:t.jsx(z,{className:"p-4",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx(Ye,{className:"w-8 h-8 text-green-600"}),t.jsxs("div",{className:"ml-4",children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Escrow"}),t.jsx("p",{className:"text-2xl font-bold",children:x?.data?.activeEscrowing||0})]})]})})}),t.jsx(U,{children:t.jsx(z,{className:"p-4",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx(ue,{className:"w-8 h-8 text-red-600"}),t.jsxs("div",{className:"ml-4",children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Disputed"}),t.jsx("p",{className:"text-2xl font-bold",children:x?.data?.disputedCount||0})]})]})})}),t.jsx(U,{children:t.jsx(z,{className:"p-4",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx(Ne,{className:"w-8 h-8 text-yellow-600"}),t.jsxs("div",{className:"ml-4",children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pending Release"}),t.jsx("p",{className:"text-2xl font-bold",children:x?.data?.pendingReleaseCount||0})]})]})})}),t.jsx(U,{children:t.jsx(z,{className:"p-4",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx(ge,{className:"w-8 h-8 text-gray-600"}),t.jsxs("div",{className:"ml-4",children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Released"}),t.jsx("p",{className:"text-2xl font-bold",children:x?.data?.releasedCount||0})]})]})})})]})}),t.jsx("div",{className:"bg-white px-6 py-4 border-b",children:t.jsx(Fs,{value:e,onValueChange:j=>s(j),children:t.jsxs(Lt,{children:[t.jsxs(X,{value:"all",children:["All Escrow (",w,")"]}),t.jsx(X,{value:"active",children:"Active"}),t.jsx(X,{value:"disputed",children:"Disputed"}),t.jsx(X,{value:"pending",children:"Pending Release"}),t.jsx(X,{value:"released",children:"Released"})]})})}),t.jsxs("main",{className:"flex-1 overflow-auto p-6",children:[t.jsx("div",{className:"space-y-4",children:D.map(j=>t.jsx(U,{className:`${N(j.status)} border-l-4 ${j.status==="DISPUTED"?"shadow-lg":"shadow-sm"}`,children:t.jsxs(z,{className:"p-6",children:[t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsxs("h3",{className:"text-lg font-bold mr-3",children:["ESC-",j.id]}),E(j.status),j.status==="DISPUTED"&&t.jsx(W,{className:"ml-2 bg-red-100 text-red-800 font-bold",children:"CRITICAL"})]}),t.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:[t.jsx("strong",{children:"Customer:"})," ",j.buyerName,"  ",t.jsx("strong",{children:"Merchant:"})," ",j.sellerName]}),t.jsxs("p",{className:"text-sm text-gray-600",children:["Order #",j.orderId.slice(-4),"  ",j.orderTitle,"  Created ",P(j.createdAt)]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"text-xl font-bold",children:y(j.totalAmount)}),t.jsxs("p",{className:"text-xs text-gray-600",children:["Held since ",P(j.createdAt)]})]})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-600",children:[j.status==="DISPUTED"&&t.jsxs(t.Fragment,{children:[t.jsx("span",{children:" Evidence available"}),t.jsxs("span",{children:[" Last activity: ",P(j.updatedAt)]})]}),j.status==="HELD"&&t.jsxs(t.Fragment,{children:[t.jsx("span",{children:" Transaction active"}),j.autoReleaseAt&&t.jsxs("span",{children:[" Auto-release: ",P(j.autoReleaseAt)]})]})]}),t.jsxs("div",{className:"flex space-x-2",children:[j.status==="DISPUTED"&&t.jsx(L,{onClick:()=>{n(j),a(!0)},className:"bg-red-500 hover:bg-red-600",size:"sm",children:"Resolve Dispute"}),j.status==="HELD"&&t.jsx(L,{onClick:()=>v(j.id),className:"bg-green-600 hover:bg-green-700",size:"sm",children:"Release Early"}),t.jsxs(L,{variant:"outline",size:"sm",onClick:()=>n(j),children:[t.jsx(tt,{className:"w-4 h-4 mr-1"}),"View Details"]})]})]})]})},j.id))}),D.length===0&&t.jsxs("div",{className:"text-center py-12",children:[t.jsx(se,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No escrow transactions"}),t.jsx("p",{className:"text-gray-600",children:"No escrow transactions found for the selected filter."})]})]})]}),t.jsx(As,{open:i,onOpenChange:a,children:t.jsxs(Fn,{className:"max-w-2xl max-h-screen overflow-y-auto",children:[t.jsx(Ln,{children:t.jsxs(Un,{children:["Dispute Resolution - ESC-",r?.id]})}),r&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Escrow ID"}),t.jsxs("p",{className:"text-lg font-bold",children:["ESC-",r.id]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Amount"}),t.jsx("p",{className:"text-lg font-bold",children:y(r.totalAmount)})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Customer"}),t.jsx("p",{className:"font-medium",children:r.buyerName}),t.jsx("p",{className:"text-xs text-gray-600",children:r.buyerEmail})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Merchant"}),t.jsx("p",{className:"font-medium",children:r.sellerName}),t.jsx("p",{className:"text-xs text-gray-600",children:r.sellerEmail})]})]}),g?.data&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-bold mb-4",children:"Evidence"}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs(U,{children:[t.jsx(J,{children:t.jsx(Y,{className:"text-sm",children:"Customer Evidence"})}),t.jsx(z,{children:t.jsx("div",{className:"space-y-2",children:g.data.customerEvidence.map((j,d)=>t.jsxs("div",{className:"flex items-center p-2 bg-gray-50 rounded",children:[t.jsx(St,{className:"w-4 h-4 mr-2 text-gray-600"}),t.jsx("span",{className:"text-xs",children:j.filename})]},d))})})]}),t.jsxs(U,{children:[t.jsx(J,{children:t.jsx(Y,{className:"text-sm",children:"Merchant Evidence"})}),t.jsx(z,{children:t.jsx("div",{className:"space-y-2",children:g.data.merchantEvidence.map((j,d)=>t.jsxs("div",{className:"flex items-center p-2 bg-gray-50 rounded",children:[t.jsx(St,{className:"w-4 h-4 mr-2 text-gray-600"}),t.jsx("span",{className:"text-xs",children:j.filename})]},d))})})]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-bold mb-4",children:"Resolution Actions"}),t.jsx(it,{value:l,onChange:j=>o(j.target.value),placeholder:"Enter admin notes and resolution details...",className:"mb-4",rows:4}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsx(L,{onClick:()=>A("refund"),className:"bg-red-500 hover:bg-red-600",disabled:S.isPending,children:"Refund Customer"}),t.jsx(L,{onClick:()=>A("release"),className:"bg-green-600 hover:bg-green-700",disabled:S.isPending,children:"Release to Merchant"})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("input",{type:"number",value:h,onChange:j=>p(j.target.value),placeholder:"Partial refund amount",className:"flex-1 px-3 py-2 border rounded-md"}),t.jsx(L,{onClick:()=>A("partial"),className:"bg-blue-500 hover:bg-blue-600",disabled:S.isPending,children:"Partial Refund"})]})]})]})]})]})})]})},bd="http://localhost:5000/api/admin";async function Ve(e,s,r){const n=localStorage.getItem("adminToken"),i=await fetch(`${bd}${s}`,{method:e,headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:r?JSON.stringify(r):void 0});if(!i.ok)throw new Error(`Request failed: ${i.statusText}`);return i.json()}function jd(){const e=rt(),[s,r]=c.useState([]),[n,i]=c.useState(null),[a,l]=c.useState(!1),[o,h]=c.useState({status:"",contentType:"",priority:"",search:"",startDate:"",endDate:""});c.useEffect(()=>{const b=new WebSocket("ws://localhost:5000/ws");return b.onopen=()=>{console.log("Connected to moderation WebSocket"),b.send(JSON.stringify({type:"join_admin_room",roomType:"moderation"}))},b.onmessage=j=>{const d=JSON.parse(j.data);(d.type==="new_content_report"||d.type==="content_action_taken"||d.type==="bulk_content_action"||d.type==="report_escalated")&&(e.invalidateQueries({queryKey:["moderation-reports"]}),e.invalidateQueries({queryKey:["moderation-stats"]}),d.type==="new_content_report"&&x(`New content report: ${d.contentType}`,"info"))},()=>b.close()},[e]);const{data:p,isLoading:u}=Oe({queryKey:["moderation-reports",o],queryFn:()=>{const b=new URLSearchParams;return Object.entries(o).forEach(([j,d])=>{d&&b.append(j,d)}),Ve("GET",`/moderation/reports?${b.toString()}`)},refetchInterval:3e4}),{data:m}=Oe({queryKey:["moderation-stats"],queryFn:()=>Ve("GET","/moderation/stats"),refetchInterval:6e4}),f=Ke({mutationFn:({reportId:b,action:j,reason:d})=>Ve("POST",`/moderation/reports/${b}/action`,{action:j,reason:d}),onSuccess:()=>{e.invalidateQueries({queryKey:["moderation-reports"]}),e.invalidateQueries({queryKey:["moderation-stats"]}),x("Action completed successfully","success"),i(null),l(!1)},onError:()=>{x("Failed to complete action","error")}}),R=Ke({mutationFn:({reportIds:b,action:j,reason:d})=>Ve("POST","/moderation/reports/bulk-action",{reportIds:b,action:j,reason:d}),onSuccess:()=>{e.invalidateQueries({queryKey:["moderation-reports"]}),e.invalidateQueries({queryKey:["moderation-stats"]}),r([]),x("Bulk action completed successfully","success")},onError:()=>{x("Failed to complete bulk action","error")}}),k=Ke({mutationFn:({reportId:b,reason:j,priority:d})=>Ve("POST",`/moderation/reports/${b}/escalate`,{reason:j,priority:d}),onSuccess:()=>{e.invalidateQueries({queryKey:["moderation-reports"]}),x("Report escalated successfully","success")},onError:()=>{x("Failed to escalate report","error")}}),x=(b,j)=>{const d=document.createElement("div");d.className=`fixed top-4 right-4 px-4 py-2 rounded-md text-white z-50 ${j==="success"?"bg-green-500":j==="error"?"bg-red-500":"bg-blue-500"}`,d.textContent=b,document.body.appendChild(d),setTimeout(()=>document.body.removeChild(d),3e3)},g=(b,j)=>{h(d=>({...d,[b]:j}))},S=b=>{i(b),l(!0)},C=b=>{r(j=>j.includes(b)?j.filter(d=>d!==b):[...j,b])},E=(b,j)=>{n&&f.mutate({reportId:n.id,action:b,reason:j})},N=(b,j)=>{s.length!==0&&R.mutate({reportIds:s,action:b,reason:j})},y=(b,j="HIGH")=>{n&&k.mutate({reportId:n.id,reason:b,priority:j})},P=b=>{switch(b){case"POST":return t.jsx(St,{className:"h-4 w-4"});case"COMMENT":return t.jsx(kr,{className:"h-4 w-4"});case"PRODUCT":return t.jsx(Fi,{className:"h-4 w-4"});case"USER":return t.jsx(Vs,{className:"h-4 w-4"});default:return t.jsx(St,{className:"h-4 w-4"})}},A=b=>{switch(b){case"PENDING":return"bg-yellow-100 text-yellow-800";case"REVIEWED":return"bg-blue-100 text-blue-800";case"RESOLVED":return"bg-green-100 text-green-800";case"DISMISSED":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},v=b=>{switch(b){case"CRITICAL":return"bg-red-100 text-red-800 border-red-200";case"HIGH":return"bg-orange-100 text-orange-800 border-orange-200";case"MEDIUM":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"LOW":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},D=b=>{const j=new Date(b),T=Math.floor((new Date().getTime()-j.getTime())/(1e3*60*60));return T<1?"Just now":T<24?`${T}h ago`:`${Math.floor(T/24)}d ago`},w=p?.data?.reports||[],_=m?.data||{overview:{pending:0,resolved:0},performance:{avgResolutionTime:0,moderatorEfficiency:0}};return t.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Content Moderation"}),t.jsx("p",{className:"text-gray-600",children:"Review and manage reported content"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[t.jsx("div",{className:"bg-white p-4 rounded-lg shadow",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:_.overview.pending}),t.jsx("div",{className:"text-sm text-gray-600",children:"Pending Reports"})]}),t.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:t.jsx(Ne,{className:"h-6 w-6 text-yellow-600"})})]})}),t.jsx("div",{className:"bg-white p-4 rounded-lg shadow",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:_.overview.resolved}),t.jsx("div",{className:"text-sm text-gray-600",children:"Resolved Today"})]}),t.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:t.jsx(ge,{className:"h-6 w-6 text-green-600"})})]})}),t.jsx("div",{className:"bg-white p-4 rounded-lg shadow",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[_.performance.avgResolutionTime,"h"]}),t.jsx("div",{className:"text-sm text-gray-600",children:"Avg Resolution"})]}),t.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:t.jsx(Ne,{className:"h-6 w-6 text-blue-600"})})]})}),t.jsx("div",{className:"bg-white p-4 rounded-lg shadow",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[_.performance.moderatorEfficiency,"%"]}),t.jsx("div",{className:"text-sm text-gray-600",children:"Efficiency Rate"})]}),t.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:t.jsx(se,{className:"h-6 w-6 text-purple-600"})})]})})]}),t.jsx("div",{className:"bg-white p-4 rounded-lg shadow mb-6",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),t.jsxs("div",{className:"relative",children:[t.jsx(At,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),t.jsx("input",{type:"text",value:o.search,onChange:b=>g("search",b.target.value),placeholder:"Search reports...",className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),t.jsxs("select",{value:o.status,onChange:b=>g("status",b.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"",children:"All Statuses"}),t.jsx("option",{value:"PENDING",children:"Pending"}),t.jsx("option",{value:"REVIEWED",children:"Reviewed"}),t.jsx("option",{value:"RESOLVED",children:"Resolved"}),t.jsx("option",{value:"DISMISSED",children:"Dismissed"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Content Type"}),t.jsxs("select",{value:o.contentType,onChange:b=>g("contentType",b.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"",children:"All Types"}),t.jsx("option",{value:"POST",children:"Posts"}),t.jsx("option",{value:"COMMENT",children:"Comments"}),t.jsx("option",{value:"PRODUCT",children:"Products"}),t.jsx("option",{value:"USER",children:"Users"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),t.jsxs("select",{value:o.priority,onChange:b=>g("priority",b.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"",children:"All Priorities"}),t.jsx("option",{value:"CRITICAL",children:"Critical"}),t.jsx("option",{value:"HIGH",children:"High"}),t.jsx("option",{value:"MEDIUM",children:"Medium"}),t.jsx("option",{value:"LOW",children:"Low"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),t.jsx("input",{type:"date",value:o.startDate,onChange:b=>g("startDate",b.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),t.jsx("input",{type:"date",value:o.endDate,onChange:b=>g("endDate",b.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})}),s.length>0&&t.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{className:"flex items-center gap-2",children:t.jsxs("span",{className:"text-sm font-medium text-blue-900",children:[s.length," reports selected"]})}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:()=>N("REMOVE","Bulk content removal"),className:"px-3 py-1 bg-red-600 text-white text-sm rounded-md hover:bg-red-700",children:"Remove All"}),t.jsx("button",{onClick:()=>N("WARNING","Bulk warning issued"),className:"px-3 py-1 bg-orange-600 text-white text-sm rounded-md hover:bg-orange-700",children:"Warn All"}),t.jsx("button",{onClick:()=>N("NO_ACTION","Bulk dismissal"),className:"px-3 py-1 bg-gray-600 text-white text-sm rounded-md hover:bg-gray-700",children:"Dismiss All"}),t.jsx("button",{onClick:()=>r([]),className:"px-3 py-1 bg-gray-300 text-gray-700 text-sm rounded-md hover:bg-gray-400",children:"Clear Selection"})]})]})}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"lg:col-span-2 bg-white rounded-lg shadow",children:[t.jsx("div",{className:"p-4 border-b border-gray-200",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Content Reports"}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("button",{onClick:()=>e.invalidateQueries({queryKey:["moderation-reports"]}),className:"p-2 text-gray-500 hover:text-gray-700",title:"Refresh",children:t.jsx(je,{className:"h-4 w-4"})}),t.jsxs("span",{className:"text-sm text-gray-500",children:[w.length," reports"]})]})]})}),t.jsx("div",{className:"max-h-96 overflow-y-auto",children:u?t.jsx("div",{className:"p-4 text-center text-gray-500",children:"Loading reports..."}):w.length===0?t.jsx("div",{className:"p-4 text-center text-gray-500",children:"No reports found"}):w.map(b=>t.jsx("div",{onClick:()=>S(b),className:`p-4 border-b border-gray-200 cursor-pointer hover:bg-gray-50 transition-colors ${n?.id===b.id?"bg-blue-50 border-blue-200":""} ${v(b.priority).includes("red")?"border-l-4 border-l-red-500":""}`,children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[t.jsx("input",{type:"checkbox",checked:s.includes(b.id),onChange:j=>{j.stopPropagation(),C(b.id)},className:"mt-1"}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[P(b.contentType),t.jsxs("span",{className:"font-medium text-sm text-gray-900",children:[b.contentType," Report #",b.id]}),t.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${A(b.status)}`,children:b.status}),t.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium border ${v(b.priority)}`,children:b.priority}),b.reportCount>1&&t.jsxs("span",{className:"px-2 py-1 rounded-full text-xs bg-purple-100 text-purple-800",children:[b.reportCount," reports"]})]}),t.jsx("p",{className:"text-sm text-gray-700 mb-2 line-clamp-2",children:b.reason}),t.jsxs("div",{className:"flex items-center text-xs text-gray-500 space-x-3",children:[t.jsxs("span",{className:"flex items-center",children:[t.jsx(Vs,{className:"h-3 w-3 mr-1"}),b.reporter.fullName]}),t.jsxs("span",{className:"flex items-center",children:[t.jsx(Ne,{className:"h-3 w-3 mr-1"}),D(b.createdAt)]})]})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[b.status==="PENDING"&&t.jsxs("button",{onClick:j=>{j.stopPropagation(),y("Urgent escalation required","HIGH")},className:"text-xs text-orange-600 hover:text-orange-800 flex items-center",children:[t.jsx(Ar,{className:"h-3 w-3 mr-1"}),"Escalate"]}),t.jsx("button",{className:"text-gray-400 hover:text-gray-600",children:t.jsx(bs,{className:"h-4 w-4"})})]})]})},b.id))})]}),t.jsx("div",{className:"bg-white rounded-lg shadow",children:n?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"p-4 border-b border-gray-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Report Details"}),t.jsx("button",{onClick:()=>l(!1),className:"text-gray-400 hover:text-gray-600",children:""})]})}),t.jsxs("div",{className:"p-4 space-y-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Report Information"}),t.jsxs("div",{className:"text-sm space-y-1",children:[t.jsxs("p",{children:[t.jsx("span",{className:"font-medium",children:"Type:"})," ",n.contentType]}),t.jsxs("p",{children:[t.jsx("span",{className:"font-medium",children:"Content ID:"})," ",n.contentId]}),t.jsxs("p",{children:[t.jsx("span",{className:"font-medium",children:"Priority:"}),t.jsx("span",{className:`ml-2 px-2 py-1 rounded-full text-xs font-medium border ${v(n.priority)}`,children:n.priority})]}),t.jsxs("p",{children:[t.jsx("span",{className:"font-medium",children:"Status:"}),t.jsx("span",{className:`ml-2 px-2 py-1 rounded-full text-xs font-medium ${A(n.status)}`,children:n.status})]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Reporter"}),t.jsxs("div",{className:"text-sm space-y-1",children:[t.jsxs("p",{children:[t.jsx("span",{className:"font-medium",children:"Name:"})," ",n.reporter.fullName]}),t.jsxs("p",{children:[t.jsx("span",{className:"font-medium",children:"Email:"})," ",n.reporter.email]}),t.jsxs("p",{children:[t.jsx("span",{className:"font-medium",children:"Role:"})," ",n.reporter.role]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Reason"}),t.jsx("div",{className:"p-3 bg-gray-50 rounded-md border text-sm",children:n.reason})]}),n.status==="PENDING"&&t.jsxs("div",{children:[t.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Take Action"}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("button",{onClick:()=>E("REMOVE","Content removed for policy violation"),disabled:f.isPending,className:"w-full bg-red-600 text-white px-4 py-2 rounded-md text-sm hover:bg-red-700 disabled:bg-gray-300",children:"Remove Content"}),t.jsx("button",{onClick:()=>E("WARNING","Warning issued to user"),disabled:f.isPending,className:"w-full bg-orange-600 text-white px-4 py-2 rounded-md text-sm hover:bg-orange-700 disabled:bg-gray-300",children:"Issue Warning"}),t.jsx("button",{onClick:()=>E("BAN","User banned for repeated violations"),disabled:f.isPending,className:"w-full bg-gray-800 text-white px-4 py-2 rounded-md text-sm hover:bg-gray-900 disabled:bg-gray-300",children:"Ban User"}),t.jsx("button",{onClick:()=>E("NO_ACTION","No violation found"),disabled:f.isPending,className:"w-full bg-gray-600 text-white px-4 py-2 rounded-md text-sm hover:bg-gray-700 disabled:bg-gray-300",children:"No Action Needed"})]})]}),n.status==="PENDING"&&t.jsxs("div",{children:[t.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Escalate Report"}),t.jsx("button",{onClick:()=>y("Requires senior review","HIGH"),disabled:k.isPending,className:"w-full bg-yellow-600 text-white px-4 py-2 rounded-md text-sm hover:bg-yellow-700 disabled:bg-gray-300",children:"Escalate to Senior Moderator"})]})]})]}):t.jsxs("div",{className:"p-8 text-center text-gray-500",children:[t.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:t.jsx(se,{className:"w-8 h-8 text-gray-400"})}),t.jsx("p",{children:"Select a report to view details and take action"})]})})]})]})}const Nd=()=>{const[e,s]=c.useState("overview"),[r,n]=c.useState(!0),{data:i,isLoading:a,refetch:l}=Oe({queryKey:["system-metrics"],queryFn:async()=>{const h=await fetch("/api/admin/system/metrics",{credentials:"include"});if(!h.ok)throw new Error("Failed to fetch system metrics");return h.json()},refetchInterval:r?5e3:!1}),o=h=>{switch(h){case"healthy":return t.jsx(ge,{className:"h-4 w-4 text-green-600"});case"warning":return t.jsx(ue,{className:"h-4 w-4 text-yellow-600"});case"critical":return t.jsx(Bi,{className:"h-4 w-4 text-red-600"});default:return t.jsx(Ui,{className:"h-4 w-4 text-gray-600"})}};return a?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):t.jsxs("div",{className:"space-y-6 p-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"System Monitoring"}),t.jsx("p",{className:"text-gray-600",children:"Real-time system health and performance monitoring"})]}),t.jsxs("div",{className:"flex space-x-4",children:[t.jsxs(L,{variant:r?"default":"outline",onClick:()=>n(!r),size:"sm",children:[t.jsx(we,{className:"h-4 w-4 mr-2"}),r?"Auto Refresh On":"Auto Refresh Off"]}),t.jsx(L,{variant:"outline",onClick:()=>l(),size:"sm",children:"Refresh Now"})]})]}),t.jsxs(Fs,{value:e,onValueChange:s,children:[t.jsxs(Lt,{className:"grid w-full grid-cols-4",children:[t.jsx(X,{value:"overview",children:"Overview"}),t.jsx(X,{value:"server",children:"Server"}),t.jsx(X,{value:"database",children:"Database"}),t.jsx(X,{value:"realtime",children:"Real-time"})]}),t.jsxs(xe,{value:"overview",className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[t.jsxs(U,{children:[t.jsxs(J,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(Y,{className:"text-sm font-medium",children:"Server Status"}),t.jsx(ss,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(z,{children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[o("healthy"),t.jsx("div",{className:"text-2xl font-bold",children:"Online"})]}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:["Uptime: ",Math.floor((i?.server.uptime||0)/3600),"h"]})]})]}),t.jsxs(U,{children:[t.jsxs(J,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(Y,{className:"text-sm font-medium",children:"Database"}),t.jsx(rs,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(z,{children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[o(i?.database.status||"healthy"),t.jsx("div",{className:"text-2xl font-bold capitalize",children:i?.database.status||"Healthy"})]}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:[i?.database.connections||0," active connections"]})]})]}),t.jsxs(U,{children:[t.jsxs(J,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(Y,{className:"text-sm font-medium",children:"Active Users"}),t.jsx(st,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(z,{children:[t.jsx("div",{className:"text-2xl font-bold",children:i?.realTime.activeUsers||0}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:[i?.realTime.activeConnections||0," WebSocket connections"]})]})]}),t.jsxs(U,{children:[t.jsxs(J,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(Y,{className:"text-sm font-medium",children:"Response Time"}),t.jsx(Tt,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(z,{children:[t.jsxs("div",{className:"text-2xl font-bold",children:[i?.performance.responseTime||0,"ms"]}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:["Error rate: ",(i?.performance.errorRate||0).toFixed(2),"%"]})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs(U,{children:[t.jsx(J,{children:t.jsxs(Y,{className:"flex items-center",children:[t.jsx(_r,{className:"h-5 w-5 mr-2"}),"System Resources"]})}),t.jsx(z,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("span",{className:"text-sm",children:"CPU Usage"}),t.jsxs("span",{className:"text-sm font-medium",children:[i?.server.cpu||0,"%"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${i?.server.cpu||0}%`}})})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("span",{className:"text-sm",children:"Memory Usage"}),t.jsxs("span",{className:"text-sm font-medium",children:[i?.server.memory||0,"%"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${i?.server.memory||0}%`}})})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("span",{className:"text-sm",children:"Disk Usage"}),t.jsxs("span",{className:"text-sm font-medium",children:[i?.server.disk||0,"%"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:"bg-yellow-600 h-2 rounded-full",style:{width:`${i?.server.disk||0}%`}})})]})]})})]}),t.jsxs(U,{children:[t.jsx(J,{children:t.jsxs(Y,{className:"flex items-center",children:[t.jsx(Li,{className:"h-5 w-5 mr-2"}),"Network & Performance"]})}),t.jsx(z,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm",children:"Throughput"}),t.jsxs("span",{className:"text-sm font-medium",children:[i?.performance.throughput||0," req/min"]})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm",children:"Avg Response Time"}),t.jsxs("span",{className:"text-sm font-medium",children:[i?.performance.responseTime||0,"ms"]})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm",children:"Error Rate"}),t.jsxs("span",{className:"text-sm font-medium",children:[(i?.performance.errorRate||0).toFixed(2),"%"]})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm",children:"Messages Sent"}),t.jsx("span",{className:"text-sm font-medium",children:i?.realTime.messagesSent||0})]})]})})]})]})]}),t.jsx(xe,{value:"server",children:t.jsxs(U,{children:[t.jsxs(J,{children:[t.jsxs(Y,{className:"flex items-center",children:[t.jsx(ss,{className:"h-5 w-5 mr-2"}),"Server Monitoring"]}),t.jsx(Ge,{children:"Detailed server performance and health metrics"})]}),t.jsx(z,{children:t.jsx("div",{className:"h-96 flex items-center justify-center text-gray-500",children:"Detailed server monitoring charts would be implemented here"})})]})}),t.jsx(xe,{value:"database",children:t.jsxs(U,{children:[t.jsxs(J,{children:[t.jsxs(Y,{className:"flex items-center",children:[t.jsx(rs,{className:"h-5 w-5 mr-2"}),"Database Monitoring"]}),t.jsx(Ge,{children:"Database performance, connections, and query analytics"})]}),t.jsx(z,{children:t.jsx("div",{className:"h-96 flex items-center justify-center text-gray-500",children:"Database monitoring and query performance analytics would be implemented here"})})]})}),t.jsx(xe,{value:"realtime",children:t.jsxs(U,{children:[t.jsxs(J,{children:[t.jsxs(Y,{className:"flex items-center",children:[t.jsx(we,{className:"h-5 w-5 mr-2"}),"Real-time System Monitoring"]}),t.jsx(Ge,{children:"Live WebSocket connections and real-time features monitoring"})]}),t.jsx(z,{children:t.jsx("div",{className:"h-96 flex items-center justify-center text-gray-500",children:"Real-time monitoring dashboard with live connections and message flow would be implemented here"})})]})})]})]})};function Sr(){const{isAuthenticated:e,isLoading:s}=ho(),[r,n]=c.useState("dashboard");if(s)return t.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),t.jsx("p",{className:"mt-4 text-gray-600",children:"Loading admin dashboard..."})]})});if(!e)return window.location.href="/admin",null;const i=()=>{switch(r){case"dashboard":return t.jsx(ir,{});case"users":return t.jsx(xo,{});case"kyc":return t.jsx(tc,{});case"transactions":return t.jsx(nc,{});case"monitoring":return t.jsx(Xc,{});case"fraud":return t.jsx(Zc,{});case"support":return t.jsx(yd,{});case"escrow":return t.jsx(vd,{});case"moderation":return t.jsx(jd,{});case"system":return t.jsx(Nd,{});case"analytics":return t.jsxs("div",{className:"p-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Platform Analytics"}),t.jsx("p",{className:"text-gray-600 mt-2",children:"Advanced analytics and reporting tools coming soon..."})]});case"security":return t.jsxs("div",{className:"p-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Security Center"}),t.jsx("p",{className:"text-gray-600 mt-2",children:"Security monitoring and threat detection tools coming soon..."})]});default:return t.jsx(ir,{})}},a=l=>{n(l)};return t.jsx("div",{className:"min-h-screen bg-gray-50",children:t.jsx(po,{currentPage:r,onPageChange:a,children:i()})})}const wd=new oa({defaultOptions:{queries:{staleTime:300*1e3,refetchOnWindowFocus:!1}}});function Sd(){return de.useEffect(()=>{const e=document.getElementById("loading");e&&(e.style.display="none")},[]),t.jsx(ha,{client:wd,children:t.jsxs(uo,{children:[t.jsxs(bi,{base:"/admin",children:[t.jsx(Ut,{path:"/login",component:fo}),t.jsx(Ut,{path:"/*",component:Sr}),t.jsx(Ut,{path:"/",component:Sr})]}),t.jsx(Ta,{})]})})}Wi.createRoot(document.getElementById("admin-root")).render(t.jsx(de.StrictMode,{children:t.jsx(Sd,{})}));export{fo as A,L as B,oa as Q,Ta as T,ho as a,po as b,Sr as c,ha as d,Td as e,uo as f,zi as g,t as j,Aa as u};
//# sourceMappingURL=admin-C4i5QKJu.js.map
