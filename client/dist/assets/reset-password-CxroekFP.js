import{aW as B,u as I,r,f as z,aN as q,j as s,B as x,A as O,l as G,I as g,Q as b,R as Y,K as v}from"./index-CVqmz7v7.js";import{L as y}from"./label-FpSljPAT.js";import{L as j}from"./lock-BTELeWgi.js";import{E as N}from"./eye-off-BKuxYNTP.js";function W(){const[,n]=B("/reset-password/:token"),[,l]=I(),[a,P]=r.useState(""),[i,S]=r.useState(""),[c,C]=r.useState(!1),[d,E]=r.useState(!1),[k,h]=r.useState(!1),[A,m]=r.useState(!1),[L,M]=r.useState(""),[w,u]=r.useState([]),o=n==null?void 0:n.token;r.useEffect(()=>{o||l("/forgot-password")},[o,l]);const R=e=>{const t=[];return e.length<8&&t.push("Password must be at least 8 characters long"),/(?=.*[a-z])/.test(e)||t.push("Password must contain at least one lowercase letter"),/(?=.*[A-Z])/.test(e)||t.push("Password must contain at least one uppercase letter"),/(?=.*\d)/.test(e)||t.push("Password must contain at least one number"),t},p=z({mutationFn:e=>q.confirmResetPassword(e),onSuccess:()=>{h(!0)},onError:e=>{M(e.message||"Failed to reset password. The link may have expired."),m(!0)}}),F=e=>{e.preventDefault(),u([]);const t=R(a);if(t.length>0){u(t);return}if(a!==i){u(["Passwords do not match"]);return}o&&p.mutate({token:o,password:a})},f=()=>{l("/forgot-password")},T=()=>{l("/signin")};return o?s.jsxs("div",{className:"w-full max-w-md mx-auto min-h-screen bg-white flex flex-col",children:[s.jsxs("div",{className:"px-6 py-8 flex-1 flex flex-col justify-center",children:[s.jsxs("div",{className:"flex items-center mb-8",children:[s.jsx(x,{onClick:f,variant:"ghost",size:"icon",className:"mr-4 w-10 h-10 rounded-full bg-gray-100 hover:bg-gray-200",children:s.jsx(O,{className:"w-5 h-5"})}),s.jsx("h1",{className:"text-xl font-bold text-[var(--brill-text)]",children:"Reset Password"})]}),s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("img",{src:G,alt:"Brillprime Logo",className:"w-16 h-16 mx-auto mb-4"}),s.jsx("h2",{className:"text-2xl font-bold text-[var(--brill-secondary)] mb-2",children:"Set New Password"}),s.jsx("p",{className:"text-[var(--brill-text-light)] text-sm",children:"Create a strong password to secure your account."})]}),w.length>0&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 mb-6",children:s.jsx("ul",{className:"text-red-600 text-sm space-y-1",children:w.map((e,t)=>s.jsxs("li",{children:["• ",e]},t))})}),s.jsxs("form",{onSubmit:F,className:"space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(y,{htmlFor:"newPassword",className:"text-[var(--brill-text)] font-medium",children:"New Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(j,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-[var(--brill-text-light)] w-5 h-5"}),s.jsx(g,{id:"newPassword",type:c?"text":"password",value:a,onChange:e=>P(e.target.value),placeholder:"Enter new password",className:"pl-12 pr-12 py-3 rounded-xl border-gray-300 focus:border-[var(--brill-primary)] focus:ring-[var(--brill-primary)]",required:!0}),s.jsx(x,{type:"button",variant:"ghost",size:"sm",className:"absolute right-2 top-1/2 transform -translate-y-1/2 h-8 w-8 p-0",onClick:()=>C(!c),children:c?s.jsx(N,{className:"h-4 w-4 text-[var(--brill-text-light)]"}):s.jsx(b,{className:"h-4 w-4 text-[var(--brill-text-light)]"})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(y,{htmlFor:"confirmPassword",className:"text-[var(--brill-text)] font-medium",children:"Confirm Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(j,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-[var(--brill-text-light)] w-5 h-5"}),s.jsx(g,{id:"confirmPassword",type:d?"text":"password",value:i,onChange:e=>S(e.target.value),placeholder:"Confirm new password",className:"pl-12 pr-12 py-3 rounded-xl border-gray-300 focus:border-[var(--brill-primary)] focus:ring-[var(--brill-primary)]",required:!0}),s.jsx(x,{type:"button",variant:"ghost",size:"sm",className:"absolute right-2 top-1/2 transform -translate-y-1/2 h-8 w-8 p-0",onClick:()=>E(!d),children:d?s.jsx(N,{className:"h-4 w-4 text-[var(--brill-text-light)]"}):s.jsx(b,{className:"h-4 w-4 text-[var(--brill-text-light)]"})})]})]}),s.jsx(Y,{type:"submit",loading:p.isPending,className:"w-full py-3 rounded-xl bg-[var(--brill-primary)] hover:bg-[var(--brill-secondary)] text-white font-medium",disabled:!a||!i,children:"Reset Password"})]}),s.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-xl",children:[s.jsx("h4",{className:"text-sm font-medium text-[var(--brill-text)] mb-2",children:"Password Requirements:"}),s.jsxs("ul",{className:"text-xs text-[var(--brill-text-light)] space-y-1",children:[s.jsx("li",{children:"• At least 8 characters long"}),s.jsx("li",{children:"• Contains uppercase and lowercase letters"}),s.jsx("li",{children:"• Contains at least one number"}),s.jsx("li",{children:"• Strong passwords help keep your account secure"})]})]})]}),s.jsx(v,{isOpen:k,onClose:()=>h(!1),type:"success",title:"Password Successfully Changed!",description:"Your password has been reset successfully. You can now sign in with your new password.",actionText:"Go to Sign In",onAction:T}),s.jsx(v,{isOpen:A,onClose:()=>m(!1),type:"error",title:"Password Reset Failed",description:L,actionText:"Try Again",onAction:()=>m(!1),showSecondaryAction:!0,secondaryActionText:"Back to Forgot Password",onSecondaryAction:f})]}):null}export{W as default};
//# sourceMappingURL=reset-password-CxroekFP.js.map
