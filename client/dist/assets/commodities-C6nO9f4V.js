import{c as n,u as E,r as c,a as V,b as H,e as g,f as U,j as e,B as l,A as M,k as O,y as Q,g as L,S as K,I as D,m as j,n as f,U as J,v as $}from"./index-CPIh2kaR.js";import{A as G,a as Z}from"./avatar-BRQfAlzh.js";import{L as _}from"./live-map-DXBjH6ZS.js";import{S as W}from"./star-DIqyJTa_.js";import{M as X}from"./minus-DLhJ3Pl9.js";import{P as Y}from"./plus-DcVrLfik.js";import{C as ee}from"./car-CK56CMyq.js";import{T as se}from"./ticket-D9iaUnEg.js";import{F as ae}from"./fuel-BWMmnkaN.js";import{H as te}from"./heart-B-x3_x1V.js";import{B as ie}from"./building-2-BGxwUkSZ.js";import{C as re}from"./calendar-BbWsTfea.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=n("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=n("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=n("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=n("Shirt",[["path",{d:"M20.38 3.46 16 2a4 4 0 0 1-8 0L3.62 3.46a2 2 0 0 0-1.34 2.23l.58 3.47a1 1 0 0 0 .99.84H6v10c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V10h2.15a1 1 0 0 0 .99-.84l.58-3.47a2 2 0 0 0-1.34-2.23z",key:"1wgbhj"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=n("ShoppingBasket",[["path",{d:"m15 11-1 9",key:"5wnq3a"}],["path",{d:"m19 11-4-7",key:"cnml18"}],["path",{d:"M2 11h20",key:"3eubbj"}],["path",{d:"m3.5 11 1.6 7.4a2 2 0 0 0 2 1.6h9.8a2 2 0 0 0 2-1.6l1.7-7.4",key:"yiazzp"}],["path",{d:"M4.5 15.5h15",key:"13mye1"}],["path",{d:"m5 11 4-7",key:"116ra9"}],["path",{d:"m9 11 1 9",key:"1ojof7"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=n("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=n("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12a2 2 0 0 1-2-2V7",key:"6c3vgh"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=n("UtensilsCrossed",[["path",{d:"m16 2-2.3 2.3a3 3 0 0 0 0 4.2l1.8 1.8a3 3 0 0 0 4.2 0L22 8",key:"n7qcjb"}],["path",{d:"M15 15 3.3 3.3a4.2 4.2 0 0 0 0 6l7.3 7.3c.7.7 2 .7 2.8 0L15 15Zm0 0 7 7",key:"d0u48b"}],["path",{d:"m2.1 21.8 6.4-6.3",key:"yn04lh"}],["path",{d:"m19 5-7 7",key:"194lzd"}]]);function Ce(){const[,b]=E(),[d,I]=c.useState(""),[h,N]=c.useState(null),[r,o]=c.useState([]),[m,v]=c.useState("categories"),[x,A]=c.useState(!1),{user:a}=V(),z=H(),{data:T=[],isLoading:B}=g({queryKey:["/api/categories"],queryFn:async()=>{const t=await(await fetch("/api/categories")).json();return t.success?t.categories:[]}}),{data:p=[],isLoading:u}=g({queryKey:["/api/products",h,d],queryFn:async()=>{const s=new URLSearchParams;h&&s.append("categoryId",h.toString()),d&&s.append("search",d),s.append("limit","50");const i=await(await fetch(`/api/products?${s}`)).json();return i.success?i.products:[]},enabled:m==="products"}),{data:w=[]}=g({queryKey:["/api/cart",a==null?void 0:a.id],queryFn:async()=>{if(!(a!=null&&a.id))return[];const t=await(await fetch(`/api/cart/${a.id}`)).json();return t.success?t.cartItems:[]},enabled:!!(a!=null&&a.id)}),y=U({mutationFn:async s=>(await fetch("/api/cart",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:a==null?void 0:a.id,productId:s.productId,quantity:s.quantity})})).json(),onSuccess:()=>{z.invalidateQueries({queryKey:["/api/cart",a==null?void 0:a.id]})}});c.useEffect(()=>{const s=localStorage.getItem("commodities-cart");s&&o(JSON.parse(s))},[]),c.useEffect(()=>{localStorage.setItem("commodities-cart",JSON.stringify(r))},[r]);const R=s=>{N(s),v("products")},k=s=>{if(a!=null&&a.id)y.mutate({productId:s.id,quantity:1});else{const t=r.find(i=>i.productId===s.id);o(t?r.map(i=>i.productId===s.id?{...i,quantity:i.quantity+1}:i):[...r,{productId:s.id,quantity:1,price:parseFloat(s.price),productName:s.name,productUnit:s.unit}])}},F=s=>{const t=r.find(i=>i.productId===s);t&&t.quantity>1?o(r.map(i=>i.productId===s?{...i,quantity:i.quantity-1}:i)):o(r.filter(i=>i.productId!==s))},C=s=>{if(a!=null&&a.id){const t=w.find(i=>i.productId===s);return(t==null?void 0:t.quantity)||0}else{const t=r.find(i=>i.productId===s);return(t==null?void 0:t.quantity)||0}},S=()=>a!=null&&a.id?w.reduce((s,t)=>s+t.quantity,0):r.reduce((s,t)=>s+t.quantity,0),P=s=>({Shirt:de,Palette:le,Sparkles:me,GraduationCap:ce,Calendar:re,DollarSign:$,ShoppingBasket:oe,Building2:ie,Heart:te,Users:J,Fuel:ae,UtensilsCrossed:he,Store:q,Ticket:se,Car:ee,Briefcase:ne})[s]||q;return B?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading business categories..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 w-full max-w-sm sm:max-w-md md:max-w-lg lg:max-w-xl xl:max-w-2xl mx-auto px-2 sm:px-4",children:[e.jsxs("div",{className:"bg-white shadow-sm border-b",children:[e.jsxs("div",{className:"flex items-center justify-between p-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>b("/dashboard"),children:e.jsx(M,{className:"h-5 w-5"})}),e.jsx("h1",{className:"text-xl font-semibold text-[#131313]",children:m==="categories"?"Business Marketplace":"Products"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[((a==null?void 0:a.role)==="MERCHANT"||(a==null?void 0:a.role)==="DRIVER")&&e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>A(!x),className:"flex items-center space-x-2",children:[e.jsx(O,{className:"h-4 w-4"}),e.jsx("span",{children:x?"Hide Map":"Live Map"})]}),e.jsxs(l,{variant:"outline",size:"icon",onClick:()=>b("/cart"),className:"relative",children:[e.jsx(Q,{className:"h-5 w-5"}),S()>0&&e.jsx(L,{className:"absolute -top-2 -right-2 h-6 w-6 rounded-full p-0 flex items-center justify-center text-xs bg-[#4682b4] hover:bg-[#0b1a51] text-white",children:S()})]})]})]}),e.jsx("div",{className:"px-4 pb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(K,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(D,{placeholder:m==="categories"?"Search business categories...":"Search products...",value:d,onChange:s=>I(s.target.value),className:"pl-10 bg-gray-50 border-gray-200"})]})}),x&&((a==null?void 0:a.role)==="MERCHANT"||(a==null?void 0:a.role)==="DRIVER")&&e.jsx("div",{className:"px-4 pb-4",children:e.jsxs("div",{className:"bg-white rounded-lg border overflow-hidden",children:[e.jsxs("div",{className:"p-3 border-b bg-gray-50",children:[e.jsx("h3",{className:"font-medium text-[#131313]",children:"Live Location Tracking"}),e.jsx("p",{className:"text-sm text-gray-600",children:(a==null?void 0:a.role)==="MERCHANT"?"Track nearby customers and drivers":"View nearby merchants and customers"})]}),e.jsx("div",{className:"h-64",children:e.jsx(_,{showUserLocation:!0,showNearbyUsers:!0,userRole:a==null?void 0:a.role,className:"h-full w-full"})})]})})]}),m==="categories"&&e.jsx("div",{className:"p-4 space-y-4",children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:T.filter(s=>s.name.toLowerCase().includes(d.toLowerCase())).map(s=>e.jsx(j,{className:"cursor-pointer hover:shadow-md transition-shadow border-2 border-blue-100 hover:border-blue-200",onClick:()=>R(s.id),children:e.jsxs(f,{className:"p-4 text-center",children:[e.jsx("div",{className:"w-12 h-12 mx-auto mb-3 bg-blue-50 rounded-xl flex items-center justify-center",children:(()=>{const t=P(s.icon);return e.jsx(t,{className:"w-6 h-6 text-[#4682b4]"})})()}),e.jsx("h3",{className:"font-medium text-sm text-[#131313] mb-1",children:s.name}),e.jsx("p",{className:"text-xs text-gray-500",children:"View products"})]})},s.id))})}),m==="products"&&e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs(l,{variant:"outline",onClick:()=>{v("categories"),N(null)},className:"flex items-center space-x-2",children:[e.jsx(M,{className:"h-4 w-4"}),e.jsx("span",{children:"Back to Categories"})]}),e.jsx("div",{className:"text-sm text-gray-600",children:u?"Loading...":`${p.length} products found`})]}),u?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Array.from({length:6}).map((s,t)=>e.jsx(j,{className:"animate-pulse",children:e.jsxs(f,{className:"p-4",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded mb-2"}),e.jsx("div",{className:"h-6 bg-gray-200 rounded"})]})},t))}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:p.map(s=>{var t;return e.jsx(j,{className:"hover:shadow-md transition-shadow border-2 border-blue-100 hover:border-blue-200",children:e.jsxs(f,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"font-semibold text-[#131313] text-sm",children:s.name}),e.jsx(L,{variant:s.inStock?"default":"secondary",className:s.inStock?"bg-green-100 text-green-800":"",children:s.inStock?"In Stock":"Out of Stock"})]}),e.jsx("p",{className:"text-xs text-gray-600 mb-2 line-clamp-2",children:s.description}),e.jsxs("div",{className:"flex items-center space-x-1 mb-2",children:[e.jsx(W,{className:"h-3 w-3 fill-yellow-400 text-yellow-400"}),e.jsxs("span",{className:"text-xs text-gray-600",children:[s.rating," (",s.reviewCount," reviews)"]})]}),e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{children:[e.jsxs("span",{className:"text-lg font-bold text-[#4682b4]",children:["₦",parseFloat(s.price).toLocaleString()]}),e.jsxs("span",{className:"text-xs text-gray-500 ml-1",children:["/ ",s.unit]})]})}),e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(G,{className:"h-6 w-6",children:e.jsx(Z,{className:"text-xs",children:(t=s.sellerName)==null?void 0:t.charAt(0)})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs font-medium text-[#131313] truncate",children:s.sellerName}),e.jsx("p",{className:"text-xs text-gray-500 truncate",children:s.sellerLocation})]})]}),C(s.id)>0?e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(l,{size:"sm",variant:"outline",onClick:()=>F(s.id),className:"h-8 w-8 p-0",children:e.jsx(X,{className:"h-3 w-3"})}),e.jsx("span",{className:"text-sm font-medium min-w-[1rem] text-center",children:C(s.id)}),e.jsx(l,{size:"sm",onClick:()=>k(s),className:"h-8 w-8 p-0 bg-[#4682b4] hover:bg-[#0b1a51] text-white",children:e.jsx(Y,{className:"h-3 w-3"})})]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Min: ",s.minimumOrder," ",s.unit]})]}):e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{size:"sm",onClick:()=>k(s),disabled:!s.inStock||y.isPending,className:"flex-1 bg-[#4682b4] hover:bg-[#0b1a51] text-white disabled:bg-gray-400",children:y.isPending?"Adding...":"Add to Cart"}),e.jsxs("p",{className:"text-xs text-gray-500 ml-2",children:["Min: ",s.minimumOrder]})]})]})},s.id)})}),!u&&p.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-gray-400 text-4xl mb-4",children:"🔍"}),e.jsx("h3",{className:"text-lg font-medium text-[#131313] mb-2",children:"No products found"}),e.jsx("p",{className:"text-gray-600",children:"Try adjusting your search or browse different categories"})]})]})]})}export{Ce as default};
//# sourceMappingURL=commodities-C6nO9f4V.js.map
