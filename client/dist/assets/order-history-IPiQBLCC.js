import{a as w,u as k,r as i,H as I,aT as L,j as e,B as b,A as O,g as n,ag as T,aj as P,m as g,n as j,V as A,k as D,P as R,y as S}from"./index-CVqmz7v7.js";import{a as Y}from"./account_circle-ChEtdL0c.js";import{R as F}from"./ruler-B14oAyqu.js";import{F as V}from"./fuel-COf1siGH.js";const t={PRIMARY:"#4682b4",SECONDARY:"#0b1a51",ACTIVE:"#010e42",TEXT:"#131313",WHITE:"#ffffff"},H=r=>r==="CONSUMER"?[{id:"1",type:"FUEL",productName:"Petrol",quantity:"20 litres",price:5e4,driverName:"Mike Johnson",pickupLocation:"Shell Station, Bukuru",deliveryLocation:"Rayfield, Jos",distance:"12km",status:"COMPLETED",date:"Friday, 13th November 2024",time:"05:00pm"},{id:"2",type:"COMMODITY",productName:"Rice (50kg)",quantity:"2 bags",price:85e3,merchantName:"Fatima Store",pickupLocation:"Market Square, Jos",deliveryLocation:"Angwan Rogo, Jos",distance:"8km",status:"CANCELLED",date:"Thursday, 12th November 2024",time:"02:30pm"},{id:"3",type:"FOOD",productName:"Jollof Rice & Chicken",quantity:"3 portions",price:15e3,merchantName:"Mama Adanna Kitchen",pickupLocation:"Terminus Market",deliveryLocation:"University of Jos",distance:"5km",status:"COMPLETED",date:"Wednesday, 11th November 2024",time:"07:45pm"}]:r==="MERCHANT"?[{id:"1",type:"COMMODITY",productName:"Yam Tubers",quantity:"10 pieces",price:25e3,customerName:"Sarah Ibrahim",driverName:"David Yakubu",pickupLocation:"My Store, Jos Main Market",deliveryLocation:"Angwan Rukuba",distance:"15km",status:"COMPLETED",statusColor:"text-green-600 bg-green-50",date:"Friday, 13th November 2024",time:"11:30am"},{id:"2",type:"FOOD",productName:"Pepper Soup",quantity:"5 bowls",price:12500,customerName:"John Musa",pickupLocation:"My Restaurant",deliveryLocation:"Plateau University",distance:"7km",status:"IN_PROGRESS",statusColor:"text-blue-600 bg-blue-50",date:"Friday, 13th November 2024",time:"01:15pm"},{id:"3",type:"COMMODITY",productName:"Palm Oil",quantity:"5 litres",price:18e3,customerName:"Grace Danjuma",driverName:"Ahmed Hassan",pickupLocation:"My Store",deliveryLocation:"Rayfield Estate",distance:"9km",status:"CANCELLED",statusColor:"text-red-600 bg-red-50",date:"Thursday, 12th November 2024",time:"04:20pm"}]:r==="DRIVER"?[{id:"1",type:"FUEL",productName:"Diesel",quantity:"50 litres",price:75e3,customerName:"Construction Co. Ltd",pickupLocation:"Total Station, Jos",deliveryLocation:"Construction Site, Vom",distance:"25km",status:"COMPLETED",date:"Friday, 13th November 2024",time:"09:00am"},{id:"2",type:"DELIVERY",productName:"Electronics Package",quantity:"1 package",price:5e3,customerName:"Tech Solutions Ltd",pickupLocation:"Computer Village, Jos",deliveryLocation:"Government House",distance:"18km",status:"COMPLETED",date:"Thursday, 12th November 2024",time:"03:45pm"},{id:"3",type:"COMMODITY",productName:"Fresh Vegetables",quantity:"10 crates",price:8e3,customerName:"Restaurant Chain",pickupLocation:"Vegetable Market",deliveryLocation:"Multiple Restaurants",distance:"22km",status:"CANCELLED",date:"Wednesday, 11th November 2024",time:"06:30am"}]:[],q=r=>{switch(r){case"COMPLETED":return{bg:"#31D45D",text:"#31D45D",label:"Completed"};case"CANCELLED":return{bg:"#FF4141",text:"#FF4141",label:"Cancelled"};case"IN_PROGRESS":return{bg:"#FF8C00",text:"#FF8C00",label:"In Progress"};case"PENDING":return{bg:"#FFC107",text:"#FFC107",label:"Pending"};default:return{bg:t.PRIMARY,text:t.PRIMARY,label:r}}},U=r=>{switch(r){case"FUEL":return e.jsx(V,{className:"h-5 w-5",style:{color:t.PRIMARY}});case"COMMODITY":case"FOOD":return e.jsx(S,{className:"h-5 w-5",style:{color:t.PRIMARY}});case"DELIVERY":return e.jsx(R,{className:"h-5 w-5",style:{color:t.PRIMARY}});default:return e.jsx(R,{className:"h-5 w-5",style:{color:t.PRIMARY}})}},J=r=>r==="DRIVER"?"Pickup & Delivery History":"Order History",W=r=>{switch(r){case"CONSUMER":return"/consumer-home";case"MERCHANT":return"/merchant-dashboard";case"DRIVER":return"/driver-dashboard";default:return"/dashboard"}};function $(){const{user:r}=w(),[,u]=k(),o=(r==null?void 0:r.role)||"CONSUMER",[B,C]=i.useState(H(o)),v=J(o),E=W(o),{connected:M,orderUpdates:l}=I(),{notifications:d}=L(),x=()=>{u(E)};i.useEffect(()=>{Object.keys(l).length>0&&C(s=>s.map(a=>{if(l[a.id]){const c=l[a.id];return{...a,status:c.status}}return a}))},[l]),i.useEffect(()=>{if(d.length>0){const s=d.filter(a=>a.payload.type==="ORDER_UPDATE");s.length>0&&console.log("Received order notifications:",s)}},[d]);const[h,p]=i.useState([]),[y,N]=i.useState(!0),[m,f]=i.useState(null);return i.useEffect(()=>{(async()=>{try{N(!0),f(null);const a=await fetch("/api/orders",{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"}});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const c=await a.json();if(c.success)p(c.data||[]);else throw new Error(c.message||"Failed to fetch orders")}catch(a){console.error("Error fetching order history:",a),f(a.message),p([])}finally{N(!1)}})()},[]),e.jsxs("div",{className:"min-h-screen bg-gray-50 w-full max-w-sm sm:max-w-md md:max-w-lg lg:max-w-xl xl:max-w-2xl mx-auto px-2 sm:px-4",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-40",children:e.jsx("div",{className:"max-w-md mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(b,{onClick:x,variant:"ghost",size:"sm",className:"p-2 rounded-full hover:bg-gray-100",children:e.jsx(O,{className:"h-6 w-6",style:{color:t.TEXT}})}),e.jsx("h1",{className:"text-xl font-bold",style:{color:t.TEXT},children:v}),e.jsx("div",{className:"w-10 flex items-center justify-center",children:M?e.jsxs(n,{className:"bg-green-500 hover:bg-green-600",children:[e.jsx(T,{className:"h-3 w-3 mr-1"}),e.jsx("span",{className:"text-xs",children:"Live"})]}):e.jsxs(n,{className:"bg-gray-500 hover:bg-gray-600",children:[e.jsx(P,{className:"h-3 w-3 mr-1"}),e.jsx("span",{className:"text-xs",children:"Offline"})]})})]})})}),e.jsxs("div",{className:"max-w-md mx-auto p-5 space-y-4",children:[y&&e.jsx("p",{children:"Loading orders..."}),m&&e.jsxs("p",{className:"text-red-500",children:["Error: ",m]}),h.length===0&&!y&&!m?e.jsx(g,{className:"rounded-3xl border",style:{borderColor:t.PRIMARY},children:e.jsxs(j,{className:"text-center py-16",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-gray-100 to-gray-200 rounded-full mx-auto mb-6 flex items-center justify-center",children:e.jsx(A,{className:"h-10 w-10 text-gray-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"No Order History"}),e.jsx("p",{className:"text-gray-500 mb-6",children:o==="DRIVER"?"Complete your first delivery to see history here":"Place your first order to see history here"}),e.jsx(b,{onClick:x,className:"rounded-full",style:{backgroundColor:t.PRIMARY,color:t.WHITE},children:o==="DRIVER"?"View Available Orders":"Start Shopping"})]})}):h.map(s=>{const a=q(s.status);return e.jsx(g,{className:"rounded-3xl border shadow-lg cursor-pointer hover:shadow-xl transition-shadow",style:{borderColor:t.PRIMARY},onClick:()=>u(`/order-history-detail?status=${s.status}`),children:e.jsxs(j,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden border-2",style:{borderColor:t.PRIMARY},children:e.jsx("img",{src:s.profileImage||Y,alt:"Profile",className:"w-full h-full object-cover",style:{filter:"brightness(0) saturate(100%) invert(27%) sepia(51%) saturate(2878%) hue-rotate(176deg) brightness(102%) contrast(97%)"}})}),e.jsx("div",{children:e.jsxs("p",{className:"text-sm font-medium text-gray-600",children:[o==="CONSUMER"&&(s.driverName||s.merchantName),o==="MERCHANT"&&s.customerName,o==="DRIVER"&&s.customerName]})})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("span",{className:"text-lg font-semibold",style:{color:t.SECONDARY},children:["â‚¦",s.price.toLocaleString()]})})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[U(s.type),e.jsx("h3",{className:"text-xl font-semibold",style:{color:t.ACTIVE},children:s.productName})]}),e.jsx(n,{variant:"outline",className:"px-3 py-1 rounded-lg border text-xs font-medium",style:{borderColor:t.PRIMARY,color:t.PRIMARY,backgroundColor:"transparent"},children:s.quantity})]}),e.jsx("div",{className:"w-full h-px mb-6 bg-gray-300"}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("div",{className:"w-5 h-5 rounded-full border-2 flex items-center justify-center",style:{borderColor:t.PRIMARY},children:e.jsx("div",{className:"w-2.5 h-2.5 rounded-full",style:{backgroundColor:t.ACTIVE}})})}),e.jsx("p",{className:"text-base font-medium",style:{color:t.ACTIVE},children:s.pickupLocation})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-5 h-5 flex-shrink-0"}),e.jsx("div",{className:"w-px h-8 ml-2.5 border-l-2 border-dashed",style:{borderColor:t.PRIMARY}})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(F,{className:"h-5 w-5",style:{color:t.PRIMARY}}),e.jsx("p",{className:"text-base font-medium",style:{color:t.TEXT},children:s.distance})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-5 h-5 flex-shrink-0"}),e.jsx("div",{className:"w-px h-8 ml-2.5 border-l-2 border-dashed",style:{borderColor:t.PRIMARY}})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(D,{className:"h-5 w-5",style:{color:t.PRIMARY}}),e.jsx("p",{className:"text-base font-medium",style:{color:t.ACTIVE},children:s.deliveryLocation})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{className:"px-3 py-1 rounded-lg text-xs font-medium border",style:{borderColor:a.bg,color:a.text,backgroundColor:"transparent"},children:a.label}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs font-light",style:{color:t.ACTIVE},children:s.date}),e.jsx("p",{className:"text-xs font-light",style:{color:t.ACTIVE},children:s.time})]})]})]})},s.id)})]})]})}export{$ as default};
//# sourceMappingURL=order-history-IPiQBLCC.js.map
