import{u as f,a as b,r as t,e as v,j as e,B as i,A as C,S as R,I as M,m as x,n as u,g as h}from"./index-CVqmz7v7.js";import{A as T,b as A,a as E}from"./avatar-aX6vUNG7.js";import{a as k}from"./account_circle-ChEtdL0c.js";import{P as S}from"./plus-CPiTij5A.js";import{M as L}from"./message-circle-CqxJZh1m.js";const o={PRIMARY:"#4682b4",WHITE:"#ffffff"};function Z(){const[,n]=f(),{user:a}=b(),[r,p]=t.useState(""),[c,g]=t.useState("ALL"),{data:I=[],isLoading:N}=v({queryKey:["/api/conversations",a==null?void 0:a.id,a==null?void 0:a.role],enabled:!!(a!=null&&a.id)}),l=[{id:"conv-1",participantName:"AgriMart Lagos",participantRole:"MERCHANT",participantAvatar:"",lastMessage:"Your order of Premium Rice (50kg) is ready for pickup. Total: â‚¦45,000",lastMessageTime:"2 min ago",unreadCount:2,isOnline:!0,conversationType:"ORDER",productName:"Premium Rice 50kg"},{id:"conv-2",participantName:"John Driver",participantRole:"DRIVER",participantAvatar:"",lastMessage:"I'm 5 minutes away from your delivery location. Please be ready.",lastMessageTime:"15 min ago",unreadCount:1,isOnline:!0,conversationType:"ORDER"},{id:"conv-3",participantName:"FreshFoods Market",participantRole:"MERCHANT",participantAvatar:"",lastMessage:"Thank you for your inquiry about bulk tomatoes. Our current price is â‚¦800 per basket.",lastMessageTime:"1 hour ago",unreadCount:0,isOnline:!1,conversationType:"QUOTE",productName:"Fresh Tomatoes"},{id:"conv-4",participantName:"Sarah Express",participantRole:"DRIVER",participantAvatar:"",lastMessage:"Your fuel delivery has been completed. Thank you for choosing our service!",lastMessageTime:"2 hours ago",unreadCount:0,isOnline:!1,conversationType:"ORDER"},{id:"conv-5",participantName:"TechMall Electronics",participantRole:"MERCHANT",participantAvatar:"",lastMessage:"We have received your quote request for iPhone 15 Pro Max. We'll get back to you with pricing.",lastMessageTime:"1 day ago",unreadCount:0,isOnline:!0,conversationType:"QUOTE",productName:"iPhone 15 Pro Max"}].filter(s=>{if(!(s.participantName.toLowerCase().includes(r.toLowerCase())||s.lastMessage.toLowerCase().includes(r.toLowerCase())||s.productName&&s.productName.toLowerCase().includes(r.toLowerCase())))return!1;switch(c){case"UNREAD":return s.unreadCount>0;case"MERCHANTS":return s.participantRole==="MERCHANT";case"DRIVERS":return s.participantRole==="DRIVER";default:return!0}}),j=s=>{n(`/chat?conversationId=${s}`)},y=s=>s,w=s=>{switch(s){case"ORDER":return"ðŸ“¦";case"QUOTE":return"ðŸ’°";default:return"ðŸ’¬"}},d=s=>{switch(s){case"MERCHANT":return"#4682b4";case"DRIVER":return"#10b981";default:return"#6b7280"}},{socket:D,isConnected:P}=useWebSocket(!0),[H,F]=t.useState(null),[U,Q]=t.useState([]),[V,W]=t.useState(""),[Y,q]=t.useState(!0),[z,B]=t.useState(null);return e.jsxs("div",{className:"min-h-screen bg-gray-50 w-full max-w-sm sm:max-w-md md:max-w-lg lg:max-w-xl xl:max-w-2xl mx-auto px-2 sm:px-4",children:[e.jsxs("div",{className:"sticky top-0 z-10 px-4 py-4",style:{background:"linear-gradient(135deg, #4682b4 0%, #0b1a51 100%)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(i,{variant:"ghost",size:"icon",onClick:()=>window.history.back(),className:"text-white hover:bg-white/20 w-8 h-8",children:e.jsx(C,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-bold text-white",children:"Messages"}),e.jsxs("p",{className:"text-white/80 text-sm",children:[l.length," conversations"]})]})]}),e.jsx(i,{variant:"ghost",size:"icon",onClick:()=>n("/chat/new"),className:"text-white hover:bg-white/20 w-8 h-8",children:e.jsx(S,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"relative",children:[e.jsx(R,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(M,{placeholder:"Search messages, contacts, or products...",value:r,onChange:s=>p(s.target.value),className:"pl-10 bg-white/10 border-white/20 text-white placeholder-white/60 focus:bg-white/20"})]}),e.jsx("div",{className:"flex space-x-2 mt-3",children:["ALL","UNREAD","MERCHANTS","DRIVERS"].map(s=>e.jsx(i,{variant:c===s?"secondary":"ghost",size:"sm",onClick:()=>g(s),className:`text-xs ${c===s?"bg-white text-slate-900":"text-white/80 hover:bg-white/20"}`,children:s==="ALL"?"All":s==="UNREAD"?"Unread":s.toLowerCase()},s))})]}),e.jsx("div",{className:"px-4 pb-20",children:N?e.jsx("div",{className:"space-y-3",children:[1,2,3,4,5].map(s=>e.jsx(x,{className:"animate-pulse",children:e.jsx(u,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-full"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})]})})},s))}):l.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(L,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-600 mb-2",children:r?"No messages found":"No conversations yet"}),e.jsx("p",{className:"text-gray-500 mb-6",children:r?"Try adjusting your search or filters":"Start chatting with merchants and drivers"}),e.jsx(i,{onClick:()=>n("/commodities"),style:{backgroundColor:o.PRIMARY},className:"text-white",children:"Browse Marketplace"})]}):e.jsx("div",{className:"space-y-2",children:l.map(s=>e.jsx(x,{className:"cursor-pointer hover:shadow-md transition-shadow border-l-4 hover:border-l-blue-500",onClick:()=>j(s.id),style:{borderLeftColor:s.unreadCount>0?o.PRIMARY:"transparent",backgroundColor:s.unreadCount>0?"#f8faff":o.WHITE},children:e.jsx(u,{className:"p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsxs("div",{className:"relative flex-shrink-0",children:[e.jsxs(T,{className:"w-12 h-12",children:[e.jsx(A,{src:s.participantAvatar||k}),e.jsx(E,{className:"bg-gray-200",children:s.participantName.split(" ").map(m=>m[0]).join("")})]}),s.isOnline&&e.jsx("div",{className:"absolute -bottom-1 -right-1 w-3 h-3 bg-green-500 border-2 border-white rounded-full"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:s.participantName}),e.jsx(h,{variant:"outline",className:"text-xs px-1.5 py-0.5",style:{borderColor:d(s.participantRole),color:d(s.participantRole)},children:s.participantRole})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:y(s.lastMessageTime)}),s.unreadCount>0&&e.jsx(h,{className:"bg-red-500 text-white text-xs px-1.5 py-0.5 min-w-5 h-5 flex items-center justify-center rounded-full",children:s.unreadCount>99?"99+":s.unreadCount})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("span",{className:"text-sm",children:w(s.conversationType)}),e.jsx("span",{className:"text-xs text-gray-600 font-medium",children:s.conversationType}),s.productName&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-xs text-gray-400",children:"â€¢"}),e.jsx("span",{className:"text-xs text-gray-600 truncate",children:s.productName})]})]}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 leading-snug",children:s.lastMessage})]})]})})},s.id))})})]})}export{Z as default};
//# sourceMappingURL=messages-G24VY0hM.js.map
