import{c as y,u as M,a as C,b as I,r as f,e as S,f as g,j as e,B as c,A as q}from"./index-CVqmz7v7.js";import{p as D}from"./plus_icon-BKS7adVm.js";import{a as b}from"./queryClient-A1RmhH99.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j=y("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=y("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),B="data:image/svg+xml,%3csvg%20width='13'%20height='5'%20viewBox='0%200%2013%205'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M0.651672%204.05893V0.553345H12.0132V4.05893H0.651672Z'%20fill='%230B1A51'/%3e%3c/svg%3e";function T(){const[,r]=M(),{user:t}=C(),m=I(),[l,d]=f.useState([]);f.useEffect(()=>{if(!(t!=null&&t.id)){const s=localStorage.getItem("cart");s&&d(JSON.parse(s))}},[t==null?void 0:t.id]);const{data:N=[],isLoading:v}=S({queryKey:["/api/cart",t==null?void 0:t.id],enabled:!!(t!=null&&t.id),queryFn:async()=>{const a=await(await fetch(`/api/cart/${t==null?void 0:t.id}`)).json();return a.success?a.cartItems:[]}}),o=g({mutationFn:async({cartItemId:s,quantity:a})=>b("PUT",`/api/cart/${s}`),onSuccess:()=>{m.invalidateQueries({queryKey:["/api/cart",t==null?void 0:t.id]})}}),h=g({mutationFn:async s=>b("DELETE",`/api/cart/${s}`),onSuccess:()=>{m.invalidateQueries({queryKey:["/api/cart",t==null?void 0:t.id]})}}),n=t!=null&&t.id?N:l,u=(s,a)=>{if(a<=0){p(s);return}if(t!=null&&t.id&&s.id)o.mutate({cartItemId:s.id,quantity:a});else{const i=l.map(x=>x.productId===s.productId?{...x,quantity:a}:x);d(i),localStorage.setItem("cart",JSON.stringify(i))}},p=s=>{if(t!=null&&t.id&&s.id)h.mutate(s.id);else{const a=l.filter(i=>i.productId!==s.productId);d(a),localStorage.setItem("cart",JSON.stringify(a))}},w=()=>n.reduce((s,a)=>s+a.price*a.quantity,0),k=()=>{if(n.length!==0){if(!(t!=null&&t.id)){r("/signin");return}r("/checkout")}};return v?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading your cart..."})]})}):e.jsxs("div",{className:"min-h-screen bg-white w-full max-w-sm sm:max-w-md md:max-w-lg lg:max-w-xl xl:max-w-2xl mx-auto px-2 sm:px-4",children:[e.jsxs("div",{className:"flex items-center p-4 border-b",children:[e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>r("/consumer-home"),className:"mr-4",children:e.jsx(q,{className:"h-6 w-6 text-[#131313]"})}),e.jsx("h1",{className:"text-xl font-extrabold text-black font-['Montserrat']",children:"Cart"})]}),n.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 px-4",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-6",children:e.jsx(j,{className:"w-12 h-12 text-gray-400"})}),e.jsx("h2",{className:"text-2xl font-semibold text-[#131313] mb-2",children:"Your cart is empty"}),e.jsx("p",{className:"text-gray-600 text-center mb-8 max-w-sm",children:"Start shopping to add items to your cart and enjoy our amazing marketplace experience."}),e.jsx(c,{className:"bg-[#4682b4] hover:bg-[#010e42] text-white px-8 py-3 font-['Montserrat']",onClick:()=>r("/commodities"),children:"Browse Marketplace"})]}):e.jsxs("div",{className:"flex flex-col min-h-[calc(100vh-80px)]",children:[e.jsx("div",{className:"m-4",children:e.jsx("div",{className:"border-2 border-[#4682b4] rounded-2xl min-h-[360px] p-4",children:n.map((s,a)=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center py-4",children:[e.jsx("div",{className:"w-14 h-14 bg-[#D9D9D9] rounded-md flex items-center justify-center flex-shrink-0",children:s.productImage?e.jsx("img",{src:s.productImage,alt:s.productName,className:"w-full h-full object-cover rounded-md"}):e.jsx(j,{className:"w-6 h-6 text-gray-500"})}),e.jsxs("div",{className:"flex-1 ml-3",children:[e.jsx("h3",{className:"font-bold text-[#010E42] text-sm font-['Montserrat'] mb-1",children:s.productName}),e.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[e.jsx(c,{variant:"ghost",size:"icon",className:"w-7 h-7 bg-black text-white hover:bg-gray-800 p-0",onClick:()=>u(s,s.quantity-1),disabled:o.isPending,children:e.jsx("img",{src:B,alt:"Minus",className:"w-3 h-3"})}),e.jsx("div",{className:"w-8 h-7 bg-[#4682b4] rounded-sm flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-semibold font-['Montserrat']",children:s.quantity})}),e.jsx(c,{variant:"ghost",size:"icon",className:"w-7 h-7 bg-black text-white hover:bg-gray-800 p-0",onClick:()=>u(s,s.quantity+1),disabled:o.isPending,children:e.jsx("img",{src:D,alt:"Plus",className:"w-3 h-3"})})]})]}),e.jsx("div",{className:"text-right mr-4",children:e.jsx("div",{className:"flex items-center",children:e.jsxs("span",{className:"text-[#0B1A51] text-sm font-semibold font-['Montserrat']",children:["₦",(s.price*s.quantity).toLocaleString()]})})}),e.jsx(c,{variant:"ghost",size:"icon",className:"w-6 h-6 text-gray-500 hover:text-red-500 p-0",onClick:()=>p(s),disabled:h.isPending,children:e.jsx(L,{className:"w-4 h-4"})})]}),a<n.length-1&&e.jsx("div",{className:"border-b border-[#D4D4D4] my-2"})]},s.productId))})}),e.jsx("div",{className:"mx-4 mb-4",children:e.jsxs("div",{className:"bg-[#4682b4] rounded-2xl p-6 text-white",children:[e.jsx("h3",{className:"text-lg font-bold font-['Montserrat'] mb-4",children:"Purchase Summary"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-base font-['Montserrat']",children:"Total"}),e.jsx("div",{className:"flex items-center",children:e.jsxs("span",{className:"text-base font-semibold font-['Montserrat']",children:["₦",w().toLocaleString()]})})]})]})}),e.jsx("div",{className:"mx-4 mb-4",children:e.jsx("div",{className:"border-2 border-[#4682b4] rounded-2xl p-4 bg-white shadow-lg",children:e.jsx("span",{className:"text-[#D9D9D9] text-base font-medium font-['Montserrat']",children:"Select a Payment Method...."})})}),e.jsx("div",{className:"mx-4 mb-8",children:e.jsx(c,{className:"w-full bg-[#0B1A51] hover:bg-[#010e42] text-white py-4 rounded-[30px] font-['Montserrat']",onClick:k,disabled:n.length===0,children:"Make Payment"})})]})]})}export{T as default};
//# sourceMappingURL=cart-DalEchuO.js.map
