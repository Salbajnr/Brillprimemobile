import{u as w,a as D,b as C,H as P,e as E,f as L,j as e,L as u,B as r,A,m as i,n,g as T,V as j,k as I,aO as N,$ as S,N as p,C as k,O as U}from"./index-CPIh2kaR.js";import{L as O}from"./live-map-DXBjH6ZS.js";import{F as R}from"./fuel-BWMmnkaN.js";import{P as F}from"./phone-2OSRHZsq.js";function B(){const[,x]=w(),{user:a}=D(),f=C(),{connected:h}=P(),c=new URLSearchParams(window.location.search).get("orderId")||"",{data:s,isLoading:g}=E({queryKey:["/api/fuel-orders",c],queryFn:async()=>{const l=await(await fetch(`/api/fuel-orders/${c}`)).json();return l.success?l.order:null},enabled:!!c,refetchInterval:3e4}),d=L({mutationFn:async({status:t,notes:l})=>(await fetch(`/api/fuel-orders/${c}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t,notes:l})})).json(),onSuccess:()=>{f.invalidateQueries({queryKey:["/api/fuel-orders",c]})}}),v=t=>{const l={PENDING:{color:"bg-yellow-100 text-yellow-800",icon:j,message:"Waiting for driver acceptance"},ACCEPTED:{color:"bg-blue-100 text-blue-800",icon:N,message:"Driver assigned and heading to pickup"},PICKED_UP:{color:"bg-purple-100 text-purple-800",icon:U,message:"Fuel picked up, heading to delivery location"},IN_TRANSIT:{color:"bg-indigo-100 text-indigo-800",icon:p,message:"Driver is on the way to your location"},DELIVERED:{color:"bg-green-100 text-green-800",icon:k,message:"Fuel delivered successfully"},CANCELLED:{color:"bg-red-100 text-red-800",icon:u,message:"Order has been cancelled"}};return l[t]||l.PENDING},b=t=>({PMS:"Premium Motor Spirit",AGO:"Automotive Gas Oil",DPK:"Dual Purpose Kerosene"})[t]||t,o=t=>{d.mutate({status:t})};if(g)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading fuel order details..."})]})});if(!s)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(u,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Order Not Found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"The fuel order you're looking for doesn't exist."}),e.jsx(r,{onClick:()=>x("/dashboard"),children:"Go to Dashboard"})]})});const m=v(s.status),y=m.icon;return e.jsxs("div",{className:"min-h-screen bg-gray-50 pb-20",children:[e.jsx("div",{className:"bg-white shadow-sm border-b",children:e.jsxs("div",{className:"flex items-center justify-between p-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(r,{variant:"ghost",size:"icon",onClick:()=>x("/dashboard"),children:e.jsx(A,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold text-[#131313]",children:"Fuel Delivery"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Order #",s.id.slice(-8)]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${h?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-xs text-gray-500",children:h?"Live":"Offline"})]})]})}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx(i,{children:e.jsxs(n,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(y,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx(T,{className:m.color,children:s.status.replace("_"," ")}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:m.message})]})]}),s.estimatedDeliveryTime&&e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(j,{className:"h-4 w-4 mr-2"}),e.jsxs("span",{children:["Estimated delivery: ",new Date(s.estimatedDeliveryTime).toLocaleTimeString()]})]})]})}),e.jsx(i,{children:e.jsxs(n,{className:"p-4",children:[e.jsxs("h3",{className:"font-semibold text-[#131313] mb-4 flex items-center",children:[e.jsx(R,{className:"h-5 w-5 mr-2 text-blue-600"}),"Order Details"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Fuel Type:"}),e.jsx("span",{className:"font-medium",children:b(s.fuelType)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Quantity:"}),e.jsxs("span",{className:"font-medium",children:[s.quantity,"L"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Unit Price:"}),e.jsxs("span",{className:"font-medium",children:["₦",parseFloat(s.unitPrice).toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2",children:[e.jsx("span",{className:"text-gray-600",children:"Total Amount:"}),e.jsxs("span",{className:"font-bold text-lg",children:["₦",parseFloat(s.totalAmount).toLocaleString()]})]})]})]})}),e.jsx(i,{children:e.jsxs(n,{className:"p-4",children:[e.jsxs("h3",{className:"font-semibold text-[#131313] mb-4 flex items-center",children:[e.jsx(I,{className:"h-5 w-5 mr-2 text-green-600"}),"Delivery Information"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 text-sm",children:"Delivery Address:"}),e.jsx("p",{className:"font-medium",children:s.deliveryAddress})]}),s.customerName&&(a==null?void 0:a.role)==="DRIVER"&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 text-sm",children:"Customer:"}),e.jsx("p",{className:"font-medium",children:s.customerName})]})]})]})}),s.driverName&&(a==null?void 0:a.role)==="CONSUMER"&&e.jsx(i,{children:e.jsxs(n,{className:"p-4",children:[e.jsxs("h3",{className:"font-semibold text-[#131313] mb-4 flex items-center",children:[e.jsx(N,{className:"h-5 w-5 mr-2 text-purple-600"}),"Driver Information"]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.driverName}),e.jsx("p",{className:"text-sm text-gray-600",children:s.driverPhone})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(r,{variant:"outline",size:"sm",children:e.jsx(F,{className:"h-4 w-4"})}),e.jsx(r,{variant:"outline",size:"sm",children:e.jsx(S,{className:"h-4 w-4"})})]})]})]})}),(s.status==="ACCEPTED"||s.status==="PICKED_UP"||s.status==="IN_TRANSIT")&&e.jsx(i,{children:e.jsxs(n,{className:"p-4",children:[e.jsxs("h3",{className:"font-semibold text-[#131313] mb-4 flex items-center",children:[e.jsx(p,{className:"h-5 w-5 mr-2 text-indigo-600"}),"Live Tracking"]}),e.jsx("div",{className:"h-64 rounded-lg overflow-hidden",children:e.jsx(O,{showUserLocation:!0,showDriverLocation:(a==null?void 0:a.role)==="CONSUMER",orderId:s.id,className:"h-full w-full"})})]})}),(a==null?void 0:a.role)==="DRIVER"&&s.status!=="DELIVERED"&&s.status!=="CANCELLED"&&e.jsx(i,{children:e.jsxs(n,{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-[#131313] mb-4",children:"Update Status"}),e.jsxs("div",{className:"space-y-2",children:[s.status==="ACCEPTED"&&e.jsx(r,{onClick:()=>o("PICKED_UP"),disabled:d.isPending,className:"w-full bg-purple-600 hover:bg-purple-700 text-white",children:"Confirm Pickup"}),s.status==="PICKED_UP"&&e.jsx(r,{onClick:()=>o("IN_TRANSIT"),disabled:d.isPending,className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white",children:"Start Delivery"}),s.status==="IN_TRANSIT"&&e.jsx(r,{onClick:()=>o("DELIVERED"),disabled:d.isPending,className:"w-full bg-green-600 hover:bg-green-700 text-white",children:"Mark as Delivered"})]})]})}),e.jsx(i,{children:e.jsxs(n,{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-[#131313] mb-4",children:"Order Timeline"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Order Placed"}),e.jsx("p",{className:"text-xs text-gray-600",children:new Date(s.createdAt).toLocaleString()})]})]}),s.acceptedAt&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Driver Assigned"}),e.jsx("p",{className:"text-xs text-gray-600",children:new Date(s.acceptedAt).toLocaleString()})]})]}),s.pickedUpAt&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Fuel Picked Up"}),e.jsx("p",{className:"text-xs text-gray-600",children:new Date(s.pickedUpAt).toLocaleString()})]})]}),s.deliveredAt&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Delivered"}),e.jsx("p",{className:"text-xs text-gray-600",children:new Date(s.deliveredAt).toLocaleString()})]})]})]})]})})]})]})}export{B as default};
//# sourceMappingURL=fuel-delivery-tracking-Bd4FkDrL.js.map
